/*
 Maps api created at 2GIS. Build on Leaflet.
 (c) 2013-2015, 2GIS
*/

!function(window,document,undefined){function expose(){var t=window.L;L.noConflict=function(){return window.L=t,this},window.L=L}function getPageLang(){var t=document.documentElement,e=t.lang||t.getAttributeNS&&t.getAttributeNS("http://www.w3.org/XML/1998/namespace","lang")||"ru";return e}var L={version:"0.8-dev"};"object"==typeof module&&"object"==typeof module.exports?module.exports=L:"function"==typeof define&&define.amd?define(L):expose(),L.Util={extend:function(t){var e,i,n,o,r=Array.prototype.slice.call(arguments,1);for(i=0,n=r.length;n>i;i++){o=r[i];for(e in o)t[e]=o[e]}return t},create:Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),bind:function(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}},stamp:function(t){return t._leaflet_id=t._leaflet_id||++L.Util.lastId,t._leaflet_id},lastId:0,throttle:function(t,e,i){var n,o,r,s;return s=function(){n=!1,o&&(r.apply(i,o),o=!1)},r=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)}},wrapNum:function(t,e,i){var n=e[1],o=e[0],r=n-o;return t===n&&i?t:((t-o)%r+r)%r+o},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return L.Util.trim(t).split(/\s+/)},setOptions:function(t,e){t.hasOwnProperty("options")||(t.options=t.options?L.Util.create(t.options):{});for(var i in e)t.options[i]=e[i];return t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(L.Util.templateRe,function(t,i){var n=e[i];if(n===undefined)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})},templateRe:/\{ *([\w_]+) *\}/g,isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function e(t){var e=+new Date,n=Math.max(0,16-(e-i));return i=e+n,window.setTimeout(t,n)}var i=0,n=window.requestAnimationFrame||t("RequestAnimationFrame")||e,o=window.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};L.Util.requestAnimFrame=function(t,i,o,r){return o&&n===e?void t.call(i):n.call(window,L.bind(t,i),r)},L.Util.cancelAnimFrame=function(t){t&&o.call(window,t)}}(),L.extend=L.Util.extend,L.bind=L.Util.bind,L.stamp=L.Util.stamp,L.setOptions=L.Util.setOptions,L.Class=function(){},L.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks.length&&this.callInitHooks()},i=e.__super__=this.prototype,n=L.Util.create(i);n.constructor=e,e.prototype=n;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);return t.statics&&(L.extend(e,t.statics),delete t.statics),t.includes&&(L.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),n.options&&(t.options=L.Util.extend(L.Util.create(n.options),t.options)),L.extend(n,t),n._initHooks=[],n.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;e>t;t++)n._initHooks[t].call(this)}},e},L.Class.include=function(t){L.extend(this.prototype,t)},L.Class.mergeOptions=function(t){L.extend(this.prototype.options,t)},L.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)},L.Evented=L.Class.extend({on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else{t=L.Util.splitWords(t);for(var o=0,r=t.length;r>o;o++)this._on(t[o],e,i)}return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else{t=L.Util.splitWords(t);for(var o=0,r=t.length;r>o;o++)this._off(t[o],e,i)}else delete this._events;return this},_on:function(t,e,i){var n=this._events=this._events||{},o=i&&i!==this&&L.stamp(i);if(o){var r=t+"_idx",s=t+"_len",a=n[r]=n[r]||{},l=L.stamp(e)+"_"+o;a[l]||(a[l]={fn:e,ctx:i},n[s]=(n[s]||0)+1)}else n[t]=n[t]||[],n[t].push({fn:e})},_off:function(t,e,i){var n=this._events,o=t+"_idx",r=t+"_len";if(n){if(!e)return delete n[t],delete n[o],void delete n[r];var s,a,l,c,u,h=i&&i!==this&&L.stamp(i);if(h)u=L.stamp(e)+"_"+h,s=n[o],s&&s[u]&&(c=s[u],delete s[u],n[r]--);else if(s=n[t])for(a=0,l=s.length;l>a;a++)if(s[a].fn===e){c=s[a],s.splice(a,1);break}c&&(c.fn=L.Util.falseFn)}},fire:function(t,e,i){if(!this.listens(t,i))return this;var n=L.Util.extend({},e,{type:t,target:this}),o=this._events;if(o){var r,s,a,l,c=o[t+"_idx"];if(o[t])for(a=o[t].slice(),r=0,s=a.length;s>r;r++)a[r].fn.call(this,n);for(l in c)c[l].fn.call(c[l].ctx,n)}return i&&this._propagateEvent(n),this},listens:function(t,e){var i=this._events;if(i&&(i[t]||i[t+"_len"]))return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var n in t)this.once(n,t[n],e);return this}var o=L.bind(function(){this.off(t,e,i).off(t,o,i)},this);return this.on(t,e,i).on(t,o,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[L.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[L.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,L.extend({layer:t.target},t),!0)}});var proto=L.Evented.prototype;proto.addEventListener=proto.on,proto.removeEventListener=proto.clearAllEventListeners=proto.off,proto.addOneTimeEventListener=proto.once,proto.fireEvent=proto.fire,proto.hasEventListeners=proto.listens,L.Mixin={Events:proto},function(){var t=navigator.userAgent.toLowerCase(),e=document.documentElement,i="ActiveXObject"in window,n=-1!==t.indexOf("webkit"),o=-1!==t.indexOf("phantom"),r=-1!==t.search("android [23]"),s=-1!==t.indexOf("chrome"),a="undefined"!=typeof orientation,l=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&!window.PointerEvent,c=window.PointerEvent&&navigator.pointerEnabled&&navigator.maxTouchPoints||l,u=i&&"transition"in e.style,h="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!r,d="MozPerspective"in e.style,p="OTransition"in e.style,_="devicePixelRatio"in window&&window.devicePixelRatio>1;if(!_&&"matchMedia"in window){var m=window.matchMedia("(min-resolution:144dpi)");_=m&&m.matches}var f=!window.L_NO_TOUCH&&!o&&(c||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch);L.Browser={ie:i,ielt9:i&&!document.addEventListener,webkit:n,gecko:-1!==t.indexOf("gecko")&&!n&&!window.opera&&!i,android:-1!==t.indexOf("android"),android23:r,chrome:s,safari:!s&&-1!==t.indexOf("safari"),ie3d:u,webkit3d:h,gecko3d:d,opera3d:p,any3d:!window.L_DISABLE_3D&&(u||h||d||p)&&!o,mobile:a,mobileWebkit:a&&n,mobileWebkit3d:a&&h,mobileOpera:a&&window.opera,touch:!!f,msPointer:!!l,pointer:!!c,retina:!!_}}(),L.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},L.Point.prototype={clone:function(){return new L.Point(this.x,this.y)},add:function(t){return this.clone()._add(L.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(L.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){t=L.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=L.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=L.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+L.Util.formatNum(this.x)+", "+L.Util.formatNum(this.y)+")"}},L.point=function(t,e,i){return t instanceof L.Point?t:L.Util.isArray(t)?new L.Point(t[0],t[1]):t===undefined||null===t?t:new L.Point(t,e,i)},L.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},L.Bounds.prototype={extend:function(t){return t=L.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new L.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new L.Point(this.min.x,this.max.y)},getTopRight:function(){return new L.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof L.Point?L.point(t):L.bounds(t),t instanceof L.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=L.bounds(t);var e=this.min,i=this.max,n=t.min,o=t.max,r=o.x>=e.x&&n.x<=i.x,s=o.y>=e.y&&n.y<=i.y;return r&&s},isValid:function(){return!(!this.min||!this.max)}},L.bounds=function(t,e){return!t||t instanceof L.Bounds?t:new L.Bounds(t,e)},L.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},L.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new L.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},L.DomUtil={get:function(t){return"string"==typeof t?document.getElementById(t):t},getStyle:function(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i},create:function(t,e,i){var n=document.createElement(t);return n.className=e,i&&i.appendChild(n),n},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(t.classList!==undefined)return t.classList.contains(e);var i=L.DomUtil.getClass(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)},addClass:function(t,e){if(t.classList!==undefined)for(var i=L.Util.splitWords(e),n=0,o=i.length;o>n;n++)t.classList.add(i[n]);else if(!L.DomUtil.hasClass(t,e)){var r=L.DomUtil.getClass(t);L.DomUtil.setClass(t,(r?r+" ":"")+e)}},removeClass:function(t,e){t.classList!==undefined?t.classList.remove(e):L.DomUtil.setClass(t,L.Util.trim((" "+L.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){t.className.baseVal===undefined?t.className=e:t.className.baseVal=e},getClass:function(t){return t.className.baseVal===undefined?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(o){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}},testProp:function(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},setTransform:function(t,e,i){var n=e||new L.Point(0,0),o=L.Browser.webkit3d,r="translate"+(o?"3d":"")+"(",s=(o?",0":"")+")";t.style[L.DomUtil.TRANSFORM]=r+n.x+"px,"+n.y+"px"+s+(i?" scale("+i+")":"")},setPosition:function(t,e,i){t._leaflet_pos=e,L.Browser.any3d&&!i?L.DomUtil.setTransform(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},function(){L.DomUtil.TRANSFORM=L.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var t=L.DomUtil.TRANSITION=L.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(L.DomUtil.TRANSITION_END="webkitTransition"===t||"OTransition"===t?t+"End":"transitionend","onselectstart"in document)L.DomUtil.disableTextSelection=function(){L.DomEvent.on(window,"selectstart",L.DomEvent.preventDefault)},L.DomUtil.enableTextSelection=function(){L.DomEvent.off(window,"selectstart",L.DomEvent.preventDefault)};else{var e=L.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);L.DomUtil.disableTextSelection=function(){if(e){var t=document.documentElement.style;this._userSelect=t[e],t[e]="none"}},L.DomUtil.enableTextSelection=function(){e&&(document.documentElement.style[e]=this._userSelect,delete this._userSelect)}}L.DomUtil.disableImageDrag=function(){L.DomEvent.on(window,"dragstart",L.DomEvent.preventDefault)},L.DomUtil.enableImageDrag=function(){L.DomEvent.off(window,"dragstart",L.DomEvent.preventDefault)}}(),L.LatLng=function(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,i!==undefined&&(this.alt=+i)},L.LatLng.prototype={equals:function(t,e){if(!t)return!1;t=L.latLng(t);var i=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return(e===undefined?1e-9:e)>=i},toString:function(t){return"LatLng("+L.Util.formatNum(this.lat,t)+", "+L.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){return L.CRS.Earth.distance(this,L.latLng(t))},wrap:function(){return L.CRS.Earth.wrapLatLng(this)}},L.latLng=function(t,e){return t instanceof L.LatLng?t:L.Util.isArray(t)&&"object"!=typeof t[0]?3===t.length?new L.LatLng(t[0],t[1],t[2]):new L.LatLng(t[0],t[1]):t===undefined||null===t?t:"object"==typeof t&&"lat"in t?new L.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===undefined?null:new L.LatLng(t,e)},L.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},L.LatLngBounds.prototype={extend:function(t){var e,i,n=this._southWest,o=this._northEast;if(t instanceof L.LatLng)e=t,i=t;else{if(!(t instanceof L.LatLngBounds))return t?this.extend(L.latLng(t)||L.latLngBounds(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||o?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),o.lat=Math.max(i.lat,o.lat),o.lng=Math.max(i.lng,o.lng)):(this._southWest=new L.LatLng(e.lat,e.lng),this._northEast=new L.LatLng(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,o=Math.abs(e.lng-i.lng)*t;return new L.LatLngBounds(new L.LatLng(e.lat-n,e.lng-o),new L.LatLng(i.lat+n,i.lng+o))},getCenter:function(){return new L.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new L.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new L.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof L.LatLng?L.latLng(t):L.latLngBounds(t);var e,i,n=this._southWest,o=this._northEast;return t instanceof L.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=o.lat&&e.lng>=n.lng&&i.lng<=o.lng},intersects:function(t){t=L.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>=e.lat&&n.lat<=i.lat,s=o.lng>=e.lng&&n.lng<=i.lng;return r&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=L.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},L.latLngBounds=function(t,e){return!t||t instanceof L.LatLngBounds?t:new L.LatLngBounds(t,e)},L.Projection={},L.Projection.LonLat={project:function(t){return new L.Point(t.lng,t.lat)},unproject:function(t){return new L.LatLng(t.y,t.x)},bounds:L.bounds([-180,-90],[180,90])},L.Projection.SphericalMercator={R:6378137,project:function(t){var e=Math.PI/180,i=1-1e-15,n=Math.max(Math.min(Math.sin(t.lat*e),i),-i);return new L.Point(this.R*t.lng*e,this.R*Math.log((1+n)/(1-n))/2)},unproject:function(t){var e=180/Math.PI;return new L.LatLng((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return L.bounds([-t,-t],[t,t])}()},L.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),n=this.transformation.transform(e.min,i),o=this.transformation.transform(e.max,i);return L.bounds(n,o)},wrapLatLng:function(t){var e=this.wrapLng?L.Util.wrapNum(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?L.Util.wrapNum(t.lat,this.wrapLat,!0):t.lat;return L.latLng(i,e)}},L.CRS.Simple=L.extend({},L.CRS,{projection:L.Projection.LonLat,transformation:new L.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0}),L.CRS.Earth=L.extend({},L.CRS,{wrapLng:[-180,180],R:6378137,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i;return this.R*Math.acos(Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i))}}),L.CRS.EPSG3857=L.extend({},L.CRS.Earth,{code:"EPSG:3857",projection:L.Projection.SphericalMercator,transformation:function(){var t=.5/(Math.PI*L.Projection.SphericalMercator.R);return new L.Transformation(t,.5,-t,.5)}()}),L.CRS.EPSG900913=L.extend({},L.CRS.EPSG3857,{code:"EPSG:900913"}),L.CRS.EPSG4326=L.extend({},L.CRS.Earth,{code:"EPSG:4326",projection:L.Projection.LonLat,transformation:new L.Transformation(1/180,1,-1/180,.5)}),L.Map=L.Evented.extend({options:{crs:L.CRS.EPSG3857,fadeAnimation:!0,trackResize:!0,markerZoomAnimation:!0},initialize:function(t,e){e=L.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=L.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==undefined&&this.setView(L.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this.callInitHooks(),this._addLayers(this.options.layers)},setView:function(t,e){return e=e===undefined?this.getZoom():e,this._resetView(L.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),o=this.getSize().divideBy(2),r=t instanceof L.Point?t:this.latLngToContainerPoint(t),s=r.subtract(o).multiplyBy(1-1/n),a=this.containerPointToLatLng(o.add(s));return this.setView(a,e,{zoom:i})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():L.latLngBounds(t);var i=L.point(e.paddingTopLeft||e.padding||[0,0]),n=L.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,i.add(n));o=e.maxZoom?Math.min(e.maxZoom,o):o;var r=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o),l=this.unproject(s.add(a).divideBy(2).add(r),o);return this.setView(l,o,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(L.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=L.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):this.off("moveend",this._panInsideMaxBounds)},panInsideBounds:function(t,e){var i=this.getCenter(),n=this._limitCenter(i,this._zoom,t);return i.equals(n)?this:this.panTo(n,e)},invalidateSize:function(t){if(!this._loaded)return this;t=L.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),o=i.divideBy(2).round(),r=n.subtract(o);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(L.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=undefined}return L.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload"),this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),n=L.DomUtil.create("div",i,e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new L.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===undefined?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===undefined?this._layersMaxZoom===undefined?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=L.latLngBounds(t);var n,o=this.getMinZoom()-(e?1:0),r=this.getMaxZoom(),s=this.getSize(),a=t.getNorthWest(),l=t.getSouthEast(),c=!0;i=L.point(i||[0,0]);do o++,n=this.project(l,o).subtract(this.project(a,o)).add(i),c=e?n.x<s.x||n.y<s.y:s.contains(n);while(c&&r>=o);return c&&e?null:e?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new L.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new L.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPixelWorldBounds:function(){return this.options.crs.getProjectedBounds(this.getZoom())},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===undefined?this._zoom:e,this.options.crs.latLngToPoint(L.latLng(t),e)},unproject:function(t,e){return e=e===undefined?this._zoom:e,this.options.crs.pointToLatLng(L.point(t),e)},layerPointToLatLng:function(t){var e=L.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(L.latLng(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(L.latLng(t))},distance:function(t,e){return this.options.crs.distance(L.latLng(t),L.latLng(e))},containerPointToLayerPoint:function(t){return L.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return L.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(L.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(t)))},mouseEventToContainerPoint:function(t){return L.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=L.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&L.Browser.any3d,L.DomUtil.addClass(t,"leaflet-container"+(L.Browser.touch?" leaflet-touch":"")+(L.Browser.retina?" leaflet-retina":"")+(L.Browser.ielt9?" leaflet-oldie":"")+(L.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=L.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=this.createPane("mapPane",this._container),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(L.DomUtil.addClass(t.markerPane,"leaflet-zoom-hide"),L.DomUtil.addClass(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,i,n){var o=this._zoom!==e;n||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),i?this._initialTopLeftPoint._add(this._getMapPanePos()):L.DomUtil.setPosition(this._mapPane,new L.Point(0,0));var r=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!i}),r&&this.fire("load"),this.fire("move"),(o||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!i})},_rawPanBy:function(t){L.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){L.DomEvent&&(t=t||"on",L.DomEvent[t](this._container,"click dblclick mousedown mouseup mouseenter mouseleave mousemove contextmenu",this._handleMouseEvent,this),this.options.trackResize&&L.DomEvent[t](window,"resize",this._onResize,this))},_onResize:function(){L.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=L.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_handleMouseEvent:function(t){this._loaded&&this._fireMouseEvent(this,t,"mouseenter"===t.type?"mouseover":"mouseleave"===t.type?"mouseout":t.type)},_fireMouseEvent:function(t,e,i,n,o){if(i=i||e.type,!L.DomEvent._skipped(e)){if("click"===i){if(!e._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved()))return;t.fire("preclick")}if(t.listens(i,n)){"contextmenu"===i&&L.DomEvent.preventDefault(e),("click"===i||"dblclick"===i||"contextmenu"===i)&&L.DomEvent.stopPropagation(e);var r={originalEvent:e,containerPoint:this.mouseEventToContainerPoint(e)};r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=o||this.layerPointToLatLng(r.layerPoint),t.fire(i,r,n)}}},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return L.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewTopLeftPoint(i,e).add(this._getMapPanePos());return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),o=this.getSize().divideBy(2),r=new L.Bounds(n.subtract(o),n.add(o)),s=this._getBoundsOffset(r,i,e);return this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new L.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=this.project(e.getNorthWest(),i).subtract(t.min),o=this.project(e.getSouthEast(),i).subtract(t.max),r=this._rebound(n.x,-o.x),s=this._rebound(n.y,-o.y);return new L.Point(r,s)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return Math.max(e,Math.min(i,t))}}),L.map=function(t,e){return new L.Map(t,e)},L.Layer=L.Evented.extend({options:{pane:"overlayPane"},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},_layerAdd:function(t){var e=t.target;e.hasLayer(this)&&(this._map=e,this._zoomAnimated=e._zoomAnimated,this.onAdd(e),this.getAttribution&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution()),this.getEvents&&e.on(this.getEvents(),this),this.fire("add"),e.fire("layeradd",{layer:this}))}}),L.Map.include({addLayer:function(t){var e=L.stamp(t);return this._layers[e]?t:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=L.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),t.getEvents&&this.off(t.getEvents(),t),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&L.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){t=t?L.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e])},_addZoomLimit:function(t){(isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[L.stamp(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=L.stamp(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-(1/0),i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var o=this._zoomBoundLayers[n].options;t=o.minZoom===undefined?t:Math.min(t,o.minZoom),e=o.maxZoom===undefined?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-(1/0)?undefined:e,
this._layersMinZoom=t===1/0?undefined:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange")}}),L.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:L.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,o=this.R_MINOR/i,r=Math.sqrt(1-o*o),s=r*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),r/2);return n=-i*Math.log(Math.max(a,1e-10)),new L.Point(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,o=this.R_MINOR/n,r=Math.sqrt(1-o*o),s=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(s),l=0,c=.1;15>l&&Math.abs(c)>1e-7;l++)e=r*Math.sin(a),e=Math.pow((1-e)/(1+e),r/2),c=Math.PI/2-2*Math.atan(s*e)-a,a+=c;return new L.LatLng(a*i,t.x*i/n)}},L.CRS.EPSG3395=L.extend({},L.CRS.Earth,{code:"EPSG:3395",projection:L.Projection.Mercator,transformation:function(){var t=.5/(Math.PI*L.Projection.Mercator.R);return new L.Transformation(t,.5,-t,.5)}()}),L.GridLayer=L.Layer.extend({options:{pane:"tilePane",tileSize:256,opacity:1,unloadInvisibleTiles:L.Browser.mobile,updateWhenIdle:L.Browser.mobile,updateInterval:150},initialize:function(t){t=L.setOptions(this,t)},onAdd:function(){this._initContainer(),this.options.updateWhenIdle||(this._update=L.Util.throttle(this._update,this.options.updateInterval,this)),this._reset(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._clearBgBuffer(),L.DomUtil.remove(this._container),t._removeZoomLimit(this),this._container=null},bringToFront:function(){return this._map&&(L.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(L.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},getEvents:function(){var t={viewreset:this._reset,moveend:this._update};return this.options.updateWhenIdle||(t.move=this._update),this._zoomAnimated&&(t.zoomstart=this._startZoomAnim,t.zoomanim=this._animateZoom,t.zoomend=this._endZoomAnim),t},_updateZIndex:function(){this._container&&this.options.zIndex!==undefined&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-(1/0),1/0),o=0,r=i.length;r>o;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){var t=this.options.opacity;if(L.Browser.ielt9)for(var e in this._tiles)L.DomUtil.setOpacity(this._tiles[e],t);else L.DomUtil.setOpacity(this._container,t)},_initContainer:function(){if(!this._container){if(this._container=L.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._zoomAnimated){var t="leaflet-tile-container leaflet-zoom-animated";this._bgBuffer=L.DomUtil.create("div",t,this._container),this._tileContainer=L.DomUtil.create("div",t,this._container),L.DomUtil.setTransform(this._tileContainer)}else this._tileContainer=this._container;this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container)}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this._tilesTotal=0,this._tileContainer.innerHTML="",this._zoomAnimated&&t&&t.hard&&this._clearBgBuffer(),this._tileNumBounds=this._getTileNumBounds(),this._resetWrap()},_resetWrap:function(){var t=this._map,e=t.options.crs;if(!e.infinite){var i=this._getTileSize();e.wrapLng&&(this._wrapLng=[Math.floor(t.project([0,e.wrapLng[0]]).x/i),Math.ceil(t.project([0,e.wrapLng[1]]).x/i)]),e.wrapLat&&(this._wrapLat=[Math.floor(t.project([e.wrapLat[0],0]).y/i),Math.ceil(t.project([e.wrapLat[1],0]).y/i)])}},_getTileSize:function(){return this.options.tileSize},_update:function(){if(this._map){var t=this._map.getPixelBounds(),e=this._map.getZoom(),i=this._getTileSize();if(!(e>this.options.maxZoom||e<this.options.minZoom)){var n=L.bounds(t.min.divideBy(i).floor(),t.max.divideBy(i).floor());this._addTiles(n),this.options.unloadInvisibleTiles&&this._removeOtherTiles(n)}}},_addTiles:function(t){var e,i,n,o=[],r=t.getCenter(),s=this._map.getZoom();for(e=t.min.y;e<=t.max.y;e++)for(i=t.min.x;i<=t.max.x;i++)n=new L.Point(i,e),n.z=s,this._tileCoordsToKey(n)in this._tiles||!this._isValidTile(n)||o.push(n);var a=o.length;if(0!==a){this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=a,this._tilesTotal+=a,o.sort(function(t,e){return t.distanceTo(r)-e.distanceTo(r)});var l=document.createDocumentFragment();for(i=0;a>i;i++)this._addTile(o[i],l);this._tileContainer.appendChild(l)}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._tileNumBounds;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return L.latLngBounds(this.options.bounds).intersects(n)},_tileCoordsToBounds:function(t){var e=this._map,i=this.options.tileSize,n=t.multiplyBy(i),o=n.add([i,i]),r=e.wrapLatLng(e.unproject(n,t.z)),s=e.wrapLatLng(e.unproject(o,t.z));return new L.LatLngBounds(r,s)},_tileCoordsToKey:function(t){return t.x+":"+t.y},_keyToTileCoords:function(t){var e=t.split(":"),i=parseInt(e[0],10),n=parseInt(e[1],10);return new L.Point(i,n)},_removeOtherTiles:function(t){for(var e in this._tiles)t.contains(this._keyToTileCoords(e))||this._removeTile(e)},_removeTile:function(t){var e=this._tiles[t];L.DomUtil.remove(e),delete this._tiles[t],this.fire("tileunload",{tile:e})},_initTile:function(t){var e=this._getTileSize();L.DomUtil.addClass(t,"leaflet-tile"),t.style.width=e+"px",t.style.height=e+"px",t.onselectstart=L.Util.falseFn,t.onmousemove=L.Util.falseFn,L.Browser.ielt9&&this.options.opacity<1&&L.DomUtil.setOpacity(t,this.options.opacity),L.Browser.android&&!L.Browser.android23&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t);this._wrapCoords(t);var n=this.createTile(t,L.bind(this._tileReady,this));this._initTile(n),this.createTile.length<2&&setTimeout(L.bind(this._tileReady,this,null,n),0),L.DomUtil.setPosition(n,i,!0),this._tiles[this._tileCoordsToKey(t)]=n,e.appendChild(n),this.fire("tileloadstart",{tile:n})},_tileReady:function(t,e){t&&this.fire("tileerror",{error:t,tile:e}),L.DomUtil.addClass(e,"leaflet-tile-loaded"),this.fire("tileload",{tile:e}),this._tilesToLoad--,0===this._tilesToLoad&&this._visibleTilesReady()},_visibleTilesReady:function(){this.fire("load"),this._zoomAnimated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(L.bind(this._clearBgBuffer,this),300))},_getTilePos:function(t){return t.multiplyBy(this._getTileSize()).subtract(this._map.getPixelOrigin())},_wrapCoords:function(t){t.x=this._wrapLng?L.Util.wrapNum(t.x,this._wrapLng):t.x,t.y=this._wrapLat?L.Util.wrapNum(t.y,this._wrapLat):t.y},_getTileNumBounds:function(){var t=this._map.getPixelWorldBounds(),e=this._getTileSize();return t?L.bounds(t.min.divideBy(e).floor(),t.max.divideBy(e).ceil().subtract([1,1])):null},_startZoomAnim:function(){this._prepareBgBuffer(),this._prevTranslate=this._translate||new L.Point(0,0),this._prevScale=this._scale},_animateZoom:function(t){this._translate=this._prevTranslate.multiplyBy(t.scale).add(t.origin.multiplyBy(1-t.scale)),this._scale=this._prevScale*t.scale,L.DomUtil.setTransform(this._bgBuffer,this._translate,this._scale)},_endZoomAnim:function(){var t=this._tileContainer;t.style.visibility="",L.DomUtil.toFront(t)},_clearBgBuffer:function(){var t=this._map,e=this._bgBuffer;t&&!t._animatingZoom&&!t.touchZoom._zooming&&e&&(e.innerHTML="",L.DomUtil.setTransform(e))},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer;return this._abortLoading&&this._abortLoading(),this._tilesToLoad/this._tilesTotal>.5?void(t.style.visibility="hidden"):(e.style.visibility="hidden",L.DomUtil.setTransform(e),this._tileContainer=e,this._bgBuffer=t,this._translate=new L.Point(0,0),this._scale=1,void clearTimeout(this._clearBgBufferTimer))}}),L.gridLayer=function(t){return new L.GridLayer(t)},L.TileLayer=L.GridLayer.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",zoomOffset:0},initialize:function(t,e){this._url=t,e=L.setOptions(this,e),e.detectRetina&&L.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom=Math.max(0,e.minZoom),e.maxZoom--),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split(""))},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return i.onload=L.bind(this._tileOnLoad,this,e,i),i.onerror=L.bind(this._tileOnError,this,e,i),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){return L.Util.template(this._url,L.extend({r:this.options.detectRetina&&L.Browser.retina&&this.options.maxZoom>0?"@2x":"",s:this._getSubdomain(t),x:t.x,y:this.options.tms?this._tileNumBounds.max.y-t.y:t.y,z:this._getZoomForUrl()},this.options))},_tileOnLoad:function(t,e){t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&(e.src=n),t(i,e)},_getTileSize:function(){var t=this._map,e=this.options,i=t.getZoom()+e.zoomOffset,n=e.maxNativeZoom;return n&&i>n?Math.round(t.getZoomScale(i)/t.getZoomScale(n)*e.tileSize):e.tileSize},_removeTile:function(t){var e=this._tiles[t];L.GridLayer.prototype._removeTile.call(this,t),L.Browser.android||(e.onload=null,e.src=L.Util.emptyImageUrl)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)e=this._tiles[t],e.complete||(e.onload=L.Util.falseFn,e.onerror=L.Util.falseFn,e.src=L.Util.emptyImageUrl,L.DomUtil.remove(e))}}),L.tileLayer=function(t,e){return new L.TileLayer(t,e)},L.TileLayer.WMS=L.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var i=L.extend({},this.defaultWmsParams);for(var n in e)this.options.hasOwnProperty(n)||"crs"===n||(i[n]=e[n]);e=L.setOptions(this,e),i.width=i.height=e.tileSize*(e.detectRetina&&L.Browser.retina?2:1),this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,L.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToBounds(t),i=this._crs.project(e.getNorthWest()),n=this._crs.project(e.getSouthEast()),o=(this._wmsVersion>=1.3&&this._crs===L.CRS.EPSG4326?[n.y,i.x,i.y,n.x]:[i.x,n.y,n.x,i.y]).join(","),r=L.Util.template(this._url,{s:this._getSubdomain(t)});return r+L.Util.getParamString(this.wmsParams,r,!0)+"&BBOX="+o},setParams:function(t,e){return L.extend(this.wmsParams,t),e||this.redraw(),this}}),L.tileLayer.wms=function(t,e){return new L.TileLayer.WMS(t,e)},L.ImageOverlay=L.Layer.extend({options:{opacity:1},initialize:function(t,e,i){this._url=t,this._bounds=L.latLngBounds(e),L.setOptions(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){L.DomUtil.remove(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},bringToFront:function(){return this._map&&L.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&L.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},getAttribution:function(){return this.options.attribution},getEvents:function(){var t={viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},_initImage:function(){var t=this._image=L.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));t.onselectstart=L.Util.falseFn,t.onmousemove=L.Util.falseFn,t.onload=L.bind(this.fire,this,"load"),t.src=this._url},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),t.zoom,t.center),i=this._map._latLngToNewLayerPoint(this._bounds.getSouthEast(),t.zoom,t.center).subtract(e),n=e.add(i._multiplyBy((1-1/t.scale)/2));L.DomUtil.setTransform(this._image,n,t.scale)},_reset:function(){var t=this._image,e=new L.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();L.DomUtil.setPosition(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){L.DomUtil.setOpacity(this._image,this.options.opacity)}}),L.imageOverlay=function(t,e,i){return new L.ImageOverlay(t,e,i)},L.Icon=L.Class.extend({initialize:function(t){L.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=L.point(i[e+"Size"]),o=L.point("shadow"===e&&i.shadowAnchor||i.iconAnchor||n&&n.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),n&&(t.style.width=n.x+"px",t.style.height=n.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return L.Browser.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),L.icon=function(t){return new L.Icon(t)},L.Icon.Default=L.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];var i=L.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+t+(L.Browser.retina&&"icon"===t?"-2x":"")+".png"}}),L.Icon.Default.imagePath=function(){var t,e,i,n,o=document.getElementsByTagName("script"),r=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=o.length;e>t;t++)if(i=o[t].src,i.match(r))return n=i.split(r)[0],(n?n+"/":"")+"images"}(),L.Marker=L.Layer.extend({options:{pane:"markerPane",icon:new L.Icon.Default,clickable:!0,keyboard:!0,zIndexOffset:0,opacity:1,riseOffset:250},initialize:function(t,e){L.setOptions(this,e),this._latlng=L.latLng(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._initIcon(),this.update()},onRemove:function(){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow()},getEvents:function(){var t={viewreset:this.update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=L.latLng(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),L.DomUtil.addClass(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,this._initInteraction(),t.riseOnHover&&L.DomEvent.on(i,{mouseover:this._bringToFront,mouseout:this._resetZIndex},this);var o=t.icon.createShadow(this._shadow),r=!1;o!==this._shadow&&(this._removeShadow(),r=!0),o&&L.DomUtil.addClass(o,e),this._shadow=o,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),o&&r&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&L.DomEvent.off(this._icon,{mouseover:this._bringToFront,mouseout:this._resetZIndex},this),L.DomUtil.remove(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&L.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(t){L.DomUtil.setPosition(this._icon,t),this._shadow&&L.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){this.options.clickable&&(L.DomUtil.addClass(this._icon,"leaflet-clickable"),L.DomEvent.on(this._icon,"click dblclick mousedown mouseup mouseover mouseout contextmenu keypress",this._fireMouseEvent,this),L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable()))},_fireMouseEvent:function(t,e){return"mousedown"===t.type&&L.DomEvent.preventDefault(t),"click"===t.type&&this.dragging&&this.dragging.moved()?void L.DomEvent.stopPropagation(t):("keypress"===t.type&&13===t.keyCode&&(e="click"),void(this._map&&this._map._fireMouseEvent(this,t,e,!0,this._latlng)))},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;L.DomUtil.setOpacity(this._icon,t),this._shadow&&L.DomUtil.setOpacity(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),L.marker=function(t,e){return new L.Marker(t,e)},L.DivIcon=L.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;return e.innerHTML=i.html!==!1?i.html:"",i.bgPos&&(e.style.backgroundPosition=-i.bgPos.x+"px "+-i.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),L.divIcon=function(t){return new L.DivIcon(t)},L.Map.mergeOptions({closePopupOnClick:!0}),L.Popup=L.Layer.extend({options:{pane:"popupPane",minWidth:50,maxWidth:300,offset:[0,7],autoPan:!0,autoPanPadding:[5,5],closeButton:!0,zoomAnimation:!0},initialize:function(t,e){L.setOptions(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&this.options.zoomAnimation,this._container||this._initLayout(),t._fadeAnimated&&L.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&L.DomUtil.setOpacity(this._container,1),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this},!0)},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._fadeAnimated?(L.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(L.bind(L.DomUtil.remove,L.DomUtil,this._container),200)):L.DomUtil.remove(this._container),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this},!0)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=L.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={viewreset:this._updatePosition},e=this.options;return this._zoomAnimated&&(t.zoomanim=this._animateZoom),("closeOnClick"in e?e.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),e.keepInView&&(t.moveend=this._adjustPan),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=L.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"));if(this.options.closeButton){var i=this._closeButton=L.DomUtil.create("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",L.DomEvent.on(i,"click",this._onCloseButtonClick,this)}var n=this._wrapper=L.DomUtil.create("div",t+"-content-wrapper",e);this._contentNode=L.DomUtil.create("div",t+"-content",n),L.DomEvent.disableClickPropagation(n).disableScrollPropagation(this._contentNode).on(n,"contextmenu",L.DomEvent.stopPropagation),this._tipContainer=L.DomUtil.create("div",t+"-tip-container",e),this._tip=L.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){var t=this._contentNode;if("string"==typeof this._content)t.innerHTML=this._content;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&n>o?(e.height=o+"px",L.DomUtil.addClass(t,r)):L.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=L.point(this.options.offset);this._zoomAnimated?L.DomUtil.setPosition(this._container,t):e=e.add(t);var i=this._containerBottom=-e.y,n=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=n+"px"}},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);L.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,i=this._containerWidth,n=new L.Point(this._containerLeft,-e-this._containerBottom);this._zoomAnimated&&n._add(L.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(n),r=L.point(this.options.autoPanPadding),s=L.point(this.options.autoPanPaddingTopLeft||r),a=L.point(this.options.autoPanPaddingBottomRight||r),l=t.getSize(),c=0,u=0;o.x+i+a.x>l.x&&(c=o.x+i-l.x+a.x),o.x-c-s.x<0&&(c=o.x-s.x),o.y+e+a.y>l.y&&(u=o.y+e-l.y+a.y),o.y-u-s.y<0&&(u=o.y-s.y),(c||u)&&t.fire("autopanstart").panBy([c,u])}},_onCloseButtonClick:function(t){this._close(),L.DomEvent.stop(t)}}),L.popup=function(t,e){return new L.Popup(t,e)},L.Map.include({openPopup:function(t,e,i){if(!(t instanceof L.Popup)){var n=t;t=new L.Popup(i).setContent(n)}return e&&t.setLatLng(e),this.hasLayer(t)?this:(this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),L.Layer.include({bindPopup:function(t,e){return t instanceof L.Popup?(this._popup=t,t._source=this):((!this._popup||e)&&(this._popup=new L.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&this._map&&this._map.openPopup(this._popup,t||this._latlng||this.getCenter()),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._map?this.closePopup():this.openPopup()),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){this._map.openPopup(this._popup,t.latlng)},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),L.Marker.include({bindPopup:function(t,e){var i=L.point(this.options.icon.options.popupAnchor||[0,0]).add(L.Popup.prototype.options.offset);return e=L.extend({offset:i},e),L.Layer.prototype.bindPopup.call(this,t,e)},_openPopup:L.Layer.prototype.togglePopup}),L.LayerGroup=L.Layer.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return L.stamp(t)}}),L.layerGroup=function(t){return new L.LayerGroup(t)},L.FeatureGroup=L.LayerGroup.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),L.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),L.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new L.LatLngBounds;return this.eachLayer(function(e){t.extend(e.getBounds?e.getBounds():e.getLatLng())}),t}}),L.featureGroup=function(t){return new L.FeatureGroup(t)},L.Renderer=L.Layer.extend({options:{padding:0},initialize:function(t){L.setOptions(this,t),L.stamp(this)},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&L.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update()},onRemove:function(){L.DomUtil.remove(this._container)},getEvents:function(){var t={moveend:this._update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},_animateZoom:function(t){var e=t.origin.subtract(this._map._getCenterLayerPoint()),i=this._bounds.min.add(e.multiplyBy(1-t.scale));L.DomUtil.setTransform(this._container,i,t.scale)},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new L.Bounds(i,i.add(e.multiplyBy(1+2*t)).round())}}),L.Map.include({getRenderer:function(t){var e=t.options.renderer||this.options.renderer||this._renderer;return e||(e=this._renderer=L.SVG&&L.svg()||L.Canvas&&L.canvas()),this.hasLayer(e)||this.addLayer(e),e}}),L.Path=L.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",fillOpacity:.2,clickable:!0},onAdd:function(){this._renderer=this._map.getRenderer(this),this._renderer._initPath(this),this._project(),this._update(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},getEvents:function(){return{viewreset:this._project,moveend:this._update}},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return L.setOptions(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer._bringToBack(this),this},_fireMouseEvent:function(t,e){this._map._fireMouseEvent(this,t,e,!0)},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(L.Browser.touch?10:0)}}),L.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var i=t.length,n=typeof Uint8Array!=undefined+""?Uint8Array:Array,o=new n(i);o[0]=o[i-1]=1,this._simplifyDPStep(t,o,e,0,i-1);var r,s=[];for(r=0;i>r;r++)o[r]&&s.push(t[r]);return s},_simplifyDPStep:function(t,e,i,n,o){var r,s,a,l=0;for(s=n+1;o-1>=s;s++)a=this._sqClosestPointOnSegment(t[s],t[n],t[o],!0),a>l&&(r=s,l=a);l>i&&(e[r]=1,this._simplifyDPStep(t,e,i,n,r),this._simplifyDPStep(t,e,i,r,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,r=t.length;r>n;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return r-1>o&&i.push(t[r-1]),i},clipSegment:function(t,e,i,n){var o,r,s,a=n?this._lastCode:this._getBitCode(t,i),l=this._getBitCode(e,i);for(this._lastCode=l;;){if(!(a|l))return[t,e];if(a&l)return!1;o=a||l,r=this._getEdgeIntersection(t,e,o,i),s=this._getBitCode(r,i),o===a?(t=r,a=s):(e=r,l=s)}},_getEdgeIntersection:function(t,e,i,n){var o,r,s=e.x-t.x,a=e.y-t.y,l=n.min,c=n.max;return 8&i?(o=t.x+s*(c.y-t.y)/a,r=c.y):4&i?(o=t.x+s*(l.y-t.y)/a,r=l.y):2&i?(o=c.x,r=t.y+a*(c.x-t.x)/s):1&i&&(o=l.x,r=t.y+a*(l.x-t.x)/s),new L.Point(o,r,!0)},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var o,r=e.x,s=e.y,a=i.x-r,l=i.y-s,c=a*a+l*l;return c>0&&(o=((t.x-r)*a+(t.y-s)*l)/c,o>1?(r=i.x,s=i.y):o>0&&(r+=a*o,s+=l*o)),a=t.x-r,l=t.y-s,n?a*a+l*l:new L.Point(r,s)}},L.Polyline=L.Path.extend({options:{smoothFactor:1},initialize:function(t,e){L.setOptions(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},addLatLng:function(t){return t=L.latLng(t),this._latlngs.push(t),this._bounds.extend(t),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._setLatLngs(this._latlngs),this.redraw(),t},closestLayerPoint:function(t){for(var e,i,n=1/0,o=null,r=L.LineUtil._sqClosestPointOnSegment,s=0,a=this._parts.length;a>s;s++)for(var l=this._parts[s],c=1,u=l.length;u>c;c++){e=l[c-1],i=l[c];var h=r(t,e,i,!0);n>h&&(n=h,o=r(t,e,i))}return o&&(o.distance=Math.sqrt(n)),o},getCenter:function(){var t,e,i,n,o,r,s,a=this._rings[0],l=a.length;for(t=0,e=0;l-1>t;t++)e+=a[t].distanceTo(a[t+1])/2;for(t=0,n=0;l-1>t;t++)if(o=a[t],r=a[t+1],i=o.distanceTo(r),n+=i,n>e)return s=(n-e)/i,this._map.layerPointToLatLng([r.x-s*(r.x-o.x),r.y-s*(r.y-o.y)])},getBounds:function(){return this._bounds},_setLatLngs:function(t){this._bounds=new L.LatLngBounds,this._latlngs=this._convertLatLngs(t)},_convertLatLngs:function(t){
for(var e=[],i=this._flat(t),n=0,o=t.length;o>n;n++)i?(e[n]=L.latLng(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_flat:function(t){return!L.Util.isArray(t[0])||"object"!=typeof t[0][0]},_project:function(){this._rings=[],this._projectLatlngs(this._latlngs,this._rings);var t=this._clickTolerance(),e=new L.Point(t,-t);this._latlngs.length&&(this._pxBounds=new L.Bounds(this._map.latLngToLayerPoint(this._bounds.getSouthWest())._subtract(e),this._map.latLngToLayerPoint(this._bounds.getNorthEast())._add(e)))},_projectLatlngs:function(t,e){var i,n,o=t[0]instanceof L.LatLng,r=t.length;if(o){for(n=[],i=0;r>i;i++)n[i]=this._map.latLngToLayerPoint(t[i]);e.push(n)}else for(i=0;r>i;i++)this._projectLatlngs(t[i],e)},_clipPoints:function(){if(this.options.noClip)return void(this._parts=this._rings);this._parts=[];var t,e,i,n,o,r,s,a=this._parts,l=this._renderer._bounds;for(t=0,i=0,n=this._rings.length;n>t;t++)for(s=this._rings[t],e=0,o=s.length;o-1>e;e++)r=L.LineUtil.clipSegment(s[e],s[e+1],l,e),r&&(a[i]=a[i]||[],a[i].push(r[0]),(r[1]!==s[e+1]||e===o-2)&&(a[i].push(r[1]),i++))},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;n>i;i++)t[i]=L.LineUtil.simplify(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),L.polyline=function(t,e){return new L.Polyline(t,e)},L.PolyUtil={},L.PolyUtil.clipPolygon=function(t,e){var i,n,o,r,s,a,l,c,u,h=[1,4,2,8],d=L.LineUtil;for(n=0,l=t.length;l>n;n++)t[n]._code=d._getBitCode(t[n],e);for(r=0;4>r;r++){for(c=h[r],i=[],n=0,l=t.length,o=l-1;l>n;o=n++)s=t[n],a=t[o],s._code&c?a._code&c||(u=d._getEdgeIntersection(a,s,c,e),u._code=d._getBitCode(u,e),i.push(u)):(a._code&c&&(u=d._getEdgeIntersection(a,s,c,e),u._code=d._getBitCode(u,e),i.push(u)),i.push(s));t=i}return t},L.Polygon=L.Polyline.extend({options:{fill:!0},getCenter:function(){var t,e,i,n,o,r,s,a,l,c=this._rings[0];for(s=a=l=0,t=0,i=c.length,e=i-1;i>t;e=t++)n=c[t],o=c[e],r=n.y*o.x-o.y*n.x,a+=(n.x+o.x)*r,l+=(n.y+o.y)*r,s+=3*r;return this._map.layerPointToLatLng([a/s,l/s])},_convertLatLngs:function(t){var e=L.Polyline.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof L.LatLng&&e[0].equals(e[i-1])&&e.pop(),e},_clipPoints:function(){if(this.options.noClip)return void(this._parts=this._rings);var t=this._renderer._bounds,e=this.options.weight,i=new L.Point(e,e);t=new L.Bounds(t.min.subtract(i),t.max.add(i)),this._parts=[];for(var n,o=0,r=this._rings.length;r>o;o++)n=L.PolyUtil.clipPolygon(this._rings[o],t),n.length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),L.polygon=function(t,e){return new L.Polygon(t,e)},L.Rectangle=L.Polygon.extend({initialize:function(t,e){L.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=L.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),L.rectangle=function(t,e){return new L.Rectangle(t,e)},L.CircleMarker=L.Path.extend({options:{fill:!0,radius:10},initialize:function(t,e){L.setOptions(this,e),this._latlng=L.latLng(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=L.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return L.Path.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new L.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),L.circleMarker=function(t,e){return new L.CircleMarker(t,e)},L.Circle=L.CircleMarker.extend({initialize:function(t,e,i){L.setOptions(this,i),this._latlng=L.latLng(t),this._mRadius=e},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY];return new L.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:L.Path.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===L.CRS.Earth.distance){var o=Math.PI/180,r=this._mRadius/L.CRS.Earth.R/o,s=i.project([e+r,t]),a=i.project([e-r,t]),l=s.add(a).divideBy(2),c=i.unproject(l).lat,u=Math.acos((Math.cos(r*o)-Math.sin(e*o)*Math.sin(c*o))/(Math.cos(e*o)*Math.cos(c*o)))/o;this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(u)?0:Math.max(Math.round(l.x-i.project([c,t-u]).x),1),this._radiusY=Math.max(Math.round(l.y-s.y),1)}else{var h=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(h).x}this._updateBounds()}}),L.circle=function(t,e,i){return new L.Circle(t,e,i)},L.SVG=L.Renderer.extend({_initContainer:function(){this._container=L.SVG.create("svg"),this._paths={},this._initEvents(),this._container.setAttribute("pointer-events","none")},_update:function(){if(!this._map._animatingZoom||!this._bounds){L.Renderer.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container,n=this.getPane();L.Browser.mobileWebkit&&n.removeChild(i),L.DomUtil.setPosition(i,t.min),i.setAttribute("width",e.x),i.setAttribute("height",e.y),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),L.Browser.mobileWebkit&&n.appendChild(i)}},_initPath:function(t){var e=t._path=L.SVG.create("path");t.options.className&&L.DomUtil.addClass(e,t.options.className),t.options.clickable&&L.DomUtil.addClass(e,"leaflet-clickable"),this._updateStyle(t)},_addPath:function(t){var e=t._path;this._container.appendChild(e),this._paths[L.stamp(e)]=t},_removePath:function(t){var e=t._path;L.DomUtil.remove(e),delete this._paths[L.stamp(e)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule","evenodd")):e.setAttribute("fill","none"),e.setAttribute("pointer-events",i.pointerEvents||(i.clickable?"visiblePainted":"none")))},_updatePoly:function(t,e){this._setPath(t,L.SVG.pointsToPath(t._parts,e))},_updateCircle:function(t){var e=t._point,i=t._radius,n=t._radiusY||i,o="a"+i+","+n+" 0 1,0 ",r=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+o+2*i+",0 "+o+2*-i+",0 ";this._setPath(t,r)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){L.DomUtil.toFront(t._path)},_bringToBack:function(t){L.DomUtil.toBack(t._path)},_initEvents:function(){L.DomEvent.on(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu",this._fireMouseEvent,this)},_fireMouseEvent:function(t){this._paths[L.stamp(t.target||t.srcElement)]&&this._paths[L.stamp(t.target||t.srcElement)]._fireMouseEvent(t)}}),L.extend(L.SVG,{create:function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)},pointsToPath:function(t,e){var i,n,o,r,s,a,l="";for(i=0,o=t.length;o>i;i++){for(s=t[i],n=0,r=s.length;r>n;n++)a=s[n],l+=(n?"L":"M")+a.x+" "+a.y;l+=e?L.Browser.svg?"z":"x":""}return l||"M0 0"}}),L.Browser.svg=!(!document.createElementNS||!L.SVG.create("svg").createSVGRect),L.svg=function(t){return L.Browser.svg||L.Browser.vml?new L.SVG(t):null},L.Browser.vml=!L.Browser.svg&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(i){return!1}}(),L.SVG.include(L.Browser.vml?{_initContainer:function(){this._container=L.DomUtil.create("div","leaflet-vml-container"),this._paths={},this._initEvents()},_update:function(){this._map._animatingZoom||L.Renderer.prototype._update.call(this)},_initPath:function(t){var e=t._container=L.SVG.create("shape");L.DomUtil.addClass(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=L.SVG.create("path"),e.appendChild(t._path),this._updateStyle(t)},_addPath:function(t){var e=t._container;this._container.appendChild(e),this._paths[L.stamp(e)]=t},_removePath:function(t){var e=t._container;L.DomUtil.remove(e),delete this._paths[L.stamp(e)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(e||(e=t._stroke=L.SVG.create("stroke"),o.appendChild(e)),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,e.dashStyle=n.dashArray?L.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):"",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(o.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=L.SVG.create("fill"),o.appendChild(i)),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(o.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point,i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){L.DomUtil.toFront(t._path.parentNode)},_bringToBack:function(t){L.DomUtil.toBack(t._path.parentNode)}}:{}),L.Browser.vml&&(L.SVG.create=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),L.Canvas=L.Renderer.extend({onAdd:function(){L.Renderer.prototype.onAdd.call(this),this._layers=this._layers||{},this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");L.DomEvent.on(t,"mousemove",this._onMouseMove,this).on(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),this._ctx=t.getContext("2d")},_update:function(){if(!this._map._animatingZoom||!this._bounds){L.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=L.Browser.retina?2:1;L.DomUtil.setPosition(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",L.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y)}},_initPath:function(t){this._layers[L.stamp(t)]=t},_addPath:L.Util.falseFn,_removePath:function(t){t._removed=!0,this._requestRedraw(t)},_updatePath:function(t){this._redrawBounds=t._pxBounds,this._draw(!0),t._project(),t._update(),this._draw(),this._redrawBounds=null},_updateStyle:function(t){this._requestRedraw(t)},_requestRedraw:function(t){this._map&&(this._redrawBounds=this._redrawBounds||new L.Bounds,this._redrawBounds.extend(t._pxBounds.min).extend(t._pxBounds.max),this._redrawRequest=this._redrawRequest||L.Util.requestAnimFrame(this._redraw,this))},_redraw:function(){this._redrawRequest=null,this._draw(!0),this._draw(),this._redrawBounds=null},_draw:function(t){this._clear=t;var e;for(var i in this._layers)e=this._layers[i],(!this._redrawBounds||e._pxBounds.intersects(this._redrawBounds))&&e._updatePath(),t&&e._removed&&(delete e._removed,delete this._layers[i])},_updatePoly:function(t,e){var i,n,o,r,s=t._parts,a=s.length,l=this._ctx;if(a){for(l.beginPath(),i=0;a>i;i++){for(n=0,o=s[i].length;o>n;n++)r=s[i][n],l[n?"lineTo":"moveTo"](r.x,r.y);e&&l.closePath()}this._fillStroke(l,t)}},_updateCircle:function(t){if(!t._empty()){var e=t._point,i=this._ctx,n=t._radius,o=(t._radiusY||n)/n;1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=this._clear,n=e.options;t.globalCompositeOperation=i?"destination-out":"source-over",n.fill&&(t.globalAlpha=i?1:n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill("evenodd")),n.stroke&&(t.globalAlpha=i?1:n.opacity,e._prevWeight=t.lineWidth=i?e._prevWeight+1:n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){var e=this._map.mouseEventToLayerPoint(t);for(var i in this._layers)this._layers[i]._containsPoint(e)&&this._layers[i]._fireMouseEvent(t)},_onMouseMove:function(t){if(this._map&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);for(var i in this._layers)this._handleHover(this._layers[i],t,e)}},_handleHover:function(t,e,i){t.options.clickable&&(t._containsPoint(i)?(t._mouseInside||(L.DomUtil.addClass(this._container,"leaflet-clickable"),t._fireMouseEvent(e,"mouseover"),t._mouseInside=!0),t._fireMouseEvent(e)):t._mouseInside&&(L.DomUtil.removeClass(this._container,"leaflet-clickable"),t._fireMouseEvent(e,"mouseout"),t._mouseInside=!1))},_bringToFront:L.Util.falseFn,_bringToBack:L.Util.falseFn}),L.Browser.canvas=function(){return!!document.createElement("canvas").getContext}(),L.canvas=function(t){return L.Browser.canvas?new L.Canvas(t):null},L.Polyline.prototype._containsPoint=function(t,e){var i,n,o,r,s,a,l=this._clickTolerance();if(!this._pxBounds.contains(t))return!1;for(i=0,r=this._parts.length;r>i;i++)for(a=this._parts[i],n=0,s=a.length,o=s-1;s>n;o=n++)if((e||0!==n)&&L.LineUtil.pointToSegmentDistance(t,a[o],a[n])<=l)return!0;return!1},L.Polygon.prototype._containsPoint=function(t){var e,i,n,o,r,s,a,l,c=!1;if(!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;a>o;o++)for(e=this._parts[o],r=0,l=e.length,s=l-1;l>r;s=r++)i=e[r],n=e[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(c=!c);return c||L.Polyline.prototype._containsPoint.call(this,t,!0)},L.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()},L.GeoJSON=L.FeatureGroup.extend({initialize:function(t,e){L.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,o=L.Util.isArray(t)?t:t.features;if(o){for(e=0,i=o.length;i>e;e++)n=o[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var r=this.options;if(!r.filter||r.filter(t)){var s=L.GeoJSON.geometryToLayer(t,r);return s.feature=L.GeoJSON.asFeature(t),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(t,s),this.addLayer(s)}},resetStyle:function(t){t.options=t.defaultOptions,this._setLayerStyle(t,this.options.style)},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),L.extend(L.GeoJSON,{geometryToLayer:function(t,e){var i,n,o,r,s="Feature"===t.type?t.geometry:t,a=s.coordinates,l=[],c=e&&e.pointToLayer,u=e&&e.coordsToLatLng||this.coordsToLatLng;switch(s.type){case"Point":return i=u(a),c?c(t,i):new L.Marker(i);case"MultiPoint":for(o=0,r=a.length;r>o;o++)i=u(a[o]),l.push(c?c(t,i):new L.Marker(i));return new L.FeatureGroup(l);case"LineString":case"MultiLineString":return n=this.coordsToLatLngs(a,"LineString"===s.type?0:1,u),new L.Polyline(n,e);case"Polygon":case"MultiPolygon":return n=this.coordsToLatLngs(a,"Polygon"===s.type?1:2,u),new L.Polygon(n,e);case"GeometryCollection":for(o=0,r=s.geometries.length;r>o;o++)l.push(this.geometryToLayer({geometry:s.geometries[o],type:"Feature",properties:t.properties},e));return new L.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new L.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){for(var n,o=[],r=0,s=t.length;s>r;r++)n=e?this.coordsToLatLngs(t[r],e-1,i):(i||this.coordsToLatLng)(t[r]),o.push(n);return o},latLngToCoords:function(t){return t.alt!==undefined?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(t,e,i){for(var n=[],o=0,r=t.length;r>o;o++)n.push(e?L.GeoJSON.latLngsToCoords(t[o],e-1,i):L.GeoJSON.latLngToCoords(t[o]));return!e&&i&&n.push(n[0]),n},getFeature:function(t,e){return t.feature?L.extend({},t.feature,{geometry:e}):L.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var PointToGeoJSON={toGeoJSON:function(){return L.GeoJSON.getFeature(this,{type:"Point",coordinates:L.GeoJSON.latLngToCoords(this.getLatLng())})}};L.Marker.include(PointToGeoJSON),L.Circle.include(PointToGeoJSON),L.CircleMarker.include(PointToGeoJSON),L.Polyline.prototype.toGeoJSON=function(){var t=!this._flat(this._latlngs),e=L.GeoJSON.latLngsToCoords(this._latlngs,t?1:0);return L.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"LineString",coordinates:e})},L.Polygon.prototype.toGeoJSON=function(){var t=!this._flat(this._latlngs),e=t&&!this._flat(this._latlngs[0]),i=L.GeoJSON.latLngsToCoords(this._latlngs,e?2:t?1:0,!0);return t&&1===this._latlngs.length&&(e=!0,i=[i]),t||(i=[i]),L.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"Polygon",coordinates:i})},L.LayerGroup.include({toMultiPoint:function(){var t=[];return this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)}),L.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var e="GeometryCollection"===t,i=[];return this.eachLayer(function(t){if(t.toGeoJSON){var n=t.toGeoJSON();i.push(e?n.geometry:L.GeoJSON.asFeature(n))}}),e?L.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}}),L.geoJson=function(t,e){return new L.GeoJSON(t,e)};var eventsKey="_leaflet_events";L.DomEvent={on:function(t,e,i,n){if("object"==typeof e)for(var o in e)this._on(t,o,e[o],i);else{e=L.Util.splitWords(e);for(var r=0,s=e.length;s>r;r++)this._on(t,e[r],i,n)}return this},off:function(t,e,i,n){if("object"==typeof e)for(var o in e)this._off(t,o,e[o],i);else{e=L.Util.splitWords(e);for(var r=0,s=e.length;s>r;r++)this._off(t,e[r],i,n)}return this},_on:function(t,e,i,n){var o=e+L.stamp(i)+(n?"_"+L.stamp(n):"");if(t[eventsKey]&&t[eventsKey][o])return this;var r=function(e){return i.call(n||t,e||window.event)},s=r;return L.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,r,o):(L.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,r,o),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",r,!1),t.addEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?(r=function(e){return e=e||window.event,L.DomEvent._checkMouse(t,e)?s(e):void 0},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1)):("click"===e&&L.Browser.android&&(r=function(t){return L.DomEvent._filterClick(t,s)}),t.addEventListener(e,r,!1)):"attachEvent"in t&&t.attachEvent("on"+e,r),t[eventsKey]=t[eventsKey]||{},t[eventsKey][o]=r,this)},_off:function(t,e,i,n){var o=e+L.stamp(i)+(n?"_"+L.stamp(n):""),r=t[eventsKey]&&t[eventsKey][o];return r?(L.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,o):L.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,o):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",r,!1),t.removeEventListener(e,r,!1)):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[eventsKey][o]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,L.DomEvent._skipped(t),this},disableScrollPropagation:function(t){return L.DomEvent.on(t,"mousewheel MozMousePixelScroll",L.DomEvent.stopPropagation)},disableClickPropagation:function(t){var e=L.DomEvent.stopPropagation;return L.DomEvent.on(t,L.Draggable.START.join(" "),e),L.DomEvent.on(t,{click:L.DomEvent._fakeStop,dblclick:e})},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return L.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new L.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new L.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){L.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent.timeStamp,n=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return n&&n>100&&500>n||t.target._simulatedClick&&!t._simulated?void L.DomEvent.stop(t):(L.DomEvent._lastClick=i,e(t))}},L.DomEvent.addListener=L.DomEvent.on,L.DomEvent.removeListener=L.DomEvent.off,L.Draggable=L.Evented.extend({statics:{START:L.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){this._enabled||(L.DomEvent.on(this._dragStartTarget,L.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.off(this._dragStartTarget,L.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._moved=!1,!(t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(L.DomEvent.stopPropagation(t),L.Draggable._disabled||(L.DomUtil.disableImageDrag(),L.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new L.Point(e.clientX,e.clientY),this._startPos=this._newPos=L.DomUtil.getPosition(this._element),L.DomEvent.on(document,L.Draggable.MOVE[t.type],this._onMove,this).on(document,L.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new L.Point(e.clientX,e.clientY),n=i.subtract(this._startPoint);(n.x||n.y)&&(L.Browser.touch&&Math.abs(n.x)+Math.abs(n.y)<3||(L.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=L.DomUtil.getPosition(this._element).subtract(n),L.DomUtil.addClass(document.body,"leaflet-dragging"),L.DomUtil.addClass(t.target||t.srcElement,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,L.Util.cancelAnimFrame(this._animRequest),this._animRequest=L.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),L.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(t){L.DomUtil.removeClass(document.body,"leaflet-dragging"),L.DomUtil.removeClass(t.target||t.srcElement,"leaflet-drag-target");for(var e in L.Draggable.MOVE)L.DomEvent.off(document,L.Draggable.MOVE[e],this._onMove,this).off(document,L.Draggable.END[e],this._onUp,this);L.DomUtil.enableImageDrag(),L.DomUtil.enableTextSelection(),this._moved&&this._moving&&(L.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),L.Handler=L.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),L.Map.mergeOptions({dragging:!0,inertia:!L.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:L.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),L.Map.Drag=L.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new L.Draggable(t._mapPane,t._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDown:function(){this._map._panAnim&&this._map._panAnim.stop()},_onDragStart:function(){var t=this._map;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,r=(n+e+i)%t-e-i,s=Math.abs(o+i)<Math.abs(r+i)?o:r;this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,n=+new Date-this._lastTime,o=!i.inertia||n>i.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),o)e.fire("moveend");else{var r=this._lastPos.subtract(this._positions[0]),s=(this._lastTime+n-this._times[0])/1e3,a=i.easeLinearity,l=r.multiplyBy(a/s),c=l.distanceTo([0,0]),u=Math.min(i.inertiaMaxSpeed,c),h=l.multiplyBy(u/c),d=u/(i.inertiaDeceleration*a),p=h.multiplyBy(-d/2).round();p.x&&p.y?(p=e._limitOffset(p,e.options.maxBounds),L.Util.requestAnimFrame(function(){e.panBy(p,{duration:d,easeLinearity:a,noMoveStart:!0})})):e.fire("moveend")}}}),L.Map.addInitHook("addHandler","dragging",L.Map.Drag),L.Map.mergeOptions({doubleClickZoom:!0}),L.Map.DoubleClickZoom=L.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}}),L.Map.addInitHook("addHandler","doubleClickZoom",L.Map.DoubleClickZoom),L.Map.mergeOptions({scrollWheelZoom:!0}),L.Map.ScrollWheelZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:L.DomEvent.preventDefault},this),this._delta=0},removeHooks:function(){L.DomEvent.off(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:L.DomEvent.preventDefault},this)},_onWheelScroll:function(t){var e=L.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(L.bind(this._performZoom,this),i),L.DomEvent.stop(t)},_performZoom:function(){var t=this._map,e=this._delta,i=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(i+e)-i,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(i+e):t.setZoomAround(this._lastMousePos,i+e))}}),L.Map.addInitHook("addHandler","scrollWheelZoom",L.Map.ScrollWheelZoom),L.PosAnimation=L.Evented.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[L.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(n||.5)+",1)",L.DomEvent.on(t,L.DomUtil.TRANSITION_END,this._onTransitionEnd,this),L.DomUtil.setPosition(t,e),L.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(L.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(this._newPos=this._getPos(),L.DomUtil.setPosition(this._el,this._newPos),this._onTransitionEnd(),L.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,e,i,n=this._el,o=window.getComputedStyle(n);if(L.Browser.any3d){if(i=o[L.DomUtil.TRANSFORM].match(this._transformRe),!i)return;t=parseFloat(i[1]),e=parseFloat(i[2])}else t=parseFloat(o.left),e=parseFloat(o.top);return new L.Point(t,e,!0)},_onTransitionEnd:function(){L.DomEvent.off(this._el,L.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[L.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),L.Map.include({setView:function(t,e,i){if(e=e===undefined?this._zoom:this._limitZoom(e),t=this._limitCenter(L.latLng(t),e,this.options.maxBounds),i=i||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!i.reset&&i!==!0){i.animate!==undefined&&(i.zoom=L.extend({animate:i.animate},i.zoom),i.pan=L.extend({animate:i.animate},i.pan));var n=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan);if(n)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=L.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new L.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){L.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){L.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(i)?(this.panBy(i,e),!0):!1}}),L.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});var zoomAnimated=L.DomUtil.TRANSITION&&L.Browser.any3d&&!L.Browser.mobileOpera;zoomAnimated&&L.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation,this._zoomAnimated&&L.DomEvent.on(this._mapPane,L.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),L.Map.include(zoomAnimated?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/n);return i.animate===!0||this.getSize().contains(o)?(L.Util.requestAnimFrame(function(){this.fire("movestart").fire("zoomstart")._animateZoom(t,e,!0)},this),!0):!1},_animateZoom:function(t,e,i){i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,
L.Draggable&&(L.Draggable._disabled=!0),L.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"));var n=this.getZoomScale(e),o=this._getCenterLayerPoint().add(this._getCenterOffset(t)._divideBy(1-1/n));this.fire("zoomanim",{center:t,zoom:e,origin:o,scale:n})},_onZoomTransitionEnd:function(){this._animatingZoom=!1,L.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),L.Draggable&&(L.Draggable._disabled=!1)}}:{}),L.extend(L.DomEvent,{_touchstart:L.Browser.msPointer?"MSPointerDown":L.Browser.pointer?"pointerdown":"touchstart",_touchend:L.Browser.msPointer?"MSPointerUp":L.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,i){function n(t){var e;if(L.Browser.pointer?(c.push(t.pointerId),e=c.length):e=t.touches.length,!(e>1)){var i=Date.now(),n=i-(r||i);s=t.touches?t.touches[0]:t,a=n>0&&l>=n,r=i}}function o(t){if(L.Browser.pointer){var i=c.indexOf(t.pointerId);if(-1===i)return;c.splice(i,1)}if(a){if(L.Browser.pointer){var n,o,l={};for(o in s)n=s[o],l[o]=n&&n.bind?n.bind(s):n;s=l}s.type="dblclick",e(s),r=null}}var r,s,a=!1,l=250,c=[],u="_leaflet_",h=this._touchstart,d=this._touchend;t[u+h+i]=n,t[u+d+i]=o;var p=L.Browser.pointer?document.documentElement:t;return t.addEventListener(h,n,!1),p.addEventListener(d,o,!1),L.Browser.pointer&&p.addEventListener(L.DomEvent.POINTER_CANCEL,o,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_",n=L.Browser.pointer?document.documentElement:t,o=t[i+this._touchend+e];return t.removeEventListener(this._touchstart,t[i+this._touchstart+e],!1),n.removeEventListener(this._touchend,o,!1),L.Browser.pointer&&n.removeEventListener(L.DomEvent.POINTER_CANCEL,o,!1),this}}),L.extend(L.DomEvent,{POINTER_DOWN:L.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:L.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:L.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:L.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:{},addPointerListener:function(t,e,i,n){return"touchstart"===e?this._addPointerStart(t,i,n):"touchmove"===e?this._addPointerMove(t,i,n):"touchend"===e&&this._addPointerEnd(t,i,n),this},removePointerListener:function(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(this.POINTER_DOWN,n,!1):"touchmove"===e?t.removeEventListener(this.POINTER_MOVE,n,!1):"touchend"===e&&(t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)),this},_addPointerStart:function(t,e,i){var n=L.bind(function(t){L.DomEvent.preventDefault(t),this._pointers[t.pointerId]=t,this._handlePointer(t,e)},this);if(t["_leaflet_touchstart"+i]=n,t.addEventListener(this.POINTER_DOWN,n,!1),!this._pointerDocListener){var o=L.bind(function(t){delete this._pointers[t.pointerId]},this);document.documentElement.addEventListener(this.POINTER_UP,o,!1),document.documentElement.addEventListener(this.POINTER_CANCEL,o,!1),this._pointerDocListener=!0}},_handlePointer:function(t,e){t.touches=[];for(var i in this._pointers)t.touches.push(this._pointers[i]);t.changedTouches=[t],e(t)},_addPointerMove:function(t,e,i){var n=L.bind(function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&(this._pointers[t.pointerId]=t,this._handlePointer(t,e))},this);t["_leaflet_touchmove"+i]=n,t.addEventListener(this.POINTER_MOVE,n,!1)},_addPointerEnd:function(t,e,i){var n=L.bind(function(t){delete this._pointers[t.pointerId],this._handlePointer(t,e)},this);t["_leaflet_touchend"+i]=n,t.addEventListener(this.POINTER_UP,n,!1),t.addEventListener(this.POINTER_CANCEL,n,!1)}}),L.Map.mergeOptions({touchZoom:L.Browser.touch&&!L.Browser.android23,bounceAtZoomLimits:!0}),L.Map.TouchZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]),o=e._getCenterLayerPoint();this._startCenter=i.add(n)._divideBy(2),this._startDist=i.distanceTo(n),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),e._panAnim&&e._panAnim.stop(),L.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend",this._onTouchEnd,this),L.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]);this._scale=i.distanceTo(n)/this._startDist,this._delta=i._add(n)._divideBy(2)._subtract(this._startCenter),(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(e.fire("movestart").fire("zoomstart"),this._moved=!0),L.Util.cancelAnimFrame(this._animRequest),this._animRequest=L.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),L.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map;this._center="center"===t.options.touchZoom?t.getCenter():t.layerPointToLatLng(this._getTargetCenter()),this._zoom=t.getScaleZoom(this._scale),t._animateZoom(this._center,this._zoom)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);this._zooming=!1,L.Util.cancelAnimFrame(this._animRequest),L.DomEvent.off(document,"touchmove",this._onTouchMove).off(document,"touchend",this._onTouchEnd);var t=this._map,e=t.getZoom(),i=this._zoom-e,n=t._limitZoom(e+(i>0?Math.ceil(i):Math.floor(i)));t._animateZoom(this._center,n,!0)},_getTargetCenter:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),L.Map.addInitHook("addHandler","touchZoom",L.Map.TouchZoom),L.Map.mergeOptions({tap:!0,tapTolerance:15}),L.Map.Tap=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(L.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new L.Point(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&L.DomUtil.addClass(i,"leaflet-active"),this._holdTimeout=setTimeout(L.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),L.DomEvent.on(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),L.DomEvent.off(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&L.DomUtil.removeClass(i,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new L.Point(e.clientX,e.clientY)},_simulateEvent:function(t,e){var i=document.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}),L.Browser.touch&&!L.Browser.pointer&&L.Map.addInitHook("addHandler","tap",L.Map.Tap),L.Map.mergeOptions({boxZoom:!0}),L.Map.BoxZoom=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){L.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(L.DomUtil.disableTextSelection(),L.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(t),void L.DomEvent.on(document,{mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=L.DomUtil.create("div","leaflet-zoom-box",this._container),L.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new L.Bounds(this._point,this._startPoint),i=e.getSize();L.DomUtil.setPosition(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(L.DomUtil.remove(this._box),L.DomUtil.removeClass(this._container,"leaflet-crosshair")),L.DomUtil.enableTextSelection(),L.DomUtil.enableImageDrag(),L.DomEvent.off(document,{mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(){if(this._finish(),this._moved){var t=new L.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),L.Map.addInitHook("addHandler","boxZoom",L.Map.BoxZoom),L.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),L.Map.Keyboard=L.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),L.DomEvent.on(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),L.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;i>e;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;i>e;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;i>e;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;i>e;e++)n[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;i>e;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;i>e;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){L.DomEvent.on(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){L.DomEvent.off(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=t.keyCode,i=this._map;if(e in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;i.panBy(this._panKeys[e]),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else{if(!(e in this._zoomKeys))return;i.setZoom(i.getZoom()+this._zoomKeys[e])}L.DomEvent.stop(t)}}}),L.Map.addInitHook("addHandler","keyboard",L.Map.Keyboard),L.Handler.MarkerDrag=L.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new L.Draggable(t,t)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),L.DomUtil.addClass(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),L.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,i=L.DomUtil.getPosition(t._icon),n=t._map.layerPointToLatLng(i);e&&L.DomUtil.setPosition(e,i),t._latlng=n,t.fire("move",{latlng:n}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),L.Control=L.Class.extend({options:{position:"topright"},initialize:function(t){L.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return L.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},remove:function(){return L.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),L.control=function(t){return new L.Control(t)},L.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,o){var r=i+t+" "+i+o;e[t+o]=L.DomUtil.create("div",r,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=L.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){L.DomUtil.remove(this._controlContainer)}}),L.Control.Attribution=L.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){L.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=L.DomUtil.create("div","leaflet-control-attribution"),L.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}}),L.Map.mergeOptions({attributionControl:!0}),L.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new L.Control.Attribution).addTo(this))}),L.control.attribution=function(t){return new L.Control.Attribution(t)},L.Control.Zoom=L.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=L.DomUtil.create("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,i,n,o){var r=L.DomUtil.create("a",i,n);return r.innerHTML=t,r.href="#",r.title=e,L.DomEvent.on(r,"mousedown dblclick",L.DomEvent.stopPropagation).on(r,"click",L.DomEvent.stop).on(r,"click",o,this).on(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";L.DomUtil.removeClass(this._zoomInButton,e),L.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&L.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&L.DomUtil.addClass(this._zoomInButton,e)}}),L.Map.mergeOptions({zoomControl:!0}),L.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new L.Control.Zoom,this.addControl(this.zoomControl))}),L.control.zoom=function(t){return new L.Control.Zoom(t)},L.Control.Scale=L.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=L.DomUtil.create("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=L.DomUtil.create("div",e,i)),t.imperial&&(this._iScale=L.DomUtil.create("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=L.CRS.Earth.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=1e3>e?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)-10+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),L.control.scale=function(t){return new L.Control.Scale(t)},L.Control.Layers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,i){L.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(){return this._initLayout(),this._update(),this._container},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update()},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update()},removeLayer:function(t){return t.off("add remove",this._onLayerChange,this),delete this._layers[L.stamp(t)],this._update()},_initLayout:function(){var t="leaflet-control-layers",e=this._container=L.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),L.Browser.touch?L.DomEvent.on(e,"click",L.DomEvent.stopPropagation):L.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var i=this._form=L.DomUtil.create("form",t+"-list");if(this.options.collapsed){L.Browser.android||L.DomEvent.on(e,{mouseenter:this._expand,mouseleave:this._collapse},this);var n=this._layersLink=L.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",L.Browser.touch?L.DomEvent.on(n,"click",L.DomEvent.stop).on(n,"click",this._expand,this):L.DomEvent.on(n,"focus",this._expand,this),L.DomEvent.on(i,"click",function(){setTimeout(L.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div",t+"-base",i),this._separator=L.DomUtil.create("div",t+"-separator",i),this._overlaysList=L.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_addLayer:function(t,e,i){t.on("add remove",this._onLayerChange,this);var n=L.stamp(t);this._layers[n]={layer:t,name:e,overlay:i},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,i,n;for(i in this._layers)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay;return this._separator.style.display=e&&t?"":"none",this}},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._layers[L.stamp(t.target)].overlay,i=e?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,t.target)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?(e=document.createElement("input"),e.type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers",n),e.layerId=L.stamp(t.layer),L.DomEvent.on(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name,i.appendChild(e),i.appendChild(o);var r=t.overlay?this._overlaysList:this._baseLayersList;return r.appendChild(i),i},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input");this._handlingClick=!0;for(var o=0,r=n.length;r>o;o++)t=n[o],e=this._layers[t.layerId].layer,i=this._map.hasLayer(e),t.checked&&!i?this._map.addLayer(e):!t.checked&&i&&this._map.removeLayer(e);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){L.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded")}}),L.control.layers=function(t,e,i){return new L.Control.Layers(t,e,i)},L.PosAnimation=L.DomUtil.TRANSITION?L.PosAnimation:L.PosAnimation.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=L.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=L.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));L.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){L.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),L.Map.include({_defaultLocateOptions:{timeout:1e4,watch:!1},locate:function(t){if(t=this._locateOptions=L.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=L.bind(this._handleGeolocationResponse,this),i=L.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new L.LatLng(e,i),o=180*t.coords.accuracy/40075017,r=o/Math.cos(Math.PI/180*e),s=L.latLngBounds([e-o,i-r],[e+o,i+r]),a=this._locateOptions;if(a.setView){var l=this.getBoundsZoom(s);this.setView(n,a.maxZoom?Math.min(l,a.maxZoom):l)}var c={latlng:n,bounds:s,timestamp:t.timestamp};for(var u in t.coords)"number"==typeof t.coords[u]&&(c[u]=t.coords[u]);this.fire("locationfound",c)}}),function(t,e){function i(t,e){var i=t.createElement("p"),n=t.getElementsByTagName("head")[0]||t.documentElement;return i.innerHTML="x<style>"+e+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var t=v.elements;return"string"==typeof t?t.split(" "):t}function o(t,e){var i=v.elements;"string"!=typeof i&&(i=i.join(" ")),"string"!=typeof t&&(t=t.join(" ")),v.elements=i+" "+t,c(e)}function r(t){var e=y[t[f]];return e||(e={},g++,t[f]=g,y[g]=e),e}function s(t,i,n){if(i||(i=e),h)return i.createElement(t);n||(n=r(i));var o;return o=n.cache[t]?n.cache[t].cloneNode():m.test(t)?(n.cache[t]=n.createElem(t)).cloneNode():n.createElem(t),!o.canHaveChildren||_.test(t)||o.tagUrn?o:n.frag.appendChild(o)}function a(t,i){if(t||(t=e),h)return t.createDocumentFragment();i=i||r(t);for(var o=i.frag.cloneNode(),s=0,a=n(),l=a.length;l>s;s++)o.createElement(a[s]);return o}function l(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(i){return v.shivMethods?s(i,t,e):e.createElem(i)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-:]+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(v,e.frag)}function c(t){t||(t=e);var n=r(t);return!v.shivCSS||u||n.hasCSS||(n.hasCSS=!!i(t,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),h||l(t,n),t}var u,h,d="3.7.2",p=t.html5||{},_=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,m=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f="_html5shiv",g=0,y={};!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",u="hidden"in t,h=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return"undefined"==typeof t.cloneNode||"undefined"==typeof t.createDocumentFragment||"undefined"==typeof t.createElement}()}catch(i){u=!0,h=!0}}();var v={elements:p.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:d,shivCSS:p.shivCSS!==!1,supportsUnknownElements:h,shivMethods:p.shivMethods!==!1,type:"default",shivDocument:c,createElement:s,createDocumentFragment:a,addElements:o};t.html5=v,c(e)}(this,document),Array.prototype.map||(Array.prototype.map=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=new Array(i),o=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)r in e&&(n[r]=t.call(o,e[r],r,e));return n}),"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(t,e){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var i,n,o=this.length>>>0,r=!1;for(1<arguments.length&&(n=e,r=!0),i=0;o>i;++i)this.hasOwnProperty(i)&&(r?n=t(n,this[i],i,this):(n=this[i],r=!0));if(!r)throw new TypeError("Reduce of empty array with no initial value");return n}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){"use strict";var i,n;if(null==this)throw new TypeError("this is null or not defined");var o,r=Object(this),s=r.length>>>0;if("[object Function]"!=={}.toString.call(t))throw new TypeError(t+" is not a function");for(arguments.length>=2&&(i=e),n=0;s>n;)n in r&&(o=r[n],t.call(i,o,n,r)),n++}),Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=i.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var r,s,a=[];for(r in o)t.call(o,r)&&a.push(r);if(e)for(s=0;n>s;s++)t.call(o,i[s])&&a.push(i[s]);return a}}()),Array.prototype.some||(Array.prototype.some=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=arguments.length>=2?arguments[1]:void 0,o=0;i>o;o++)if(o in e&&t.call(n,e[o],o,e))return!0;return!1}),Array.prototype.map||(Array.prototype.map=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=new Array(i),o=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)r in e&&(n[r]=t.call(o,e[r],r,e));return n}),Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=[],o=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)if(r in e){var s=e[r];t.call(o,s,r,e)&&n.push(s)}return n}),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},o=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,o.prototype=new n,o}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(this===undefined||null===this)throw new TypeError('"this" is null or not defined');var i=this.length>>>0;for(e=+e||0,Math.abs(e)===1/0&&(e=0),0>e&&(e+=i,0>e&&(e=0));i>e;e++)if(this[e]===t)return e;return-1}),"function"!=typeof Promise&&!function(){var t,e,i,n;!function(){var o={},r={};t=function(t,e,i){o[t]={deps:e,callback:i}},n=i=e=function(t){function i(e){if("."!==e.charAt(0))return e;for(var i=e.split("/"),n=t.split("/").slice(0,-1),o=0,r=i.length;r>o;o++){var s=i[o];if(".."===s)n.pop();else{if("."===s)continue;n.push(s)}}return n.join("/")}if(n._eak_seen=o,r[t])return r[t];if(r[t]={},!o[t])throw new Error("Could not find module "+t);for(var s,a=o[t],l=a.deps,c=a.callback,u=[],h=0,d=l.length;d>h;h++)u.push("exports"===l[h]?s={}:e(i(l[h])));var p=c.apply(this,u);return r[t]=s||p}}(),t("promise/all",["./utils","exports"],function(t,e){"use strict";function i(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to all.");return new e(function(e,i){function n(t){return function(e){r(t,e)}}function r(t,i){a[t]=i,0===--l&&e(a)}var s,a=[],l=t.length;0===l&&e([]);for(var c=0;c<t.length;c++)s=t[c],s&&o(s.then)?s.then(n(c),i):r(c,s)})}var n=t.isArray,o=t.isFunction;e.all=i}),t("promise/asap",["exports"],function(t){"use strict";function e(){return function(){process.nextTick(o)}}function i(){var t=0,e=new l(o),i=document.createTextNode("");return e.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}function n(){return function(){c.setTimeout(o,1)}}function o(){for(var t=0;t<u.length;t++){var e=u[t],i=e[0],n=e[1];i(n)}u=[]}function r(t,e){var i=u.push([t,e]);1===i&&s()}var s,a="undefined"!=typeof window?window:{},l=a.MutationObserver||a.WebKitMutationObserver,c="undefined"!=typeof global?global:this===undefined?window:this,u=[];s="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?e():l?i():n(),t.asap=r}),t("promise/config",["exports"],function(t){"use strict";function e(t,e){return 2!==arguments.length?i[t]:void(i[t]=e)}var i={instrument:!1};t.config=i,t.configure=e}),t("promise/polyfill",["./promise","./utils","exports"],function(t,e,i){"use strict";function n(){var t;t="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var e="Promise"in t&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){
var e;return new t.Promise(function(t){e=t}),r(e)}();e||(t.Promise=o)}var o=t.Promise,r=e.isFunction;i.polyfill=n}),t("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(t,e,i,n,o,r,s,a){"use strict";function l(t){if(!b(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof l))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],c(t,this)}function c(t,e){function i(t){_(e,t)}function n(t){f(e,t)}try{t(i,n)}catch(o){n(o)}}function u(t,e,i,n){var o,r,s,a,l=b(i);if(l)try{o=i(n),s=!0}catch(c){a=!0,r=c}else o=n,s=!0;p(e,o)||(l&&s?_(e,o):a?f(e,r):t===G?_(e,o):t===O&&f(e,o))}function h(t,e,i,n){var o=t._subscribers,r=o.length;o[r]=e,o[r+G]=i,o[r+O]=n}function d(t,e){for(var i,n,o=t._subscribers,r=t._detail,s=0;s<o.length;s+=3)i=o[s],n=o[s+e],u(e,i,n,r);t._subscribers=null}function p(t,e){var i,n=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(L(e)&&(n=e.then,b(n)))return n.call(e,function(n){return i?!0:(i=!0,void(e!==n?_(t,n):m(t,n)))},function(e){return i?!0:(i=!0,void f(t,e))}),!0}catch(o){return i?!0:(f(t,o),!0)}return!1}function _(t,e){t===e?m(t,e):p(t,e)||m(t,e)}function m(t,e){t._state===C&&(t._state=E,t._detail=e,v.async(g,t))}function f(t,e){t._state===C&&(t._state=E,t._detail=e,v.async(y,t))}function g(t){d(t,t._state=G)}function y(t){d(t,t._state=O)}var v=t.config,L=(t.configure,e.objectOrFunction),b=e.isFunction,w=(e.now,i.all),k=n.race,x=o.resolve,D=r.reject,P=s.asap;v.async=P;var C=void 0,E=0,G=1,O=2;l.prototype={constructor:l,_state:undefined,_detail:undefined,_subscribers:undefined,then:function(t,e){var i=this,n=new this.constructor(function(){});if(this._state){var o=arguments;v.async(function(){u(i._state,n,o[i._state-1],i._detail)})}else h(this,n,t,e);return n},"catch":function(t){return this.then(null,t)}},l.all=w,l.race=k,l.resolve=x,l.reject=D,a.Promise=l}),t("promise/race",["./utils","exports"],function(t,e){"use strict";function i(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to race.");return new e(function(e,i){for(var n,o=0;o<t.length;o++)n=t[o],n&&"function"==typeof n.then?n.then(e,i):e(n)})}var n=t.isArray;e.race=i}),t("promise/reject",["exports"],function(t){"use strict";function e(t){var e=this;return new e(function(e,i){i(t)})}t.reject=e}),t("promise/resolve",["exports"],function(t){"use strict";function e(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=this;return new e(function(e){e(t)})}t.resolve=e}),t("promise/utils",["exports"],function(t){"use strict";function e(t){return i(t)||"object"==typeof t&&null!==t}function i(t){return"function"==typeof t}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}var o=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=e,t.isFunction=i,t.isArray=n,t.now=o}),e("promise/polyfill").polyfill()}();var oldDG=window.DG;DG=new(function(){var t=function(){},e=function(){};return e.prototype=L,t.prototype=new e,t}());for(var prop in oldDG)oldDG.hasOwnProperty(prop)&&"undefined"==typeof DG[prop]&&(DG[prop]=oldDG[prop]);window.__dgApi__=window.__dgApi__||{},DG.version=window.__dgApi__.version,DG.debug=window.__dgApi__.debug,DG.Icon.Default.imagePath="../img/vendors/leaflet",function(t,e,i,n,o,r,s){t.GoogleAnalyticsObject=o,t[o]=t[o]||function(){(t[o].q=t[o].q||[]).push(arguments)},t[o].l=1*new Date,r=e.createElement(i),s=e.getElementsByTagName(i)[0],r.async=1,r.src=n,s.parentNode.insertBefore(r,s)}(window,document,"script","http://www.google-analytics.com/analytics.js","ga"),ga("create","UA-38243181-2","none"),ga("send","pageview");var newImg=new Image;newImg.src="http://maps.api.2gis.ru/analytics/track-user.png?sr="+window.screen.width+"x"+window.screen.height+"&v="+DG.version,DG.Map.include({addHandler:function(t,e){if(!e)return this;var i=this.options[t],n=i===Object(i)?i:null,o=this[t]=new e(this,n);return this._handlers.push(o),i&&o.enable(),this}}),DG.Map.addInitHook(function(){DG.Browser.touch||DG.DomUtil.addClass(this._container,"no-touch")});var handlers=window.__dgApi__.callbacks||[],chain=Promise.resolve();try{delete window.__dgApi__}catch(e){window.__dgApi__=undefined}handlers.forEach(function(t){chain=chain.then(t[0],t[1])}),DG.then=function(t,e){return chain.then(t,e)},chain["catch"](function(t){console.error(t)}),DG.plugin=function(t){var e,i=new RegExp(/.js$/i),n=new RegExp(/.css$/i),o=new Promise(function(o){function r(){e--,0===e&&o()}function s(t){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",t),e.onload=function(){r()},e.onerror=function(){r()},e.onreadystatechange=function(){("complete"===e.readyState||"loaded"===e.readyState)&&r()},document.getElementsByTagName("head")[0].appendChild(e)}function a(t){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t),document.getElementsByTagName("head")[0].appendChild(e),r()}function l(t){return i.test(t)}function c(t){return n.test(t)}function u(t){l(t)?s(t):c(t)?a(t):e--}DG.Util.isArray(t)&&(e=t.length,t.forEach(function(t){u(t)})),"string"==typeof t&&(e=1,u(t))});return o},DG.ajax=function(){function handleReadyState(t,e,i){return function(){return t._aborted?i(t.request):void(t.request&&4===t.request[readyState]&&(t.request.onreadystatechange=noop,twoHundo.test(t.request.status)?e(t.request):i(t.request)))}}function setHeaders(t,e){var i,n=e.headers||{};n.Accept=n.Accept||defaultHeaders.accept[e.dataType]||defaultHeaders.accept["*"],e.crossDomain||n[requestedWith]||(n[requestedWith]=defaultHeaders.requestedWith),n[contentType]||(n[contentType]=e.contentType||defaultHeaders.contentType);for(i in n)n.hasOwnProperty(i)&&"setRequestHeader"in t&&t.setRequestHeader(i,n[i])}function setCredentials(t,e){"undefined"!=typeof e.withCredentials&&"undefined"!=typeof t.withCredentials&&(t.withCredentials=!!e.withCredentials)}function generalCallback(t){lastValue=t}function urlappend(t,e){return t+(/\?/.test(t)?"&":"?")+e}function handleJsonp(t,e,i,n){var o=uniqid++,r=t.jsonpCallback||"callback",s=t.jsonpCallbackName||callbackPrefix,a=new RegExp("((^|\\?|&)"+r+")=([^&]+)"),l=n.match(a),c=doc.createElement("script"),u=0,h=-1!==navigator.userAgent.indexOf("MSIE 10.0");return l?"?"===l[3]?n=n.replace(a,"$1="+s):s=l[3]:n=urlappend(n,r+"="+s),win[s]=generalCallback,c.type="text/javascript",c.src=n,c.async=!0,"undefined"==typeof c.onreadystatechange||h||(c.event="onclick",c.htmlFor=c.id="_request_"+o),c.onerror=function(){c.onerror=c.onload=c.onreadystatechange=null,i({},"Request unknown error",{}),lastValue=undefined,head.removeChild(c),u=1},c.onload=c.onreadystatechange=function(){return c[readyState]&&"complete"!==c[readyState]&&"loaded"!==c[readyState]||u?!1:(c.onerror=c.onload=c.onreadystatechange=null,c.onclick&&c.onclick(),e(lastValue),lastValue=undefined,head.removeChild(c),void(u=1))},head.appendChild(c),{abort:function(){c.onerror=c.onload=c.onreadystatechange=null,i({},"Request is aborted: timeout",{}),lastValue=undefined,head.removeChild(c),u=1}}}function getRequest(t,e){var i,n=this.options,o=(n.type||"GET").toUpperCase(),r="string"==typeof n?n:n.url,s=n.processData!==!1&&n.data&&"string"!=typeof n.data?Ajax.toQueryString(n.data):n.data||null,a=!1;return"jsonp"!==n.type&&"GET"!==o||!s||(r=urlappend(r,s),s=null),"jsonp"===n.type?handleJsonp(n,t,e,r):(i=xhr(n),i.open(o,r,n.async===!1?!1:!0),setHeaders(i,n),setCredentials(i,n),win[xDomainRequest]&&i instanceof win[xDomainRequest]?(i.onload=t,i.onerror=e,a=!0):i.onreadystatechange=handleReadyState(this,t,e),a?setTimeout(function(){i.send(s)},200):i.send(s),i)}function buildParams(t,e,i,n){var o,r,s,a=/\[\]$/;if(DG.Util.isArray(e))for(r=0;e&&r<e.length;r++)s=e[r],i||a.test(t)?n(t,s):buildParams(t+"["+("object"==typeof s?r:"")+"]",s,i,n);else if(e&&"[object Object]"===e.toString())for(o in e)e.hasOwnProperty(o)&&buildParams(t+"["+o+"]",e[o],i,n);else n(t,e)}function setType(t){var e=t.match(/\.(json|jsonp|html|xml)(\?|$)/);return e?e[1]:"js"}function isCrossDomain(t){var e=rurl.exec(t.toLowerCase());return!(!e||e[1]===ajaxLocParts[1]&&e[2]===ajaxLocParts[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))}function doRequest(o){"crossDomain"in o||(o.crossDomain=isCrossDomain(o.url));var self={};return self.promise=new Promise(function(resolve,reject){function complete(t){o.timeout&&clearTimeout(self.timeout),self.timeout=null,self._erred?reject(t):resolve(t)}function success(resp){resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval("("+r+")");break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}self._responseArgs.resp=resp,complete(resp)}function error(t,e,i){t=self.request,self._responseArgs.resp=t,self._responseArgs.msg=e,self._responseArgs.t=i,self._erred=!0,complete(t)}self.abort=function(){self._aborted=!0,reject("aborted")},self.url=o.url,self.timeout=null,self.options=o,self._aborted=!1,self._erred=!1,self._responseArgs={};var type="jsonp"===o.type?o.type:o.dataType||setType(self.url);o.timeout&&(self.timeout=setTimeout(function(){self.abort()},o.timeout)),self.request=getRequest.call(self,success,error)}),self}function Ajax(t,e){"[object Object]"===Object.prototype.toString.call(t)&&(e=t,t=undefined),e=e||{},e.url=t||e.url;var i=doRequest(e),n=i.promise;return(e.success||e.error||e.complete)&&n.then(e.success,e.error),n.abort=i.abort,n}var win=window,doc=document,rurl=/^([\w.+-]+:)?(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,twoHundo=/^20\d$/,ajaxLocParts,ajaxLocation,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="l_dg_ajax_callback_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(t){if(t.crossDomain===!0){var e=win[xmlHttpRequest]?new XMLHttpRequest:null;if(e&&"withCredentials"in e)return e;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(t){return t}};try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],Ajax.setup=function(t){t=t||{};for(var e in t)t.hasOwnProperty(e)&&(globalSetupOptions[e]=t[e])},Ajax.toQueryString=function(t,e){var i,n,o=e||!1,r=[],s=encodeURIComponent,a=function(t,e){e="function"==typeof e?e():e||"",r[r.length]=s(t)+"="+s(e)};if(DG.Util.isArray(t))for(n=0;t&&n<t.length;n++)a(t[n].name,t[n].value);else for(i in t)t.hasOwnProperty(i)&&buildParams(i,t[i],o,a);return r.join("&").replace(/%20/g,"+")};var testxhr=win[xmlHttpRequest]?new XMLHttpRequest:null;return Ajax.corsSupport=!(!(testxhr&&"withCredentials"in testxhr||win[xDomainRequest])||DG.Browser.ie&&-1!=document.location.host.toLowerCase().search(/[-]/)),Ajax}(),DG.Label=DG.Layer.extend({options:{offset:new DG.Point(12,15),className:"dg-label",zIndexOffset:0},_typeOfString:Object.prototype.toString.call("s"),_defaultZIndex:100,initialize:function(t,e){DG.Util.setOptions(this,e),this._animated=DG.Browser.any3d,this._content=t},onAdd:function(t){this._map=t,this._el||this._initDOM(),this._visible=!0,this.setContent(this._content)._onViewReset(),t.on("viewreset",this._onViewReset,this).on("zoomanim",this._onZoomAnimation,this)},onRemove:function(t){t.off("viewreset",this._onViewReset,this).off("zoomanim",this._onZoomAnimation,this),this._visible=!1,this._el.removeChild(this._container),DG.Util.falseFn(this._container.offsetWidth),this._container=null,t.getPanes().markerPane.removeChild(this._el),this._el=null},_initDOM:function(){this._el=DG.DomUtil.create("div",this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),this._map.getPanes().markerPane),this._el.style.zIndex=this._defaultZIndex+this.options.zIndexOffset,this._container=DG.DomUtil.create("div",this.options.className+"__content",this._el),DG.DomUtil.disableTextSelection(this._container),DG.DomEvent.disableClickPropagation(this._el).on(this._container,"mousewheel",DG.DomEvent.stopPropagation).on(this._container,"contextmenu",DG.DomEvent.stopPropagation)},_onViewReset:function(){this._visible&&this._latlng&&DG.DomUtil.setPosition(this._el,this._map.latLngToLayerPoint(this._latlng).add(this.options.offset),DG.Browser.ie)},_onZoomAnimation:function(t){this._latlng&&DG.DomUtil.setPosition(this._el,this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).add(this.options.offset))},setOffset:function(t){return t instanceof DG.Point&&(this.options.offset=t,this._onViewReset()),this},setZIndexOffset:function(t){return isNaN(+t)||(this.options.zIndexOffset=+t,this._visible&&(this._el.style.zIndex=this._defaultZIndex+this.options.zIndexOffset)),this},setContent:function(t){return Object.prototype.toString.call(t)!==this._typeOfString?this:(this._content=t,this._visible&&(this._container.innerHTML=t),this)},setPosition:function(t){return t instanceof DG.LatLng?(this._latlng=t,this._onViewReset(),this):this}}),DG.label=function(t,e){return new DG.Label(t,e)},DG.Marker.include({bindLabel:function(t,e){return this._label?(this._label.setContent(t),e&&(this.options.offset!==e.offset&&this._label.setOffset(this.options.offset=e.offset),this.options["static"]!==e["static"]&&this.unbindLabel().bindLabel(t,e))):(e=DG.extend({offset:new DG.Point(5,5)},e),this._label=DG.label(t,e),this.once("remove",this.unbindLabel),e["static"]?this.showLabel():this.on("mouseover",this._mouseOverLabel).on("mouseout",this._mouseOutLabel).on("dragstart",this._dragStartLabel).on("dragend",this._dragEndLabel),"undefined"!=typeof this._map?this._updateLabelZIndex():this.once("add",this._updateLabelZIndex)),this},unbindLabel:function(){return this._label&&(this.hideLabel().off("remove",this.unbindLabel).off("mouseover",this._mouseOverLabel).off("mouseout",this._mouseOutLabel).off("dragstart",this._dragStartLabel).off("dragend",this._dragEndLabel).off("move",this._updatePosition).off("add",this._updateLabelZIndex),this._label=null),this},getLabel:function(){return this._label?this._label:null},_originalUpdateZIndex:DG.Marker.prototype._updateZIndex,_updateZIndex:function(t){return this._originalUpdateZIndex(t),this._updateLabelZIndex(),this},_updateLabelZIndex:function(){return this._label&&this._icon&&this._label.setZIndexOffset(this._icon.style.zIndex),this},showLabel:function(){return this._label&&this.on("move",this._updatePosition)._map.addLayer(this._label.setPosition(this.getLatLng())),this},hideLabel:function(){return this._label&&this.off("move",this._updatePosition)._map.removeLayer(this._label),this},_updatePosition:function(){this._label.setPosition(this.getLatLng())},_dragStartLabel:function(){this._label.isMarkerDragging=!0,this.hideLabel()},_dragEndLabel:function(){this._label.isMarkerDragging=!1,this._label.isMouseOverMarker&&this.showLabel()},_mouseOverLabel:function(){this._label.isMouseOverMarker=!0,this._label.isMarkerDragging||this.showLabel()},_mouseOutLabel:function(){this._label.isMouseOverMarker=!1,this.hideLabel()}}),DG.Marker.addInitHook(function(){"undefined"!=typeof this.options.label&&this.bindLabel(this.options.label)}),DG.Path.include({bindLabel:function(t,e){return this._label?(this._label.setContent(t),this._label.options.offset!==e.offset&&this._label.setOffset(e.offset)):(this._label=DG.label(t,e),this.on(this._labelEvents,this)),this},unbindLabel:function(){return this._label&&(this.off(this._labelEvents,this),this._map.removeLayer(this._label),this._label=null),this},getLabel:function(){return this._label?this._label:null},_labelEvents:{mouseover:function(t){this._map.addLayer(this._label.setPosition(t.latlng))},mousemove:function(t){this._label.setPosition(t.latlng)},mouseout:function(){this._map.removeLayer(this._label)},remove:function(){this._map.removeLayer(this._label)}}}),DG.Path.addInitHook(function(){"undefined"!=typeof this.options.label&&this.bindLabel(this.options.label)}),DG.Wkt={},DG.Wkt.toGeoJSON=function(t){function e(e){var i=t.substring(m).match(e);return i?(m+=i[0].length,i[0]):null}function i(t){return t&&f.match(/\d+/)&&(t.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+f}}),t}function n(){e(/^\s*/)}function o(){n();for(var t,i=0,o=[],r=[o],s=o;t=e(/^(\()/)||e(/^(\))/)||e(/^(\,)/)||e(/^[-+]?([0-9]*\.[0-9]+|[0-9]+)/);){if("("===t)r.push(s),s=[],r[r.length-1].push(s),i++;else if(")"===t){if(s=r.pop(),i--,0===i)break}else","===t?(s=[],r[r.length-1].push(s)):s.push(parseFloat(t));n()}return r.length=0,0!==i?null:o}function r(){for(var t,i,o=[];i=e(/^[-+]?([0-9]*\.[0-9]+|[0-9]+)/)||e(/^(\,)/);)","===i?(o.push(t),t=[]):(t||(t=[]),t.push(parseFloat(i))),n();return t&&o.push(t),o.length?o:null}function s(){if(!e(/^(point)/i))return null;if(n(),!e(/^(\()/))return null;var t=r();return n(),e(/^(\))/)?{type:"Point",coordinates:t[0]}:null}function a(){if(!e(/^(multipoint)/i))return null;n();var t=o();return n(),{type:"MultiPoint",coordinates:t}}function l(){if(!e(/^(multilinestring)/i))return null;n();var t=o();return n(),{type:"MultiLineString",coordinates:t}}function c(){if(!e(/^(linestring)/i))return null;if(n(),!e(/^(\()/))return null;var t=r();return e(/^(\))/)?{type:"LineString",coordinates:t}:null}function u(){return e(/^(polygon)/i)?(n(),{type:"Polygon",coordinates:o()}):null}function h(){return e(/^(multipolygon)/i)?(n(),{type:"MultiPolygon",coordinates:o()}):null}function d(){var t,i=[];if(!e(/^(geometrycollection)/i))return null;if(n(),!e(/^(\()/))return null;for(;t=p();)i.push(t),n(),e(/^(\,)/),n();return e(/^(\))/)?{type:"GeometryCollection",geometries:i}:null}function p(){return s()||c()||u()||a()||l()||h()||d()}DG.Util.isArray(t)&&(t=t[0]);var _=t.split(";");t=_.pop();var m=0,f=(_.shift()||"").split("=").pop();return i(p())},DG.Wkt.geoJsonLayer=function(t,e){return DG.geoJson(DG.Wkt.toGeoJSON(t),e)},DG.Wkt.toLatLngs=function(t){var e=DG.Wkt.toGeoJSON(t).coordinates;return DG.Util.isArray(e)?e.map(function(t){return DG.Util.isArray(t[0])?DG.GeoJSON.coordsToLatLngs(t):[DG.GeoJSON.coordsToLatLng(t)]}).reduce(function(t,e){return t.concat(e)}):DG.GeoJSON.coordsToLatLngs(e)},DG.Wkt.toPoints=function(t){return DG.Wkt.toGeoJSON(t).coordinates},DG.Wkt.pointsToLatLngOnMap=function(t,e){return function i(t){return Array.isArray(t)&&Array.isArray(t[0])?t.map(i):e.containerPointToLatLng(t)}(DG.Wkt.toPoints(t))},DG.configTheme=DG.configTheme||{},DG.configTheme.balloonOptions={offset:{x:1,y:-43}},function(t,e){"use strict";function i(e,i,n){e._eventHandlers=e._eventHandlers||[{element:e.scroller,handler:function(t){e.scroll(t)},type:"scroll"},{element:e.bar,handler:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e.selection(),e.drag.now=1},type:"touchstart mousedown"},{element:document,handler:function(){e.selection(1),e.drag.now=0},type:"mouseup blur touchend"},{element:e.bar,handler:function(t){2!=t.button&&e._pos0(t)},type:"touchstart mousedown"},{element:document,handler:function(t){e.drag.now&&e.drag(t)},type:"mousemove touchmove"},{element:t,handler:function(){e.update()},type:"resize"},{element:e.root,handler:function(){e.update()},type:"sizeChange"}],h(e._eventHandlers,function(t){t.element&&i(t.element,t.type,t.handler,n)})}function n(t,e,i){var n="data-baron-"+e;if("on"==i)t.setAttribute(n,"inited");else{if("off"!=i)return t.getAttribute(n);t.removeAttribute(n)}}function o(t){if(!n(t.root,t.direction)){var e=new p.prototype.constructor(t);return i(e,t.event,"on"),n(e.root,t.direction,"on"),e.update(),e}}function r(t){var e={};t=t||{};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function s(t){var e=r(t);e.direction=e.direction||"v";var i=t.event||function(t,i,n,o){e.$(t)[o||"on"](i,n)};return e.event=function(t,e,n,o){h(t,function(t){i(t,e,n,o)})},e}function a(t){if(this.events&&this.events[t])for(var e=0;e<this.events[t].length;e++){var i=Array.prototype.slice.call(arguments,1);this.events[t][e].apply(this,i)}}if(t){var l=t.baron,c=t.jQuery,u={v:{x:"Y",pos:"top",crossPos:"left",size:"height",crossSize:"width",client:"clientHeight",crossClient:"clientWidth",offset:"offsetHeight",crossOffset:"offsetWidth",offsetPos:"offsetTop",scroll:"scrollTop",scrollSize:"scrollHeight"},h:{x:"X",pos:"left",crossPos:"top",size:"width",crossSize:"height",client:"clientWidth",crossClient:"clientHeight",offset:"offsetWidth",crossOffset:"offsetHeight",offsetPos:"offsetLeft",scroll:"scrollLeft",scrollSize:"scrollWidth"}},h=function(i,n){var o=0;for((i.length===e||i===t)&&(i=[i]);i[o];)n.call(this,i[o],o),o++},d=function(e){var i,n,o=!1;return e=e||{},n=e.$||t.jQuery,o?e.root=i=this:i=n(e.root||e.scroller),new d.fn.constructor(i,e,n)};d.fn={constructor:function(t,e,i){var n=s(e);n.$=i,h.call(this,t,function(t,e){var i=r(n);n.root&&n.scroller?(i.scroller=n.$(n.scroller,t),i.scroller.length||(i.scroller=t)):i.scroller=t,i.root=t,this[e]=o(i),this.length=e+1}),this.params=n},dispose:function(){var t=this.params;h(this,function(e){e.dispose(t)}),this.params=null},update:function(){for(var t=0;this[t];)this[t].update.apply(this[t],arguments),t++},baron:function(t){return t.root=[],t.scroller=this.params.scroller,h.call(this,this,function(e){t.root.push(e.root)}),t.direction="v"==this.params.direction?"h":"v",t._chain=!0,d(t)}};var p={};p.prototype={constructor:function(t){function i(t,e){return h(t,e)[0]}function n(t){var e=this.barMinSize||20;t>0&&e>t&&(t=e),this.bar&&h(this.bar).css(this.origin.size,parseInt(t,10)+"px")}function o(t){this.bar&&h(this.bar).css(this.origin.pos,+t+"px")}function r(){return _[this.origin.client]-this.barTopLimit-this.bar[this.origin.offset]}function s(t){return t*r.call(this)+this.barTopLimit}function l(t){return(t-this.barTopLimit)/r.call(this)}function c(){return!1}var h,d,p,_,m,f,g,y,v;return v=y=(new Date).getTime(),h=this.$=t.$,this.event=t.event,this.events={},this.root=t.root,this.scroller=i(t.scroller),this.bar=i(t.bar,this.root),_=this.track=i(t.track,this.root),!this.track&&this.bar&&(_=this.bar.parentNode),this.clipper=this.scroller.parentNode,this.direction=t.direction,this.origin=u[this.direction],this.barOnCls=t.barOnCls,this.barTopLimit=0,g=1e3*t.pause||0,this.cursor=function(t){return t["client"+this.origin.x]||(((t.originalEvent||t).touches||{})[0]||{})["page"+this.origin.x]},this.pos=function(t){var i="page"+this.origin.x+"Offset",n=this.scroller[i]?i:this.origin.scroll;return t!==e&&(this.scroller[n]=t),this.scroller[n]},this.rpos=function(t){var e,i=this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client];return e=t?this.pos(t*i):this.pos(),e/(i||1)},this.barOn=function(t){this.barOnCls&&(t||this.scroller[this.origin.client]>=this.scroller[this.origin.scrollSize]?h(this.root).removeClass(this.barOnCls):h(this.root).addClass(this.barOnCls))},this._pos0=function(t){p=this.cursor(t)-d},this.drag=function(t){this.scroller[this.origin.scroll]=l.call(this,this.cursor(t)-p)*(this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client])},this.selection=function(t){this.event(document,"selectpos selectstart",c,t?"off":"on")},this.resize=function(){function e(){var e=i.scroller[i.origin.crossOffset]-i.scroller[i.origin.crossClient];t.freeze&&!i.clipper.style[i.origin.crossSize]&&h(i.clipper).css(i.origin.crossSize,i.clipper[i.origin.crossClient]-e+"px"),h(i.scroller).css(i.origin.crossSize,i.clipper[i.origin.crossClient]+e+"px"),Array.prototype.unshift.call(arguments,"resize"),a.apply(i,arguments),v=(new Date).getTime()}var i=this,n=0;(new Date).getTime()-v<g&&(clearTimeout(m),n=g),n?m=setTimeout(e,n):e()},this.scroll=function(){function t(){l.bar&&(i=(_[l.origin.client]-l.barTopLimit)*l.scroller[l.origin.client]/l.scroller[l.origin.scrollSize],e!=i&&(n.call(l,i),e=i),d=s.call(l,l.rpos()),o.call(l,d)),Array.prototype.unshift.call(arguments,"scroll"),a.apply(l,arguments),y=(new Date).getTime()}var e,i,r=0,l=this;(new Date).getTime()-y<g&&(clearTimeout(f),r=g),r?f=setTimeout(t,r):t()},this},update:function(t){return a.call(this,"upd",t),this.resize(1),this.barOn(),this.scroll(),this},dispose:function(t){i(this,this.event,"off"),n(this.root,t.direction,"off"),c(this.scroller).css(this.origin.crossSize,""),this.barOn(!0),a.call(this,"dispose")},on:function(t,e,i){for(var n=t.split(" "),o=0;o<n.length;o++)"init"==n[o]?e.call(this,i):(this.events[n[o]]=this.events[n[o]]||[],this.events[n[o]].push(function(t){e.call(this,t||i)}))}},d.fn.constructor.prototype=d.fn,p.prototype.constructor.prototype=p.prototype,d.noConflict=function(){return t.baron=l,d},d.version="0.6.6",c&&c.fn&&(c.fn.baron=d),t.baron=d,t.module&&module.exports&&(module.exports=d.noConflict())}}(window),function(t,e){var n=function(t){function n(t,i){a<(l.minView||0)&&(i=e),i!==e?(i+="px",this.$(s[t]).css(this.origin.pos,i).addClass(l.outside)):this.$(s[t]).css(this.origin.pos,"").removeClass(l.outside)}function o(t){try{i=document.createEvent("WheelEvent"),i.initWebKitWheelEvent(t.originalEvent.wheelDeltaX,t.originalEvent.wheelDeltaY),d.dispatchEvent(i),t.preventDefault()}catch(t){}}function r(t){var e;for(var i in t)l[i]=t[i];if(s=this.$(l.elements,this.scroller)){a=this.scroller[this.origin.client];for(var n=0;n<s.length;n++)e={},e[this.origin.size]=s[n][this.origin.offset],s[n].parentNode!==this.scroller&&this.$(s[n].parentNode).css(e),e={},e[this.origin.crossSize]=s[n].parentNode[this.origin.crossClient],this.$(s[n]).css(e),a-=s[n][this.origin.offset],h[n]=s[n].parentNode[this.origin.offsetPos],c[n]=c[n-1]||0,u[n]=u[n-1]||Math.min(h[n],0),s[n-1]&&(c[n]+=s[n-1][this.origin.offset],u[n]+=s[n-1][this.origin.offset]),(0!=n||0!=h[n])&&(this.event(s[n],"mousewheel",o,"off"),this.event(s[n],"mousewheel",o));l.limiter&&s[0]&&(this.track&&this.track!=this.scroller?(e={},e[this.origin.pos]=s[0].parentNode[this.origin.offset],this.$(this.track).css(e)):this.barTopLimit=s[0].parentNode[this.origin.offset],this.scroll()),l.limiter===!1&&(this.barTopLimit=0)}var r={element:s,handler:function(){for(var t,e=_(this)[0].parentNode,i=e.offsetTop,n=0;n<s.length;n++)s[n]===this&&(t=n);var o=i-c[t];l.scroll?l.scroll({x1:m.scroller.scrollTop,x2:o}):m.scroller.scrollTop=o},type:"click"};l.clickable&&(this._eventHandlers.push(r),p(r.element,r.type,r.handler,"off"),p(r.element,r.type,r.handler,"on"))}var s,a,l={outside:"",before:"",after:"",past:"",future:"",radius:0,minView:0},c=[],u=[],h=[],d=this.scroller,p=this.event,_=this.$,m=this;this.on("init",r,t),this.on("init scroll",function(){var t,i,o=[];if(s){for(var r,d=0;d<s.length;d++)t=0,h[d]-this.pos()<u[d]+l.radius?(t=1,i=c[d]):h[d]-this.pos()>u[d]+a-l.radius?(t=2,i=c[d]+a):(t=3,i=e),t!=o[d]&&(n.call(this,d,i),o[d]=t,r=!0);if(r)for(d=0;d<s.length;d++)1==o[d]&&l.past&&this.$(s[d]).addClass(l.past).removeClass(l.future),2==o[d]&&l.future&&this.$(s[d]).addClass(l.future).removeClass(l.past),3==o[d]&&(l.future||l.past)&&this.$(s[d]).removeClass(l.past).removeClass(l.future),o[d]!=o[d+1]&&1==o[d]&&l.before?this.$(s[d]).addClass(l.before).removeClass(l.after):o[d]!=o[d-1]&&2==o[d]&&l.after?this.$(s[d]).addClass(l.after).removeClass(l.before):this.$(s[d]).removeClass(l.before).removeClass(l.after)}}),this.on("resize upd",function(t){r.call(this,t&&t.fix)})};baron.fn.fix=function(t){for(var e=0;this[e];)n.call(this[e],t),e++;return this}}(window),function(t,e){var i=function(t){var e,i,n,o,r=this;o=t.screen||.9,t.forward&&(e=this.$(t.forward,this.clipper),this.event(e,"click",function(){var e=r.pos()-t.delta||30;r.pos(e)})),t.backward&&(i=this.$(t.backward,this.clipper),this.event(i,"click",function(){var e=r.pos()+t.delta||30;r.pos(e)})),t.track&&(n=t.track===!0?this.track:this.$(t.track,this.clipper)[0],n&&this.event(n,"mousedown",function(t){var e=t["offset"+r.origin.x],i=r.bar[r.origin.offsetPos],n=0;i>e?n=-1:e>i+r.bar[r.origin.offset]&&(n=1);var s=r.pos()+n*o*r.scroller[r.origin.client];r.pos(s)}))};baron.fn.controls=function(t){for(var e=0;this[e];)i.call(this[e],t),e++;return this}}(window),function(t,e){var i=function(t){function e(){return g.scroller[g.origin.scroll]+g.scroller[g.origin.offset]}function i(){return g.scroller[g.origin.scrollSize]}function n(){return g.scroller[g.origin.client]}function o(t,e){var i=5e-4*t;return Math.floor(e-i*(t+550))}function r(t){u=t,t?(s(),a=setInterval(s,200)):clearInterval(a)}function s(){var s,a,u={},w=e(),k=i(),x=1==y;if(a=0,y>0&&(a=40),s=o(L,a),w>=k-L&&y>-1?x&&(L+=s):L=0,0>L&&(L=0),u[d]=L+"px",n()<=i()){g.$(h).css(u);for(var D=0;D<m.length;D++)g.$(m[D].self).css(m[D].property,Math.min(L/p*100,100)+"%")}f&&L&&g.$(g.root).addClass(f),0==L&&t.onCollapse&&t.onCollapse(),y=0,l=setTimeout(function(){y=-1},b),_&&L>p&&!c&&(_(),c=!0),0==L?v++:v=0,v>1&&(r(!1),c=!1,f&&g.$(g.root).removeClass(f))}var a,l,c,u,h=this.$(t.block),d=t.size||this.origin.size,p=t.limit||80,_=t.onExpand,m=t.elements||[],f=t.inProgress||"",g=this,y=0,v=0,L=0,b=t.waiting||500;this.on("init",function(){r(!0)}),this.on("dispose",function(){r(!1)}),this.event(this.scroller,"mousewheel DOMMouseScroll",function(t){var n=t.wheelDelta<0||t.originalEvent&&t.originalEvent.wheelDelta<0||t.detail>0;n&&(y=1,clearTimeout(l),!u&&e()>=i()&&r(!0))})};baron.fn.pull=function(t){for(var e=0;this[e];)i.call(this[e],t),e++;return this}}(window),function(){var t=DG.configTheme.balloonOptions.offset.x,e=DG.configTheme.balloonOptions.offset.y,i=DG.Popup.prototype.initialize,n=DG.Popup.prototype._initLayout,o=DG.Popup.prototype.onAdd,r=DG.Popup.prototype._adjustPan,s=baron.noConflict(),a=function(t){this[0]=t,this.length=1};a.prototype={setAttribute:function(t,e){return this[0].setAttribute(t,e),this},getAttribute:function(t){return this[0].getAttribute(t)},removeAttribute:function(t){return this[0].removeAttribute(t),this},css:function(t,e){return e?(this[0].style[t]=e,this):DG.DomUtil.getStyle(this[0],t)}},DG.Popup.prototype.options.offset=DG.point(t,e),DG.Popup.mergeOptions({border:16,mapControlsWidth:60}),DG.Popup.include({_headerContent:null,_footerContent:null,_scroller:null,_scrollerBar:null,_barWrapper:null,_baron:null,_isBaronExist:!1,_popupShowClass:"leaflet-popup_show_true",_popupHideClass:"leaflet-popup_show_false",_popupTipClass:"leaflet-popup-tip-container",_tipSVGPath:"M0 0c12.643 0 28 7.115 28 44h2c0-36.885 15.358-44 28-44h-58z",_isAutoPanPaddingUserDefined:!1,initialize:function(t,e){this._popupStructure={},this._isAutoPanPaddingUserDefined=t&&t.hasOwnProperty("autoPanPadding"),i.call(this,t,e)},onAdd:function(t){t.on("entranceshow",this._closePopup,this),o.call(this,t),this._animateOpening()},onRemove:function(t){this._animateClosing(),t.off("entranceshow",this._closePopup,this),DG.DomUtil.TRANSITION?this._removeTimeout=setTimeout(L.bind(L.DomUtil.remove,L.DomUtil,this._container),200):L.DomUtil.remove(this._container),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this},!0)},setContent:function(t){return this._isNode(t)||"object"!=typeof t?this._bodyContent=t:Object.keys(t).forEach(function(e){
this["_"+e+"Content"]=t[e]},this),this.update(),this},setHeaderContent:function(t){return this._headerContent=t,this.update(),this},setFooterContent:function(t){return this._footerContent=t,this.update(),this},getContent:function(){return this._bodyContent},getHeaderContent:function(){return this._headerContent},getFooterContent:function(){return this._footerContent},clear:function(){return Object.keys(this._popupStructure).forEach(this._clearElement,this),this._isBaronExist=!1,this},clearHeader:function(){return this._clearElement("header")},clearFooter:function(){return this._clearElement("footer")},findElement:function(t){return this._contentNode.querySelector(t)},_animateOpening:function(){DG.DomUtil.addClass(this._innerContainer,this._popupShowClass),DG.DomUtil.removeClass(this._innerContainer,this._popupHideClass)},_animateClosing:function(){DG.DomUtil.addClass(this._innerContainer,this._popupHideClass),DG.DomUtil.removeClass(this._innerContainer,this._popupShowClass)},_closePopup:function(){this._map.closePopup(this)},_isNode:function(t){return t.nodeName?!0:!1},_initLayout:function(){n.call(this),this._innerContainer=DG.DomUtil.create("div","leaflet-popup-inner "+this._popupHideClass,this._container),DG.DomEvent.disableClickPropagation(this._innerContainer),this.options.closeButton&&this._innerContainer.appendChild(this._detachEl(this._closeButton)),this._innerContainer.appendChild(this._detachEl(this._wrapper));var t=this._detachEl(this._tipContainer);if(DG.Browser.svg){var e=DG.SVG.create("path"),i=this._popupTipClass+" "+this._popupTipClass+"_svg";e.setAttribute("d",this._tipSVGPath),t=DG.SVG.create("svg"),t.setAttribute("class",i),t.appendChild(e),DG.DomEvent.disableClickPropagation(e)}else DG.DomUtil.addClass(t,this._popupTipClass+"_image"),DG.DomEvent.disableClickPropagation(t);this._innerContainer.appendChild(t)},_clearElement:function(t){return this["_"+t+"Content"]=null,this._detachEl(this._popupStructure[t]),delete this._popupStructure[t],this},_updateScrollPosition:function(){this._baron&&this._baron.update()},resize:function(){var t=this._updateLayout();if(this._updatePosition(),t)if(this._isBaronExist){DG.DomUtil.removeClass(this._scroller,"dg-scroller_hidden_true"),DG.DomUtil.addClass(this._scroller,"dg-scroller");var e=this._isBaronExist?this._scroller.scrollTop:!1;e&&(this._scroller.scrollTop=e);var i=this.options.maxHeight-2*this.options.border-this._getDelta();this._scrollerWrapper.style.height=i+"px",this._updateScrollPosition()}else this._initBaronScroller(),this._initBaron();else this._isBaronExist&&(this._scrollerWrapper.style.height="",DG.DomUtil.removeClass(this._scroller,"dg-scroller"),DG.DomUtil.addClass(this._scroller,"dg-scroller_hidden_true"),DG.DomUtil.removeClass(this._scroller,"dg-scroller"),DG.DomEvent.off(this._scroller,"scroll",this._onScroll));this._adjustPan(),this._bindAdjustPanOnTransitionEnd()},_adjustPan:function(t){if(this._map){if(t)return void("max-height"===t.propertyName&&(setTimeout(r.bind(this),1),DG.DomEvent.off(this._wrapper,DG.DomUtil.TRANSITION_END,this._adjustPan)));var e=this.options;if(e.autoPan){var i=this._map,n=this._container.offsetHeight,o=this._containerWidth,s=new L.Point(this._containerLeft,-n-this._containerBottom);this._zoomAnimated&&s._add(L.DomUtil.getPosition(this._container));var a=[e.autoPanPadding[0],e.autoPanPadding[1]];!this._isAutoPanPaddingUserDefined&&this._map._container.offsetWidth>=e.maxWidth+2*e.mapControlsWidth&&(a[0]=e.mapControlsWidth);var l=i.layerPointToContainerPoint(s),c=L.point(a),u=L.point(e.autoPanPaddingTopLeft||c),h=L.point(e.autoPanPaddingBottomRight||c),d=i.getSize(),p=0,_=0;l.x+o+h.x>d.x&&(p=l.x+o-d.x+h.x),l.x-p-u.x<0&&(p=l.x-u.x),l.y+n+h.y>d.y&&(_=l.y+n-d.y+h.y),l.y-_-u.y<0&&(_=l.y-u.y),(p||_)&&i.fire("autopanstart").panBy([p,_])}}},_bindAdjustPanOnTransitionEnd:function(){DG.DomUtil.TRANSITION?DG.DomEvent.on(this._wrapper,DG.DomUtil.TRANSITION_END,this._adjustPan,this):this._adjustPan()},_isContentHeightEnough:function(){var t=this.options;if(!t.maxHeight)return!0;var e=this._popupStructure.body?this._popupStructure.body.offsetHeight+this._getDelta():this._contentNode.offsetHeight;return e+=2*t.border,e<=t.maxHeight},_initBaronScroller:function(){var t=this._popupStructure.body.parentNode,e=this._scrollerWrapper=DG.DomUtil.create("div","dg-scroller__wrapper",t),i=this._scroller=DG.DomUtil.create("div","dg-scroller",e),n=this._barWrapper=DG.DomUtil.create("div","dg-scroller__bar-wrapper",i),o=this.options.maxHeight-2*this.options.border;this._scrollerBar=DG.DomUtil.create("div","dg-scroller__bar",n),i.appendChild(this._detachEl(this._popupStructure.body)),o-=this._getDelta(),e.style.height=Math.max(18,o)+"px",e.style.width=t.offsetWidth+5+"px",this._isBaronExist=!0,this._switchEvents()},_onScroll:function(t){this.fire("scroll",{originalEvent:t})},_onClick:function(t){t.target=t.target||t.srcElement,this._moving||this.fire("click",{originalEvent:t})},_onStart:function(t){if(this._moved=!1,!this._moving){var e=t.touches?t.touches[0]:t;this._startPoint=new DG.Point(e.clientX,e.clientY),this._toggleTouchEvents()}},_onEnd:function(t){this._toggleTouchEvents(!0),this._onClick(t),this._moving=!1},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=DG.point(e.clientX,e.clientY),n=Math.abs(i.subtract(this._startPoint).y);!n||10>n||(this._moving=this._moved=!0)},_initBaron:function(){var t=this._scrollerWrapper;this._baron=s({scroller:".dg-scroller",bar:".dg-scroller__bar",track:".dg-scroller__bar-wrapper",$:function(e){var i="[object String]"==={}.toString.call(e)?t.querySelector(e):e;return new a(i)},event:function(t,e,i,n){e.split(" ").forEach(function(e){DG.DomEvent[n||"on"](t,e,i)})}})},_initHeader:function(){this._popupStructure.header=DG.DomUtil.create("header","dg-popup__header",this._contentNode)},_initFooter:function(){this._popupStructure.footer=DG.DomUtil.create("footer","dg-popup__footer",this._contentNode)},_initBodyContainer:function(){this._popupStructure.wrapper=DG.DomUtil.create("div","dg-popup__container-wrapper",this._contentNode),this._popupStructure.body=DG.DomUtil.create("div","dg-popup__container",this._popupStructure.wrapper)},update:function(){if(this._map){if(DG.Browser.ielt9||(this._container.style.visibility="hidden"),this._switchEvents(!0),this._clearNode(this._contentNode),this._isBaronExist=!1,this._headerContent&&this._initHeader(),this._bodyContent&&this._initBodyContainer(),this._footerContent&&this._initFooter(),this._updatePopupStructure(),this.resize(),DG.DomEvent.on(this._wrapper,"click",DG.DomEvent.stopPropagation),this._switchEvents(),DG.Browser.ielt9){var t=this._popupStructure.footer;t&&(t.className+=" ie8")}DG.Browser.ielt9||(this._container.style.visibility="")}},_getDelta:function(){var t=0,e=this._popupStructure;return e.header&&(t+=e.header.offsetHeight),e.footer&&(t+=e.footer.offsetHeight),t},_updateLayout:function(){var t,e=this.options,i=this._contentNode,n=this._wrapper,o=i.style,r=n.style,s="leaflet-popup-scrolled",a=!1;o.margin=e.border+"px",DG.DomUtil.removeClass(i,s),this._isContentHeightEnough()?r.maxHeight=i.offsetHeight+2*e.border+"px":(r.maxHeight=e.maxHeight+"px",DG.DomUtil.addClass(i,s),a=!0);var l=2*e.autoPanPadding[0];return e.sprawling?(t=e.maxWidth,t=Math.min(t,this._map._container.offsetWidth-l),t=Math.max(t,e.minWidth)):(r.width="",o.whiteSpace="nowrap",t=n.offsetWidth,o.whiteSpace="",t=Math.min(t,this._map._container.offsetWidth-l),t=Math.min(Math.max(t,e.minWidth),e.maxWidth)),r.width=t+"px",this._containerWidth=this._container.offsetWidth,a},_updatePopupStructure:function(){Object.keys(this._popupStructure).forEach(function(t){this._insertContent(this["_"+t+"Content"],this._popupStructure[t])},this),this.fire("contentupdate")},_insertContent:function(t,e){t&&e&&("string"==typeof t?e.innerHTML=t:(this._clearNode(e),e.appendChild(t)))},_clearNode:function(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)},_detachEl:function(t){return t.parentNode&&t.parentNode.removeChild(t),t},_switchEvents:function(t){var e=t?"off":"on";DG.Browser.touch?DG.DomEvent[e](this._contentNode,"touchstart mousedown mousemove",this._onStart,this):DG.DomEvent[e](this._contentNode,"click",this._onClick,this),this._isBaronExist&&DG.DomEvent[e](this._scroller,"scroll",this._onScroll,this)},_toggleTouchEvents:function(t){var e=t?"off":"on";DG.DomEvent[e](this._contentNode,"touchmove",this._onMove,this)[e](this._contentNode,"touchend",this._onEnd,this)}})}(),DG.Map.include({_markerClass:"dg-customization__marker_type_mushroom",_markerShowClass:"dg-customization__marker_appear",_markerHideClass:"dg-customization__marker_disappear",_dgHideClass:"dg-popup_hidden_true",openPopup:function(t,e,i){if(!(t instanceof L.Popup)){var n=t;t=new L.Popup(i).setContent(n)}return e&&t.setLatLng(e),this.hasLayer(t)?this:(this.closePopup(),this._popup=t,t._source&&t._source._icon&&(-1!==t._source._icon.className.indexOf(this._markerClass)?(DG.DomUtil.removeClass(t._source._icon,this._markerShowClass),DG.DomUtil.addClass(t._source._icon,this._markerHideClass)):(DG.DomUtil.addClass(t._source._icon,this._dgHideClass),t._source._shadow&&DG.DomUtil.addClass(t._source._shadow,this._dgHideClass))),this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(t._source&&t._source._icon&&(-1!==t._source._icon.className.indexOf(this._markerClass)?(DG.DomUtil.removeClass(t._source._icon,this._markerHideClass),DG.DomUtil.addClass(t._source._icon,this._markerShowClass)):(DG.DomUtil.removeClass(t._source._icon,this._dgHideClass),t._source._shadow&&DG.DomUtil.removeClass(t._source._shadow,this._dgHideClass))),this.removeLayer(t)),this}}),DG.Dictionary={},DG.Dictionary.ru={pluralRules:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&4>=t%10&&t%10%1===0&&(12>t%100||t%100>14)?1:t%10===0||t%10>=5&&9>=t%10&&t%10%1===0||t%100>=11&&14>=t%100&&t%100%1===0?2:void 0}},DG.Dictionary.en={pluralRules:function(t){return 1===t?0:1}},DG.Dictionary.it={pluralRules:function(t){return 1===t?0:1}},DG.Dictionary.cs={pluralRules:function(t){return 1===t?0:t>=2&&4>=t?1:2}},DG.Dictionary.es={pluralRules:function(t){return t>=2?1:0}},DG.Locale={t:function(t,e){var i,n,o,r=this._map.options.currentLang,s=!1;return"undefined"==typeof this.constructor.Dictionary[r]&&(r="ru",this._map.setLang(r)),n=this.constructor.Dictionary[r][t],(s="undefined"!=typeof n)?(i=s?n:t,e!==undefined&&(e=parseInt(e,10),e=isNaN(e)?0:e,o=this.constructor.Dictionary[r].pluralRules(e),i=n[o]),i=DG.Util.template(i,{n:e}),i?i:t):t}},DG.Map.mergeOptions({currentLang:getPageLang()}),DG.Map.include({setLang:function(t){t&&"[object String]"===Object.prototype.toString.call(t)&&(this.options.currentLang=t,this.fire("langchange",{lang:t}))},getLang:function(){return this.options.currentLang}}),DG.RoundControl=DG.Control.extend({includes:DG.Mixin.Events,options:{position:"topright",iconClass:"default"},onAdd:function(t){var e=this._controlCLass="dg-control-round",i=this._controlIconCLass=this._controlCLass+"__icon",n=DG.DomUtil.create("div","");if(this._disable)return n;DG.DomUtil.addClass(n,e);var o=this._link=DG.DomUtil.create("a",i+" "+i+"_name_"+this.options.iconClass,n);return o.href="#",this._renderTranslation(),this._map=t,DG.DomEvent.on(n,"click",this._toggleControl,this).on(n,"dblclick",DG.DomEvent.stopPropagation).on(o,"mousedown",DG.DomEvent.stopPropagation),this.fireEvent("add"),n},onRemove:function(){this.fireEvent("remove"),DG.DomEvent.off(this._link,"click",this._toggleControl)},setState:function(t){return this._link&&this._container?(this._state&&(DG.DomUtil.removeClass(this._container,this._controlCLass+"_state_"+this._state),DG.DomUtil.removeClass(this._link,this._controlIconCLass+"_state_"+this._state),this._state=null),t&&(this._state=t,DG.DomUtil.addClass(this._container,this._controlCLass+"_state_"+this._state),DG.DomUtil.addClass(this._link,this._controlIconCLass+"_state_"+this._state)),this):this},_toggleControl:function(t){DG.DomEvent.stop(t),this.fireEvent("click")}}),DG.RoundControl.include(DG.Locale),DG.roundControl=function(t){return new DG.RoundControl(t)},DG.ProjectDetector=DG.Handler.extend({initialize:function(t){this._map=t,this._osmViewport=!1,this.project=null,this._loadProjectList()},addHooks:function(){this._map.on("move",this._projectWatch,this)},removeHooks:function(){this._map.off("move",this._projectWatch,this)},getProject:function(){return this.project?DG.Util.extend({},this.project):!1},getProjectsList:function(){return this._projectList.slice(0)},isProjectHere:function(t,e,i){return t?(t instanceof DG.LatLng||t instanceof DG.LatLngBounds||(t=DG.latLng(t)),t=t instanceof DG.LatLngBounds?DG.latLngBounds(t.getSouthWest().wrap(),t.getNorthEast().wrap()):t.wrap(),i=i||(t instanceof DG.LatLngBounds?"intersects":"contains"),e?this._testProject(i,t,e):this._projectList.filter(this._testProject.bind(this,i,t))[0]):null},_projectWatch:function(){this._osmViewport===(this.project&&this._boundInProject(this.project,"contains"))&&(this._osmViewport=!this._osmViewport,this._map.attributionControl._update(null,this._osmViewport)),this.project&&this._boundInProject(this.project)&&this._zoomInProject(this.project)||(this.project&&(this.project=null,this._map.fire("projectleave")),this._searchProject(),this.project&&(this._osmViewport===(this.project&&this._boundInProject(this.project,"contains"))&&(this._osmViewport=!this._osmViewport),this._map.attributionControl._update(null,this._osmViewport,this.project.country_code)))},_wktToBnd:function(t){var e,i,n,o;t=t.replace(/, /g,","),t.replace(" (","("),e=/^POLYGON\((.*)\)/.exec(t),o=/\((.*?)\)/g,n=o.exec(e[1]),i=n[1].split(","),i=i.map(function(t){var e=t.split(" ");return DG.latLng(parseFloat(e[1]),parseFloat(e[0]))});var r=DG.latLngBounds(i);return[[r.getSouthWest().lat,r.getSouthWest().lng],[r.getNorthEast().lat,r.getNorthEast().lng]]},_checkProject:function(t){function e(t){return t!==undefined&&null!==t}return t&&t.bounds&&e(t.code)&&e(t.domain)&&e(t.country_code)&&t.zoom_level&&e(t.zoom_level.min)&&e(t.zoom_level.max)&&t.time_zone&&e(t.time_zone.offset)},_loadProjectList:function(){var t=this;DG.projectsList||(DG.projectsList=DG.fallbackProjectsList),delete DG.fallbackProjectsList,this._projectList=DG.projectsList.filter(t._checkProject).map(function(e){var i=t._wktToBnd(e.bounds),n=new DG.LatLngBounds(i);return{code:e.code,minZoom:e.zoom_level.min,maxZoom:e.zoom_level.max,timeOffset:e.time_zone.offset,bound:i,latLngBounds:n,traffic:!!e.flags.traffic,transport:!!e.flags.public_transport,roads:!!e.flags.road_network,country_code:e.country_code,domain:e.domain}})},_searchProject:function(){this._projectList.filter(function(t){return this._boundInProject(t)&&this._zoomInProject(t)},this).some(function(t){var e=this;return this.project=t,setTimeout(function(){e._map.fire("projectchange",{getProject:e.getProject.bind(e)})},1),!0},this)},_boundInProject:function(t,e){try{return this.isProjectHere(this._map.getBounds(),t,e)}catch(i){return!1}},_testProject:function(t,e,i){return i.latLngBounds[t](e)},_zoomInProject:function(t){return this._map.getZoom()>=t.minZoom}}),DG.Map.mergeOptions({projectDetector:!0}),DG.Map.addInitHook("addHandler","projectDetector",DG.ProjectDetector),DG.configTheme=DG.configTheme||{},DG.configTheme.markersData={iconSize:[22,34],className:"dg-customization__marker dg-customization__marker_type_mushroom",iconAnchor:[10,32]};var controlAddTo=DG.Control.prototype.addTo;DG.Control.include({addTo:function(t){return t.on("langchange",this._renderTranslation,this),controlAddTo.call(this,t)},_renderTranslation:function(){}}),DG.Marker.prototype.options.icon=DG.divIcon(DG.configTheme.markersData),DG.Browser.safari51=DG.Browser.safari&&-1!==navigator.userAgent.indexOf("Version/5.1"),DG.GridLayer.include({_update:function(){if(this._map){var t=this._map.getPixelBounds(),e=this._map.getZoom(),i=this._getTileSize();if(e>this.options.maxZoom||e<this.options.minZoom)return void this._clearBgBuffer();var n=L.bounds(t.min.divideBy(i).floor(),t.max.divideBy(i).floor());this._addTiles(n),this.options.unloadInvisibleTiles&&this._removeOtherTiles(n)}}}),L.Draggable.include({_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new L.Point(e.clientX,e.clientY),n=i.subtract(this._startPoint);(n.x||n.y)&&(L.Browser.touch&&Math.abs(n.x)+Math.abs(n.y)<3||(L.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=L.DomUtil.getPosition(this._element).subtract(n),L.DomUtil.addClass(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,L.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,L.Util.cancelAnimFrame(this._animRequest),this._animRequest=L.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_onUp:function(){L.DomUtil.removeClass(document.body,"leaflet-dragging"),this._lastTarget&&(L.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in L.Draggable.MOVE)L.DomEvent.off(document,L.Draggable.MOVE[t],this._onMove,this).off(document,L.Draggable.END[t],this._onUp,this);L.DomUtil.enableImageDrag(),L.DomUtil.enableTextSelection(),this._moved&&this._moving&&(L.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}});var panBy=DG.Map.prototype.panBy,getBoundsZoom=DG.Map.prototype.getBoundsZoom;DG.Map.include({_tileLayersNumber:0,_mapMaxZoomCache:undefined,initialize:function(t,e){e=L.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=L.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),this._handlers=[],this._layers={},this._zoomBoundLayers={},this.callInitHooks(),this._addLayers(e.layers),e.center&&e.zoom!==undefined&&this.setView(L.latLng(e.center),e.zoom,{reset:!0}),this._sizeChanged=!0},setView:function(t,e,i){if(this._restrictZoom(t),e=this._limitZoom(e===undefined?this._zoom:e),t=this._limitCenter(DG.latLng(t),e,this.options.maxBounds),i=i||{},i.animate&&(i.animate=this._testAnimation(t)),this._panAnim&&this._panAnim.stop(),this._loaded&&!i.reset&&i!==!0){i.animate!==undefined&&(i.zoom=DG.extend({animate:i.animate},i.zoom),i.pan=DG.extend({animate:i.animate},i.pan));var n=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan);if(n)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){var i=panBy.call(this,t,e),n=this._restrictZoom(this.getCenter());return this.getZoom()>n&&this.setZoom(n),i},getBoundsZoom:function(t,e,i){return this._restrictZoom(t),getBoundsZoom.call(this,t,e,i)},_testAnimation:function(t){if(this.projectDetector.enabled()){var e=this.projectDetector.getProject(),i=this.projectDetector.isProjectHere(t);if(e&&i)return e.code===i.code}return!0},_updateTileLayers:function(t){t.layer instanceof DG.TileLayer&&!t.layer._isDg&&("layeradd"===t.type?this._tileLayersNumber++:this._tileLayersNumber--)},_restrictZoom:function(t){if(this._layers&&this.projectDetector.enabled()&&0===this._tileLayersNumber){var e=this.options,i=!!e.maxZoom,n=this.baseLayer,o=this.projectDetector.isProjectHere(t);return i?(this._mapMaxZoomCache||(this._mapMaxZoomCache=e.maxZoom),e.maxZoom=this._mapMaxZoomCache&&o?this._mapMaxZoomCache:"13",o&&(this._mapMaxZoomCache=e.maxZoom),e.maxZoom):(n.options.maxZoom=o?o.maxZoom:"13",n.options.maxNativeZoom=n.options.maxZoom,this._updateZoomLevels(),n.options.maxZoom)}},_fireMouseEvent:function(t,e,i,n,o){if(i=i||e.type,!L.DomEvent._skipped(e)){if("click"===i){var r=t.options.draggable===!0?t:this;if(!e._simulated&&(r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()))return void L.DomEvent.stopPropagation(e);t.fire("prepreclick"),t.fire("preclick")}if(t.listens(i,n)){"contextmenu"===i&&L.DomEvent.preventDefault(e),("click"===i||"dblclick"===i||"contextmenu"===i)&&L.DomEvent.stopPropagation(e);var s={originalEvent:e,containerPoint:this.mouseEventToContainerPoint(e)};s.layerPoint=this.containerPointToLayerPoint(s.containerPoint),s.latlng=o||this.layerPointToLatLng(s.layerPoint),t.fire(i,s,n)}}}}),DG.Map.addInitHook(function(){this.on("layeradd layerremove",this._updateTileLayers)}),DG.Map.Drag.include({_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,r=(n+e+i)%t-e-i,s=Math.abs(o+i)<Math.abs(r+i)?o:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s}}),function(){var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQMAAABmvDolAAAAA1BMVEX28t5R0k5UAAAAH0lEQVR4Xu3AAQkAAADCMPunNsdhWxwAAAAAAAAAwAEhAAABg2UP5AAAAABJRU5ErkJggg==",e="http://2gis.github.io/mapsapi/img/nomap_ru.png",i=DG.TileLayer.extend({initialize:function(t,e){this._isDg=!0,DG.TileLayer.prototype.initialize.call(this,t,e)}});DG.Map.addInitHook(function(){this.baseLayer=new i("http://tile{s}.maps.2gis.com/tiles?x={x}&y={y}&z={z}&v=1",{subdomains:"0123",errorTileUrl:"ru"===this.getLang()?e:t,detectRetina:!0,maxZoom:19,maxNativeZoom:19}).addTo(this),this.on("langchange",function(i){this.baseLayer.options.errorTileUrl="ru"===i.lang?e:t})})}(),DG.Control.Zoom.include(DG.Locale),DG.Control.Zoom.Dictionary={},DG.Control.Zoom.include({onAdd:function(t){var e="dg-zoom",i='<div class="dg-control-round__icon '+e+"__control "+e+"__button "+e+'__button_type_{type}"></div>',n=DG.DomUtil.create("div",e);return this._map=t,this._zoomInButton=this._createButton(DG.Util.template(i,{type:"in"}),this.t("zoom_in"),"dg-control-round "+e+"__in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(DG.Util.template(i,{type:"out"}),this.t("zoom_out"),"dg-control-round "+e+"__out",n,this._zoomOut,this),this._eventListeners={},this._eventListeners.zoomend=this._eventListeners.zoomlevelschange=this._updateDisabled,this._updateDisabled(),t.on(this._eventListeners,this),n},_originalCreateButton:DG.Control.Zoom.prototype._createButton,_createButton:function(){var t=Array.prototype.slice.call(arguments),e=this._originalCreateButton.apply(this,t),i=e.children[0],n="dg-control-round_state_active",o="dg-control-round__icon_state_active";return DG.DomEvent.on(e,"touchstart",function(){DG.DomUtil.addClass(e,n),DG.DomUtil.addClass(i,o)}).on(e,"touchend touchcancel",function(){DG.DomUtil.removeClass(e,n),DG.DomUtil.removeClass(i,o)}),e},onRemove:function(t){t.off(this._eventListeners,this)},_renderTranslation:function(){this._zoomInButton.title=this.t("zoom_in"),this._zoomOutButton.title=this.t("zoom_out")}}),DG.Control.Zoom.Dictionary.ru={zoom_in:"",zoom_out:""},DG.Control.Zoom.Dictionary.it={zoom_in:"Zoom avanti",zoom_out:"Zoom indietro"},DG.Control.Zoom.Dictionary.cs={zoom_in:"Piblit",zoom_out:"Oddlit"},DG.Control.Zoom.Dictionary.en={zoom_in:"Zoom in",zoom_out:"Zoom out"},DG.Control.Zoom.Dictionary.es={zoom_in:"Acercar",zoom_out:"Alejar"},function(root){function Context(t,e,i,n){this.stack=t,this.global=e,this.blocks=i,this.templateName=n}function Stack(t,e,i,n){this.tail=e,this.isObject=t&&"object"==typeof t,this.head=t,this.index=i,this.of=n}function Stub(t){this.head=new Chunk(this),this.callback=t,this.out=""}function Stream(){this.head=new Chunk(this)}function Chunk(t,e,i){this.root=t,this.next=e,this.data=[],this.flushable=!1,this.taps=i}function Tap(t,e){this.head=t,this.tail=e}var dust={version:"2.6.1"},NONE="NONE",ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",loggingLevels=[DEBUG,INFO,WARN,ERROR,NONE],EMPTY_FUNC=function(){},logger={},originalLog,loggerContext;dust.debugLevel=NONE,dust.config={whitespace:!1,amd:!1},dust._aliases={write:"w",end:"e",map:"m",render:"r",reference:"f",section:"s",exists:"x",notexists:"nx",block:"b",partial:"p",helper:"h"},root&&root.console&&root.console.log&&(loggerContext=root.console,originalLog=root.console.log),logger.log=loggerContext?function(){logger.log="function"==typeof originalLog?function(){originalLog.apply(loggerContext,arguments)}:function(){var t=Array.prototype.slice.apply(arguments).join(" ");originalLog(t)},logger.log.apply(this,arguments)}:function(){},dust.log=function(t,e){e=e||INFO,dust.debugLevel!==NONE&&dust.indexInArray(loggingLevels,e)>=dust.indexInArray(loggingLevels,dust.debugLevel)&&(dust.logQueue||(dust.logQueue=[]),dust.logQueue.push({message:t,type:e}),logger.log("[DUST:"+e+"]",t))},dust.helpers={},dust.cache={},dust.register=function(t,e){t&&(dust.cache[t]=e)},dust.render=function(t,e,i){var n=new Stub(i).head;try{dust.load(t,n,Context.wrap(e,t)).end()}catch(o){n.setError(o)}},dust.stream=function(t,e){var i=new Stream,n=i.head;return dust.nextTick(function(){try{dust.load(t,i.head,Context.wrap(e,t)).end()}catch(o){n.setError(o)}}),i},dust.renderSource=function(t,e,i){return dust.compileFn(t)(e,i)},dust.compileFn=function(t,e){e=e||null;var i=dust.loadSource(dust.compile(t,e));return function(t,n){var o=n?new Stub(n):new Stream;return dust.nextTick(function(){"function"==typeof i?i(o.head,Context.wrap(t,e)).end():dust.log(new Error("Template ["+e+"] cannot be resolved to a Dust function"),ERROR)}),o}},dust.load=function(t,e,i){var n=dust.cache[t];return n?n(e,i):dust.onLoad?e.map(function(e){dust.onLoad(t,function(n,o){return n?e.setError(n):(dust.cache[t]||dust.loadSource(dust.compile(o,t)),void dust.cache[t](e,i).end())})}):e.setError(new Error("Template Not Found: "+t))},dust.loadSource=function(source,path){return eval(source)},dust.isArray=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},dust.indexInArray=function(t,e,i){if(i=+i||0,Array.prototype.indexOf)return t.indexOf(e,i);if(t===undefined||null===t)throw new TypeError('cannot call method "indexOf" of null');var n=t.length;for(Math.abs(i)===1/0&&(i=0),0>i&&(i+=n,0>i&&(i=0));n>i;i++)if(t[i]===e)return i;return-1},dust.nextTick=function(){return function(t){setTimeout(t,0)}}(),dust.isEmpty=function(t){return dust.isArray(t)&&!t.length?!0:0===t?!1:!t},dust.filter=function(t,e,i){if(i)for(var n=0,o=i.length;o>n;n++){var r=i[n];"s"===r?e=null:"function"==typeof dust.filters[r]?t=dust.filters[r](t):dust.log("Invalid filter ["+r+"]",WARN)}return e&&(t=dust.filters[e](t)),t},dust.filters={h:function(t){return dust.escapeHtml(t)},j:function(t){return dust.escapeJs(t)},u:encodeURI,uc:encodeURIComponent,js:function(t){return dust.escapeJSON(t)},jp:function(t){return JSON?JSON.parse(t):(dust.log("JSON is undefined.  JSON parse has not been used on ["+t+"]",WARN),t)}},dust.makeBase=function(t){return new Context(new Stack,t)},Context.wrap=function(t,e){return t instanceof Context?t:new Context(new Stack(t),{},null,e)},Context.prototype.get=function(t,e){return"string"==typeof t&&("."===t[0]&&(e=!0,t=t.substr(1)),t=t.split(".")),this._get(e,t)},Context.prototype._get=function(t,e){var i,n,o,r,s,a=this.stack,l=1;if(n=e[0],o=e.length,t&&0===o)r=a,a=a.head;else{if(t)a&&(a=a.head?a.head[n]:undefined);else{for(;a&&(!a.isObject||(r=a.head,i=a.head[n],i===undefined));)a=a.tail;a=i!==undefined?i:this.global?this.global[n]:undefined}for(;a&&o>l;)r=a,a=a[e[l]],l++}return"function"==typeof a?(s=function(){try{return a.apply(r,arguments)}catch(t){throw dust.log(t,ERROR),t}},s.__dustBody=!!a.__dustBody,s):(a===undefined&&dust.log("Cannot find the value for reference [{"+e.join(".")+"}] in template ["+this.getTemplateName()+"]"),a)},Context.prototype.getPath=function(t,e){return this._get(t,e)},Context.prototype.push=function(t,e,i){return new Context(new Stack(t,this.stack,e,i),this.global,this.blocks,this.getTemplateName())},Context.prototype.rebase=function(t){return new Context(new Stack(t),this.global,this.blocks,this.getTemplateName())},Context.prototype.current=function(){return this.stack.head},Context.prototype.getBlock=function(t,e,i){if("function"==typeof t){var n=new Chunk;t=t(n,this).data.join("")}var o=this.blocks;if(!o)return void dust.log("No blocks for context[{"+t+"}] in template ["+this.getTemplateName()+"]",DEBUG);for(var r,s=o.length;s--;)if(r=o[s][t])return r},Context.prototype.shiftBlocks=function(t){var e,i=this.blocks;return t?(e=i?i.concat([t]):[t],new Context(this.stack,this.global,e,this.getTemplateName())):this},Context.prototype.getTemplateName=function(){return this.templateName},Stub.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.callback(t.error),dust.log("Chunk error ["+t.error+"] thrown. Ceasing to render this template.",WARN),void(this.flush=EMPTY_FUNC)):void 0;this.out+=t.data.join(""),t=t.next,this.head=t}this.callback(null,this.out)},Stream.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.emit("error",t.error),dust.log("Chunk error ["+t.error+"] thrown. Ceasing to render this template.",WARN),void(this.flush=EMPTY_FUNC)):void 0;this.emit("data",t.data.join("")),t=t.next,this.head=t}this.emit("end")},Stream.prototype.emit=function(t,e){if(!this.events)return dust.log("No events to emit",INFO),!1;var i=this.events[t];if(!i)return dust.log("Event type ["+t+"] does not exist",WARN),!1;if("function"==typeof i)i(e);else if(dust.isArray(i))for(var n=i.slice(0),o=0,r=n.length;r>o;o++)n[o](e);else dust.log("Event Handler ["+i+"] is not of a type that is handled by emit",WARN)},Stream.prototype.on=function(t,e){return this.events||(this.events={}),this.events[t]?"function"==typeof this.events[t]?this.events[t]=[this.events[t],e]:this.events[t].push(e):e?this.events[t]=e:dust.log("Callback for type ["+t+"] does not exist. Listener not registered.",WARN),this},Stream.prototype.pipe=function(t){return this.on("data",function(e){try{t.write(e,"utf8")}catch(i){dust.log(i,ERROR)}}).on("end",function(){try{return t.end()}catch(e){dust.log(e,ERROR)}}).on("error",function(e){t.error(e)}),this},Chunk.prototype.write=function(t){var e=this.taps;return e&&(t=e.go(t)),this.data.push(t),this},Chunk.prototype.end=function(t){return t&&this.write(t),this.flushable=!0,this.root.flush(),this},Chunk.prototype.map=function(t){var e=new Chunk(this.root,this.next,this.taps),i=new Chunk(this.root,e,this.taps);this.next=i,this.flushable=!0;try{t(i)}catch(n){dust.log(n,ERROR),i.setError(n)}return e},Chunk.prototype.tap=function(t){var e=this.taps;return this.taps=e?e.push(t):new Tap(t),this},Chunk.prototype.untap=function(){return this.taps=this.taps.tail,this},Chunk.prototype.render=function(t,e){return t(this,e)},Chunk.prototype.reference=function(t,e,i,n){return"function"==typeof t&&(t=t.apply(e.current(),[this,e,null,{auto:i,filters:n}]),t instanceof Chunk)?t:dust.isEmpty(t)?this:this.write(dust.filter(t,i,n))},Chunk.prototype.section=function(t,e,i,n){if("function"==typeof t&&!t.__dustBody){try{t=t.apply(e.current(),[this,e,i,n])}catch(o){return dust.log(o,ERROR),this.setError(o)}if(t instanceof Chunk)return t}var r=i.block,s=i["else"];if(n&&(e=e.push(n)),dust.isArray(t)){if(r){var a=t.length,l=this;if(a>0){e.stack.head&&(e.stack.head.$len=a);for(var c=0;a>c;c++)e.stack.head&&(e.stack.head.$idx=c),l=r(l,e.push(t[c],c,a));return e.stack.head&&(e.stack.head.$idx=undefined,e.stack.head.$len=undefined),l}if(s)return s(this,e)}}else if(t===!0){if(r)return r(this,e)}else if(t||0===t){if(r)return r(this,e.push(t))}else if(s)return s(this,e);return dust.log("Not rendering section (#) block in template ["+e.getTemplateName()+"], because above key was not found",DEBUG),this},Chunk.prototype.exists=function(t,e,i){var n=i.block,o=i["else"];if(dust.isEmpty(t)){if(o)return o(this,e)}else if(n)return n(this,e);return dust.log("Not rendering exists (?) block in template ["+e.getTemplateName()+"], because above key was not found",DEBUG),
this},Chunk.prototype.notexists=function(t,e,i){var n=i.block,o=i["else"];if(dust.isEmpty(t)){if(n)return n(this,e)}else if(o)return o(this,e);return dust.log("Not rendering not exists (^) block check in template ["+e.getTemplateName()+"], because above key was found",DEBUG),this},Chunk.prototype.block=function(t,e,i){var n=i.block;return t&&(n=t),n?n(this,e):this},Chunk.prototype.partial=function(t,e,i){var n;n=dust.makeBase(e.global),n.blocks=e.blocks,e.stack&&e.stack.tail&&(n.stack=e.stack.tail),i&&(n=n.push(i)),"string"==typeof t&&(n.templateName=t),n=n.push(e.stack.head);var o;return o="function"==typeof t?this.capture(t,n,function(t,e){n.templateName=n.templateName||t,dust.load(t,e,n).end()}):dust.load(t,this,n)},Chunk.prototype.helper=function(t,e,i,n){var o=this;if(!dust.helpers[t])return dust.log("Invalid helper ["+t+"]",WARN),o;try{return dust.helpers[t](o,e,i,n)}catch(r){return dust.log("Error in "+t+" helper: "+r,ERROR),o.setError(r)}},Chunk.prototype.capture=function(t,e,i){return this.map(function(n){var o=new Stub(function(t,e){t?n.setError(t):i(e,n)});t(o.head,e).end()})},Chunk.prototype.setError=function(t){return this.error=t,this.root.flush(),this};for(var f in Chunk.prototype)dust._aliases[f]&&(Chunk.prototype[dust._aliases[f]]=Chunk.prototype[f]);Tap.prototype.push=function(t){return new Tap(t,this)},Tap.prototype.go=function(t){for(var e=this;e;)t=e.head(t),e=e.tail;return t};var HCHARS=/[&<>"']/,AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=function(t){return"string"==typeof t||t&&"function"==typeof t.toString?("string"!=typeof t&&(t=t.toString()),HCHARS.test(t)?t.replace(AMP,"&amp;").replace(LT,"&lt;").replace(GT,"&gt;").replace(QUOT,"&quot;").replace(SQUOT,"&#39;"):t):t};var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;dust.escapeJs=function(t){return"string"==typeof t?t.replace(BS,"\\\\").replace(FS,"\\/").replace(DQ,'\\"').replace(SQ,"\\'").replace(CR,"\\r").replace(LS,"\\u2028").replace(PS,"\\u2029").replace(NL,"\\n").replace(LF,"\\f").replace(TB,"\\t"):t},dust.escapeJSON=function(t){return JSON?JSON.stringify(t).replace(LS,"\\u2028").replace(PS,"\\u2029").replace(LT,"\\u003c"):(dust.log("JSON is undefined.  JSON stringify has not been used on ["+t+"]",WARN),t)},"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.core",function(){return dust}):"object"==typeof exports?module.exports=dust:root.dust=dust}(function(){return this}()),"function"==typeof define&&define.amd&&define.amd.dust===!0&&define(["require","dust.core"],function(t,e){return e.onLoad=function(e,i){t([e],function(){i()})},e}),function(t,e){"function"==typeof define&&define.amd&&define.amd.dust===!0?define(["dust.core"],e):"object"==typeof exports?module.exports=e(require("dustjs-linkedin")):e(t.dust)}(this,function(t){function e(t){c[t]||(l("Deprecation warning: "+t+" is deprecated and will be removed in a future version of dustjs-helpers","WARN"),l("For help and a deprecation timeline, see https://github.com/linkedin/dustjs-helpers/wiki/Deprecated-Features#"+t.replace(/\W+/g,""),"WARN"),c[t]=!0)}function i(t){return t.stack.tail&&"undefined"!=typeof t.stack.tail.head.__select__}function n(t){return t.get("__select__")}function o(t,e){var i=t.stack.head,n=t.rebase();return t.stack&&t.stack.tail&&(n.stack=t.stack.tail),n.push({__select__:{isResolved:!1,isDefaulted:!1,isDeferredComplete:!1,deferreds:[],key:e}}).push(i,t.stack.index,t.stack.of)}function r(t,e){return"function"==typeof e?e.toString().replace(/(^\s+|\s+$)/gm,"").replace(/\n/gm,"").replace(/,\s*/gm,", ").replace(/\)\{/gm,") {"):e}function s(e,o,r,s,c){s=s||{};var u,h,d,p=r.block,_=s.filterOpType||"";if(s.hasOwnProperty("key"))u=t.helpers.tap(s.key,e,o);else{if(!i(o))return l("No key specified for filter in {@"+_+"}"),e;d=n(o),u=d.key,d.isResolved&&(c=function(){return!1})}return h=t.helpers.tap(s.value,e,o),c(a(h,s.type,o),a(u,s.type,o))?(i(o)&&("default"===_&&(d.isDefaulted=!0),d.isResolved=!0),p?e.render(p,o):e):r["else"]?e.render(r["else"],o):e}function a(t,e,i){if("undefined"!=typeof t)switch(e||typeof t){case"number":return+t;case"string":return String(t);case"boolean":return t="false"===t?!1:t,Boolean(t);case"date":return new Date(t);case"context":return i.get(t)}return t}var l=t.log?function(e,i){i=i||"INFO",t.log(e,i)}:function(){},c={},u={tap:function(t,e,i){if("function"!=typeof t)return t;var n,o="";return n=e.tap(function(t){return o+=t,""}).render(t,i),e.untap(),n.constructor!==e.constructor?n:""===o?!1:o},sep:function(t,e,i){var n=i.block;return e.stack.index===e.stack.of-1?t:n?n(t,e):t},first:function(t,e,i){return 0===e.stack.index?i.block(t,e):t},last:function(t,e,i){return e.stack.index===e.stack.of-1?i.block(t,e):t},contextDump:function(e,i,n,o){var s,a=o||{},c=a.to||"output",u=a.key||"current";return c=t.helpers.tap(c,e,i),u=t.helpers.tap(u,e,i),s="full"===u?JSON.stringify(i.stack,r,2):JSON.stringify(i.stack.head,r,2),"console"===c?(l(s),e):(s=s.replace(/</g,"\\u003c"),e.write(s))},math:function(e,i,n,r){if(r&&"undefined"!=typeof r.key&&r.method){var s=r.key,a=r.method,c=r.operand,u=r.round,h=null;switch(s=parseFloat(t.helpers.tap(s,e,i)),c=parseFloat(t.helpers.tap(c,e,i)),a){case"mod":(0===c||c===-0)&&l("Division by 0 in {@math} helper","WARN"),h=s%c;break;case"add":h=s+c;break;case"subtract":h=s-c;break;case"multiply":h=s*c;break;case"divide":(0===c||c===-0)&&l("Division by 0 in {@math} helper","WARN"),h=s/c;break;case"ceil":h=Math.ceil(s);break;case"floor":h=Math.floor(s);break;case"round":h=Math.round(s);break;case"abs":h=Math.abs(s);break;case"toint":h=parseInt(s,10);break;default:l("{@math}: method "+a+" not supported")}return null!==h?(u&&(h=Math.round(h)),n&&n.block?(i=o(i,h),e.render(n.block,i)):e.write(h)):e}return l("Key is a required parameter for math helper along with method/operand!"),e},select:function(e,i,r,s){var a,c,u,h,d=r.block;if(s.hasOwnProperty("key"))if(c=t.helpers.tap(s.key,e,i),d){if(i=o(i,c),a=n(i),e=e.render(d,i),a.deferreds.length)for(a.isDeferredComplete=!0,h=0,u=a.deferreds.length;u>h;h++)a.deferreds[h]()}else l("Missing body block in {@select}");else l("No key provided for {@select}","WARN");return e},eq:function(t,e,i,n){return n.filterOpType="eq",s(t,e,i,n,function(t,e){return e===t})},ne:function(t,e,i,n){return n.filterOpType="ne",s(t,e,i,n,function(t,e){return e!==t})},lt:function(t,e,i,n){return n.filterOpType="lt",s(t,e,i,n,function(t,e){return t>e})},lte:function(t,e,i,n){return n.filterOpType="lte",s(t,e,i,n,function(t,e){return t>=e})},gt:function(t,e,i,n){return n.filterOpType="gt",s(t,e,i,n,function(t,e){return e>t})},gte:function(t,e,i,n){return n.filterOpType="gte",s(t,e,i,n,function(t,e){return e>=t})},any:function(t,e,o,r){var s;return i(e)?(s=n(e),s.isDeferredComplete?l("{@any} nested inside {@any} or {@none} block. It needs its own {@select} block","WARN"):t=t.map(function(t){s.deferreds.push(function(){s.isResolved&&!s.isDefaulted&&(t=t.render(o.block,e)),t.end()})})):l("{@any} used outside of a {@select} block","WARN"),t},none:function(t,e,o,r){var s;return i(e)?(s=n(e),s.isDeferredComplete?l("{@none} nested inside {@any} or {@none} block. It needs its own {@select} block","WARN"):t=t.map(function(t){s.deferreds.push(function(){s.isResolved||(t=t.render(o.block,e)),t.end()})})):l("{@none} used outside of a {@select} block","WARN"),t},"default":function(t,n,o,r){return r.filterOpType="default",e("{@default}"),i(n)?s(t,n,o,r,function(){return!0}):(l("{@default} used outside of a {@select} block","WARN"),t)},size:function(e,i,n,o){var r,s,a,l=0;if(o=o||{},r=o.key,r&&r!==!0)if(t.isArray(r))l=r.length;else if(!isNaN(parseFloat(r))&&isFinite(r))l=r;else if("object"==typeof r){s=0;for(a in r)Object.hasOwnProperty.call(r,a)&&s++;l=s}else l=(r+"").length;else l=0;return e.write(l)}};for(var h in u)t.helpers[h]=u[h];return t}),DG.dust=function(t){return function(e,i){dust.cache[e]||dust.loadSource(t[e]);var n;return dust.render(e,i,function(t,e){n=e}),n}},DG.debug&&(dust.debugLevel="ERROR"),DG.Control.Attribution.include(DG.Locale),DG.Control.Attribution.Dictionary={},DG.Control.Attribution.include({options:{position:"bottomright"},_getLink:function(t){var e={ru:{copyright_logo:"http://info.2gis.ru/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://api.2gis.ru/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://help.2gis.ru/licensing-agreement/"},it:{copyright_logo:"http://2gis.it/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://2gis.it/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://2gis.it/"},cz:{copyright_logo:"http://praha.2gis.cz/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://praha.2gis.cz/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.cz/licensing-agreement/"},cl:{copyright_logo:"http://santiago.2gis.cl/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://santiago.2gis.cl/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.cl/licensing-agreement/"},cy:{copyright_logo:"http://info.2gis.com.cy/lemesos?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://info.2gis.com.cy/lemesos?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.com.cy/licensing-agreement/"},ae:{copyright_logo:"http://info.2gis.ae/dubai?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://info.2gis.ae/dubai?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.ae/licensing-agreement/"}},i=this._countryCode in e?this._countryCode:"ru";return e[i][t]},onAdd:function(t){t._copyright||(t._copyright=!0,this._first=!0),this._container=DG.DomUtil.create("div","dg-attribution"),DG.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},_update:function(t,e,i){if(this._map){"undefined"!=typeof e&&(this._osm=e),"undefined"!=typeof i&&(this._countryCode=i);var n=[];for(var o in this._attributions)this._attributions[o]&&n.push(o);var r=[],s="";this._first&&(s=this._getAttributionHTML(t)),this.options.prefix&&r.push(this.options.prefix),n.length&&r.push(n.join(", ")),this._container.innerHTML=s+r.join(" | ")}},_tmpl:DG.dust({copyright:'(function(){dust.register("copyright",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-attribution__copyright\\"><ul class=\\"dg-attribution__links\\"><li class=\\"dg-attribution__link-item\\">").exists(ctx.get(["osm"], false),ctx,{"block":body_1},null).write("<a href=\\"").reference(ctx.get(["copyright_apilink"], false),ctx,"h").write("\\" target=\\"_blank\\" class=\\"dg-attribution__link\\">").notexists(ctx.get(["osm"], false),ctx,{"block":body_2},null).reference(ctx.get(["API_2GIS"], false),ctx,"h").write("</a></li><li class=\\"dg-attribution__link-item\\"><a href=\\"").reference(ctx.get(["copyright_license"], false),ctx,"h").write("\\" target=\\"_blank\\" class=\\"dg-attribution__link\\">").reference(ctx.get(["license_agreement"], false),ctx,"h").write("</a></li></ul><a href=\\"").reference(ctx.get(["copyright_logo"], false),ctx,"h").write("\\" target=\\"_blank\\" class=\\"dg-attribution__logo-url\\"></a></div>");}function body_1(chk,ctx){return chk.write(" <a href=\\"http://www.openstreetmap.org/copyright\\" target=\\"_blank\\" class=\\"dg-attribution__link\\">OpenStreetMap contributors</a>, ");}function body_2(chk,ctx){return chk.reference(ctx.get(["work_on"], false),ctx,"h").write(" ");}return body_0;})();'}),_getData:function(t){return{osm:this._osm,work_on:this.t("work_on"),lang:t||this._map.getLang(),copyright_apilink:this._getLink("copyright_apilink"),copyright_license:this._getLink("copyright_license"),copyright_logo:this._getLink("copyright_logo"),license_agreement:this.t("license_agreement"),API_2GIS:this.t("API_2GIS")}},_getAttributionHTML:function(t){return this._tmpl("copyright",this._getData(t))},_renderTranslation:function(t){this._update(t.lang)}}),DG.Map.addInitHook(function(){this._copyright||DG.control.attribution().addTo(this)}),DG.Control.Attribution.Dictionary.ru={license_agreement:" ",work_on:" ",API_2GIS:"API 2"},DG.Control.Attribution.Dictionary.it={license_agreement:"Accordo di licenza",work_on:" ",API_2GIS:"2GIS API"},DG.Control.Attribution.Dictionary.cs={license_agreement:"Licenn smlouva",work_on:"Pracuje na",API_2GIS:"API 2GIS"},DG.Control.Attribution.Dictionary.en={license_agreement:"License agreement",work_on:"Uses",API_2GIS:"2GIS API"},DG.Control.Attribution.Dictionary.es={license_agreement:"Acuerdo de licencia",work_on:" ",API_2GIS:"2GIS API"},DG.Control.Location=DG.RoundControl.extend({statics:{Dictionary:{}},options:{iconClass:"locate",position:DG.Browser.touch?"bottomright":"topleft",drawCircle:!0,follow:!0,stopFollowingOnDrag:!1,metric:!0,onLocationError:function(){},onLocationOutsideMapBounds:function(){},locateOptions:{}},initialize:function(t){return DG.Util.setOptions(this,t),navigator.geolocation?(this._event=undefined,this._locateOptions={watch:!0,setView:!1,maximumAge:1/0},DG.extend(this._locateOptions,this.options.locateOptions),this._resetVariables(),void this.on({click:this._handleLocate,add:this._initLocate})):void(this._disable=!0)},_initLocate:function(){this._layer=new DG.LayerGroup,this._layer.addTo(this._map),this._map.on({locationfound:this._onLocationFound,locationerror:this._onLocationError},this)},_handleLocate:function(){this._active&&(!this._event||this._map.getBounds().contains(this._event.latlng)||this._isOutsideMapBounds())?this._stopLocate():(this._locateOnNextLocationFound=!0,this._active||this._map.locate(this._locateOptions),this._active=!0,this.options.follow&&this._startFollowing(),this._clearError(),this._event?this._visualizeLocation():this.setState("requesting"))},_onLocationFound:function(t){this._event&&this._event.latlng.lat===t.latlng.lat&&this._event.latlng.lng===t.latlng.lng&&this._event.accuracy===t.accuracy||this._active&&(this._event=t,this.options.follow&&this._following&&(this._locateOnNextLocationFound=!0),this._visualizeLocation())},_startFollowing:function(){this._following=!0,this.options.stopFollowingOnDrag&&this._map.on("dragstart",this._stopFollowing)},_stopFollowing:function(){this._following=!1,this.options.stopFollowingOnDrag&&this._map.off("dragstart",this._stopFollowing),this._visualizeLocation()},_isOutsideMapBounds:function(){return this._event===undefined?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_visualizeLocation:function(){this._event.accuracy===undefined&&(this._event.accuracy=0);var t=this._event.accuracy;if(this._locateOnNextLocationFound){if(this._isOutsideMapBounds())this.options.onLocationOutsideMapBounds(this);else{var e=this._map.projectDetector.getProject().maxZoom||13;this._map.setView(this._event.latlng,e)}this._locateOnNextLocationFound=!1}var i={clickable:!1,color:"#FFF",fillColor:"#FFF",fillOpacity:.4,weight:0,opacity:.3};this.options.drawCircle&&(this._circle?this._circle.setLatLng(this._event.latlng).setRadius(t):this._circle=DG.circle(this._event.latlng,t,i).addTo(this._layer));var n="dg-location__pin";n+=this._following?" "+n+"state_following":"";var o={icon:DG.divIcon({className:n,iconSize:[20,20]})};this._marker?this._marker.setLatLng(this._event.latlng):this._marker=DG.marker(this._event.latlng,o).bindLabel(this.t("you_are_here")).addTo(this._layer),DG.DomEvent.on(this._marker,"click",function(){this._map.fireEvent("dgLocateClick")},this),this._container&&this.setState("active")},_resetVariables:function(){this._active=!1,this._following=!1},_stopLocate:function(){this._map.stopLocate(),this._map.off("dragstart",this._stopFollowing),this.setState(),this._resetVariables(),this._layer.clearLayers(),this._marker=undefined,this._circle=undefined,this._event=undefined},_onLocationError:function(t){if(3!==t.code||!this._locateOptions.watch){this._stopLocate(),this._error=DG.DomUtil.create("div","dg-label dg-label_name_location-error",this._container),this._errorText=DG.DomUtil.create("div","dg-label__content",this._error),this._errorText.innerHTML=this.t("cant_find");var e=this;setTimeout(function(){e._clearError()},3e3),this.options.onLocationError(t)}},_clearError:function(){this._error&&(this._container.removeChild(this._error),this._error=undefined,this._errorText=undefined)},_renderTranslation:function(){this._link&&(this._link.title=this.t("button_title")),this._marker&&this._marker.bindLabel(this.t("you_are_here"))}}),DG.control.location=function(t){return new DG.Control.Location(t)},DG.Map.addInitHook(function(){this.options.locationControl&&(this.locationControl=DG.control.location(this.options.locationControl),this.addControl(this.locationControl))}),DG.Control.Location.Dictionary.ru={cant_find:"    ",you_are_here:" ",button_title:"   "},DG.Control.Location.Dictionary.it={cant_find:"Non siamo riusciti a localizzarti",you_are_here:"Voi siete qui",button_title:"Trova la tua posizione sulla mappa"},DG.Control.Location.Dictionary.cs={cant_find:"Nepodailo se nm urit Vai polohu",you_are_here:"Jste tady",button_title:"Urit Vai polohu na map"},DG.Control.Location.Dictionary.en={cant_find:"We can't find you",you_are_here:"You are here",button_title:"Show your location"},DG.Control.Location.Dictionary.es={cant_find:"No pudimos encontrarte",you_are_here:"T ests aqu",button_title:"Encontrarte en el mapa"},DG.Screenfull=DG.Class.extend({_apiMap:[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],initialize:function(){this.api=this._api()},request:function(t){var e=this.api.requestFullscreen;t=t||document.documentElement,t[e](Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[this.api.exitFullscreen]()},isFullscreen:function(){return!!document[this.api.fullscreenElement]},isAvailable:function(){return Boolean(this.api)},_api:function(){var t={},e=this._apiMap;return e.forEach(function(i){i&&i[1]in document&&i.forEach(function(i,n){t[e[0][n]]=i})}),t.requestFullscreen?t:!1}}),DG.screenfull=new DG.Screenfull,DG.Control.Fullscreen=DG.RoundControl.extend({statics:{Dictionary:{}},options:{position:"topright",iconClass:"fullscreen"},initialize:function(t){DG.Util.setOptions(this,t),this._isFullscreen=!1,this.on("click",this._toggleFullscreen)},_toggleFullscreen:function(){this._isFullscreen?this._toggle(!1,"exit","on","cancelfullscreen"):this._toggle(!0,"request","on","requestfullscreen"),this._renderTranslation(),this._map.invalidateSize()},_renderTranslation:function(){this._link.title=this.t(this._isFullscreen?"title_min":"title_max")},_toggle:function(t,e,i,n){var o=this._map._container;this._isFullscreen=t,this.setState(t?"active":""),DG.screenfull[e](o),DG.DomEvent[i](document,DG.screenfull.api.fullscreenchange,this._onFullScreenStateChange,this),this._map.fire(n)},_onFullScreenStateChange:function(){DG.screenfull.isFullscreen()||this._toggle(!1,"exit","on","cancelfullscreen")}}),DG.control.fullscreen=function(t){return new DG.Control.Fullscreen(t)},DG.Map.mergeOptions({fullscreenControl:!0}),DG.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=DG.control.fullscreen(this.options.fullscreenControl),DG.screenfull.isAvailable()&&this.addControl(this.fullscreenControl))}),DG.Control.Fullscreen.Dictionary.ru={title_max:"",title_min:""},DG.Control.Fullscreen.Dictionary.it={title_max:"Espandi",title_min:"Ripristina"},DG.Control.Fullscreen.Dictionary.cs={title_max:"Rozbalit",title_min:"Obnovit"},DG.Control.Fullscreen.Dictionary.en={title_max:"Expand",title_min:"Restore"},DG.Control.Fullscreen.Dictionary.es={title_max:"Maximizar",title_min:"Restaurar"},DG.Meta={},DG.Meta.Layer=DG.Layer.extend({options:{tileSize:256,minZoom:0,maxZoom:19,zoomOffset:0,eventBubbling:"transparent"},initialize:function(t,e){DG.TileLayer.prototype.initialize.call(this,null,e),delete this._url,this._currentTile=!1,this._currentTileData=!1,this._hoveredObject=null,this._origin=DG.Meta.origin(t,{dataFilter:this.options.dataFilter})},getOrigin:function(){return this._origin},onAdd:function(t){this._reset(),this._addDomEvents(),t.on("rulerstart",this._removeDomEvents,this),t.on("rulerend",this._addDomEvents,this)},onRemove:function(t){this._removeDomEvents(),t.off("rulerstart",this._removeDomEvents,this),t.off("rulerend",this._addDomEvents,this)},getEvents:function(){var t={viewreset:this._reset};return t},_addDomEvents:function(){DG.DomEvent.on(this._map.getPane("tilePane"),this._domEvents,this)},_removeDomEvents:function(){DG.DomEvent.off(this._map.getPane("tilePane"),this._domEvents,this)},_getZoomForUrl:DG.TileLayer.prototype._getZoomForUrl,_getTileSize:DG.TileLayer.prototype._getTileSize,_getTileNumBounds:DG.GridLayer.prototype._getTileNumBounds,_isValidTile:DG.GridLayer.prototype._isValidTile,_wrapCoords:DG.GridLayer.prototype._wrapCoords,_resetWrap:DG.GridLayer.prototype._resetWrap,_domEvents:{mousemove:function(t){var e,i,n,o=this._getTileSize(),r=this._map.mouseEventToLayerPoint(t),s=this._map.getPixelOrigin().add(r),a=s.divideBy(o).floor(),l=this._map.getZoom();l>this.options.maxZoom+this.options.zoomOffset||l<this.options.minZoom-this.options.zoomOffset||!this._isValidTile(a)||(this._wrapCoords(a),a.z=this._getZoomForUrl(),a.key=o,i=this._origin.getTileKey(a),i!==this._currentTile&&(this._currentTile=i,this._currentTileData=!1),this._currentTileData===!1?this._currentTileData=this._origin.getTileData(a):(e=DG.point(s.x%o,s.y%o),n=this._getHoveredObject(a,e),this._hoveredEntity!==n&&(this._fireMouseEvent("mouseout",t),this._hoveredEntity=n,this._fireMouseEvent("mouseover",t)),this._fireMouseEvent("mousemove",t)))},mouseout:function(t){this._fireMouseEvent("mouseout",t),this._hoveredEntity=null,this._currentTile=!1},click:function(t){this._fireMouseEvent("click",t)},dblclick:function(t){this._fireMouseEvent("dblclick",t)},mousedown:function(t){this._fireMouseEvent("mousedown",t)},contextmenu:function(t){this._fireMouseEvent("contextmenu",t)}},_fireMouseEvent:function(t,e){this._hoveredEntity&&(this.fire(t,{meta:this._hoveredEntity,latlng:this._map.mouseEventToLatLng(e)}),"layer"===this.options.eventBubbling&&DG.DomEvent.stop(e))},_getHoveredObject:function(t,e){for(var i=this._currentTileData.length-1;i>=0;i--)if(DG.PolyUtil.contains(e,this._currentTileData[i].geometry.coordinates[0]))return this._currentTileData[i];return null},_reset:function(){this._tileNumBounds=this._getTileNumBounds(),this._resetWrap(this._tileNumBounds)}}),DG.Meta.layer=function(t,e){return new DG.Meta.Layer(t,e)},DG.Meta.Origin=DG.Class.extend({options:{subdomains:"0123",dataFilter:null},_url:!1,initialize:function(t,e){this._url=t,this._requests={},this._tileStorage={},this._dataStorage={},e=DG.setOptions(this,e),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split(""))},getTileData:function(t){var e=this.getTileKey(t),i=this;return"undefined"==typeof this._tileStorage[e]&&"undefined"==typeof this._requests[e]&&(this._tileStorage[e]=!1,this._requests[e]=this._requestData(t).then(function(n){i.setTileData(e,i.options.dataFilter?i.options.dataFilter(n,t):n),delete i._requests[e]})),this._tileStorage[e].constructor===Object?Object.keys(this._tileStorage[e]).map(function(t){return DG.extend({geometry:this._tileStorage[e][t]},this._dataStorage[t])},this):this._tileStorage[e]},setTileData:function(t,e){return"string"!=typeof t&&(t=this.getTileKey(t)),e.forEach(function(e){e.geometry.constructor!==Object&&(e.geometry=DG.Wkt.toGeoJSON(e.geometry)),this._tileStorage[t]||(this._tileStorage[t]={}),this._tileStorage[t][e.id]=e.geometry,delete e.geometry,this._dataStorage[e.id]=e},this),this},flush:function(){return this._tileStorage={},this._dataStorage={},Object.keys(this._requests).forEach(function(t){this[t].abort&&this[t].abort()},this._requests),this},setURL:function(t,e){return this._url=t,e&&this.flush(),this},getTileKey:function(t){return[t.x,t.y,t.z,t.key].join(":")},_requestData:function(t){return this._url?this._performRequest(t):Promise.resolve([])},_performRequest:function(t){return DG.ajax(this._prepareURL(t),{type:"get",dataType:"json"})},_prepareURL:function(t){return DG.Util.template(this._url,{x:t.x,y:t.y,z:t.z,s:this._getSubdomain(t)})},_getSubdomain:DG.TileLayer.prototype._getSubdomain}),DG.Meta.origin=function(t,e){return new DG.Meta.Origin(t,e)},DG.PolyUtil.contains=function(t,e){var i,n,o,r=0,s=[];for(n=0,o=e.length;o>n;n++)s.push(DG.point(e[n]));for(i=this._getEdges(s),n=0,o=i.length;o>n;n++)switch(this._getEdgeType(i[n],t)){case"TOUCHING":return!0;case"CROSSING":r=1-r}return r?!0:!1},DG.PolyUtil._getEdges=function(t){for(var e,i,n,o=[],r=0,s=t.length;s>r;r++)i=t[r],n=r!==s-1?t[r+1]:t[0],e={startPoint:i,endPoint:n},o.push(e);return o},DG.PolyUtil._getEdgeType=function(t,e){var i=this._classify(t,e);switch(i){case"LEFT":return t.startPoint.y<e.y&&e.y<=t.endPoint.y?"CROSSING":"INESSENTIAL";case"RIGHT":return t.endPoint.y<e.y&&e.y<=t.startPoint.y?"CROSSING":"INESSENTIAL";case"BETWEEN":case"ORIGIN":case"DESTINATION":return"TOUCHING";default:return"INESSENTIAL"}},DG.PolyUtil._classify=function(t,e){var i,n,o;return i={x:t.endPoint.x-t.startPoint.x,y:t.endPoint.y-t.startPoint.y},n={x:e.x-t.startPoint.x,y:e.y-t.startPoint.y},o=i.x*n.y-n.x*i.y,o>0?"LEFT":0>o?"RIGHT":i.x*n.x<0||i.y*n.y<0?"BEHIND":this._getLengthSquared(i)<this._getLengthSquared(n)?"BEYOND":DG.PolyUtil._areEquals(t.startPoint,e)?"ORIGIN":DG.PolyUtil._areEquals(t.endPoint,e)?"DESTINATION":"BETWEEN"},DG.PolyUtil._getLengthSquared=function(t){return Math.pow(t.x,2)+Math.pow(t.y,2)},DG.PolyUtil._areEquals=function(t,e){return t.x===e.x&&t.y===e.y},DG.Map.mergeOptions({poi:!DG.Browser.touch}),DG.Poi=DG.Handler.extend({options:{disableLabel:!1},statics:{metaURL:"http://tile{s}.maps.2gis.com/?x={x}&y={y}&z={z}&v=1&type=poi"},initialize:function(t,e){this._map=t,DG.Util.setOptions(this,e),this._metaLayer=DG.Meta.layer(DG.Poi.metaURL,{minZoom:15,maxNativeZoom:19,detectRetina:!0,eventBubbling:"layer",dataFilter:DG.bind(this._processData,this)})},addHooks:function(){this._map.addLayer(this._metaLayer),this.options.disableLabel||(this._labelHelper=DG.label(),this._metaLayer.on(this._layerEventsListeners,this))},removeHooks:function(){this._map.removeLayer(this._metaLayer),this.options.disableLabel||(this._metaLayer.off(this._layerEventsListeners,this),this._map.removeLayer(this._labelHelper),this._labelHelper=null)},getMetaLayer:function(){return this._metaLayer},_processData:function(t,e){var i=this._map,n=e.multiplyBy(this._metaLayer._getTileSize());return""===t.responseText?[]:t.result.poi.map(function(t){var e=DG.Wkt.toGeoJSON(t.hover);return e.coordinates[0]=e.coordinates[0].map(function(t){return i.project([t[1],t[0]]).round().subtract(n)}),{id:t.id,hint:t.links[0].name,linked:t.links[0],geometry:e}})},_layerEventsListeners:{mouseover:function(t){this._setCursor("pointer"),this._labelHelper.setPosition(t.latlng).setContent(t.meta.hint),this._map.addLayer(this._labelHelper)},mouseout:function(){this._setCursor(""),this._map.removeLayer(this._labelHelper)},mousemove:function(t){this._labelHelper.setPosition(t.latlng)}},_setCursor:function(t){this._map.getContainer().style.cursor=t}}),DG.Map.addInitHook("addHandler","poi",DG.Poi),DG.Entrance=DG.Layer.extend({options:{vectors:[]},statics:{SHOW_FROM_ZOOM:DG.Browser.svg?16:17},initialize:function(t){DG.setOptions(this,t)},onAdd:function(t){this._map=t,this._initArrows().addTo(t),this._eventHandler=new DG.Entrance.EventHandler(t,this),this._eventHandler.enable(),this._arrows.eachLayer(function(t){t.setStyle({visibility:"hidden"})}),this._isShown=!1},addTo:function(t){return t.addLayer(this),this},onRemove:function(){this._isShown=!1,this._removeArrows(),this._map=null,this._eventHandler.disable(),this._eventHandler=null,this._arrows=null},removeFrom:function(t){return t.removeLayer(this),this},show:function(t){return this._arrows?(t!==!1&&this._fitBounds(),this._isAllowedZoom()&&(this._arrows.eachLayer(function(t){t.setStyle({visibility:"visible"}),DG.Path.ANIMATION_AVAILABLE&&t.runAnimation("animateArrowPathGeom")}),this._isShown||(this._map.fire("entranceshow"),this._isShown=!0)),this):this},hide:function(){return this.isShown()&&this._arrows&&(this._arrows.eachLayer(function(t){t.setStyle({visibility:"hidden"})}),this._isShown=!1,this._map.fire("entrancehide")),this},isShown:function(){return this._isShown},getBounds:function(){return this._arrows.getBounds()},_initArrows:function(){return this._arrows=DG.featureGroup(),this.options.vectors.map(function(t){return DG.Wkt.toLatLngs(t)}).forEach(function(t){this._arrows.addLayer(DG.Entrance.arrow(t,this._getArrowStrokeOptions())),this._arrows.addLayer(DG.Entrance.arrow(t,this._getArrowOptions()))},this),this._arrows},_removeArrows:function(){this._map.removeLayer(this._arrows.clearLayers())},_getFitZoom:function(){return this._map.projectDetector.getProject().maxZoom||DG.Entrance.SHOW_FROM_ZOOM},_fitBounds:function(){var t,e=this._map,i=this.getBounds();e.getBounds().contains(i)&&this._isAllowedZoom()||(t=this._getFitZoom(),e.projectDetector.getProject()||e.once("moveend",function(){e.setZoom(this._getFitZoom())},this),e.setView(i.getCenter(),t,{animate:!0}))},_isAllowedZoom:function(){return this._map.getZoom()>=DG.Entrance.SHOW_FROM_ZOOM},_getArrowStrokeOptions:function(){return{clickable:!1,color:"#fff",weight:6,byZoom:{16:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M9.313,18.984c2.246-1.468,7.101-5.562,7.101-5.562c0.781-0.781,0.781-2.047,0-2.828c0,0-5.242-4.023-7.101-5.102C9.74,5.354,8.583,5.93,8.125,6.5C7.902,6.777,9,11.614,9,11.614v0.789c0,0-0.879,4.237-0.905,5.285C8.09,17.891,9.108,19.118,9.313,18.984z"}},lastPointOffset:2,vmlEndArrow:"none",weight:6,iconWidth:4},17:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M7.912,21.498c3.106-2.029,9.859-7.873,9.859-7.873c2.059-1.807,2.142-1.542,0.146-3.208c0,0-7.434-6.084-10.005-7.576C7.583,2.649,6.903,3.446,6.271,4.233c-0.308,0.384,2.209,6.051,2.209,6.051v3.388c0,0-2.215,4.583-2.25,6.03C6.222,19.986,7.629,21.684,7.912,21.498z"}},lastPointOffset:0,vmlEndArrow:"none",weight:7,iconWidth:6},18:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M7.61,22.688c4.045-2.642,11.312-8.906,11.312-8.906c1.92-1.781,1.938-2-0.124-3.781c0,0-8.151-6.334-11.5-8.276C6.87,1.475,5.516,2.62,5.732,3.093c2.146,4.694,2.063,4.741,2.612,7.469l0.016,2.75c0,0-1.573,5.458-2.619,7.958C5.599,21.611,7.241,22.93,7.61,22.688z"}},lastPointOffset:DG.Browser.vml?-2:-5,vmlEndArrow:"none",weight:8,iconWidth:8},19:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:27,markerWidth:27,path:{d:"M6.254472,23.8475c4.560355,-2.972281 12.747538,-10.032785 12.747538,-10.032785c2.167521,-2.006556 2.178242,-2.253353 -0.13949,-4.25991c0,0 -9.185101,-7.13562 -12.962148,-9.324594c-0.482861,-0.278985 -2.006558,1.008645 -1.759761,1.534428c2.414306,5.290015 2.414306,5.290015 3.272724,8.294486l0,3.433681c0,0 -2.081665,5.933829 -3.261997,8.755889c-0.160951,0.386288 1.684652,1.867062 2.103134,1.598804z"}},lastPointOffset:DG.Browser.vml?-2:-5,vmlEndArrow:"none",weight:10,iconWidth:12}}}},_getArrowOptions:function(){
return{clickable:!1,color:"#0085a0",weight:3,byZoom:{16:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M11.068,13.011L9.5,17.285l6.379-5.169L9.313,7.19l1.717,3.824"}},lastPointOffset:2,weight:2,iconWidth:4},17:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M10.354,13.969l-2.184,5.18L16.993,12L7.912,5.188l2.38,4.781"}},lastPointOffset:0,weight:3,iconWidth:6},18:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M10.281,13.781L7.42,21.271l11.488-9.308L7.083,3.093L10.219,10"}},lastPointOffset:DG.Browser.vml?0:-5,weight:4,iconWidth:8},19:{marker:{refX:12,refY:12,markerHeight:27,markerWidth:27,path:{d:"M9.344783,13.814714l-3.326375,8.476902l12.983603,-10.51565l-13.305513,-9.979137l3.648286,7.940389"}},lastPointOffset:DG.Browser.vml?0:-5,weight:5,iconWidth:12}}}}}),DG.Path.ANIMATION_AVAILABLE=DG.Browser.svg&&!DG.Browser.mobileWebkit&&-1===navigator.userAgent.toLowerCase().indexOf("presto")&&"[object Function]"===Object.prototype.toString.call(DG.SVG.create("animate").beginElement),DG.Path.include(DG.Path.ANIMATION_AVAILABLE?{runAnimation:function(){var t=this._animationEl=this._addAnimation();return t&&(t.beginElement(),this._removeAnimation(t)),this},stopAnimation:function(t){return this.animations[t]&&this.animations[t].endElement(),this},_addAnimation:function(){var t=this.options.animation,e=this._rings[0],i=null;return t&&e.length>0&&(i=DG.SVG.create("animate"),t.getValues&&(t.values=t.getValues(e)),Object.keys(t).filter(function(e){return"[object Function]"!=={}.toString.call(t[e])}).forEach(function(e){i.setAttribute(e,t[e])}),this._path.appendChild(i)),i},_removeAnimation:function(t){this._map.once("zoomstart",function(){t&&this._path.removeChild(t),this._animationEl=null},this)}}:{}),DG.Entrance.Arrow=DG.Polyline.extend({initialize:function(t,e){e=e||{},this._setLatLngs(t),DG.Path.ANIMATION_AVAILABLE&&(e.animation=this.getArrowAnimation(this._convertLatLngs(t))),this._markers=[],L.setOptions(this,e)},onAdd:function(t){var e=this._renderer=t.getArrowRenderer();e._initPath(this),this._project(),this._update(),this._updateStyleByZoom(),e._addPath(this),e._initMarkers(this)},onRemove:function(t){DG.Polyline.prototype.onRemove.call(this,t),this._renderer._removeMarkers(this)},getEvents:function(){return{viewreset:this._project,move:this._update,zoomend:this._updateStyleByZoom}},_projectLatlngs:function(t,e){DG.Polyline.prototype._projectLatlngs.call(this,t,e),this._offsetLastPathPoint()},_update:function(){DG.Polyline.prototype._update.call(this),this._renderer._updateMarker(this)},_updateStyleByZoom:function(){var t=this.options.byZoom,e=this._map.getZoom();this.setStyle(t[e])},_offsetLastPathPoint:function(){var t,e,i,n=this._rings[0],o=this.options.byZoom[this._map.getZoom()],r=n.length,s=n[r-1].distanceTo(n[r-2]);o&&(e={x:n[r-1].x-n[r-2].x,y:n[r-1].y-n[r-2].y},s>o.iconWidth?(t=Math.abs(o.lastPointOffset/s),i={x:e.x*t,y:e.y*t},o.lastPointOffset>0?(n[r-1].x+=i.x,n[r-1].y+=i.y):(n[r-1].x-=i.x,n[r-1].y-=i.y)):(t=s/o.iconWidth,0!==e.x&&(n[r-1].x=n[r-2].x+e.x/t),0!==e.y&&(n[r-1].y=n[r-2].y+e.y/t)))}}),DG.Entrance.arrow=function(t,e){return new DG.Entrance.Arrow(t,e)},DG.Entrance.Arrow.SVG=DG.SVG.extend({getEvents:function(){var t={move:this._update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),DG.Browser.ie&&(t.moveend=t.mousemove=t.zoomend=this._refresh),t},_initMarkers:function(t){var e,i,n=t.options.byZoom,o=t._markerId="arrow-marker-"+DG.Util.stamp(t);Object.keys(n).map(function(r){e=DG.SVG.create("marker"),i=n[r].marker,Object.keys(i).filter(function(t){return"polygon"!==t&&"path"!==t}).forEach(function(t){e.setAttribute(t,i[t])}),e.id=o+"-"+r,e.setAttribute("orient","auto"),e.setAttribute("markerUnits","userSpaceOnUse"),e.setAttribute("stroke-width","0"),i.path&&e.appendChild(this._getMarkerChild("path",i.path,t)),i.polygon&&e.appendChild(this._getMarkerChild("polygon",i.polygon,t)),t._markers.push(e),this._getDefs().appendChild(e)},this),this._updateMarker(t)},_getMarkerChild:function(t,e,i){var n=DG.SVG.create("path"),o="path"===t?"d":"points";return n.setAttribute(o,e[o]),n.setAttribute("fill",e.color?e.color:i.options.color),n},_getDefs:function(){return this._defs=this._defs||DG.SVG.create("defs"),this._defs.parentNode||this._container.appendChild(this._defs),this._defs},_updateMarker:function(t){var e=t._map.getZoom(),i=t._map.getBounds(),n=t._latlngs[t._latlngs.length-1],o=e>=DG.Entrance.SHOW_FROM_ZOOM&&i.contains(n)?t._markerId+"-"+e:"";t._path.setAttribute("marker-end","url(#"+o+")")},_removeMarkers:function(t){var e=this._getDefs(),i=t._markers;(e||i)&&(i.forEach(function(t){e.removeChild(t)}),i.length=0)},_refresh:function(){this._container.parentNode.insertBefore(this._container,this._container)},_updateStyle:function(t){var e=t._path,i=t.options;DG.SVG.prototype._updateStyle.call(this,t),e.setAttribute("visibility",i.visibility),t._markers.forEach(function(t){t.setAttribute("fill-opacity",i.opacity)}),this._updateMarker(t)}}),L.Map.include({getArrowRenderer:function(){var t=this._arrowRenderer;return t||(t=this._arrowRenderer=new DG.Entrance.Arrow.SVG),this.hasLayer(t)||this.addLayer(t),t}}),DG.Entrance.Arrow.SVG.include(L.Browser.vml?{_initMarkers:function(t){t._markers=L.SVG.create("stroke"),this._updateMarker(t),t._container.appendChild(t._markers)},_updateMarker:function(t){var e=t.options.byZoom[t._map.getZoom()];t._markers.endarrow=e&&e.vmlEndArrow?e.vmlEndArrow:"classic"},_removeMarkers:function(t){t._container.removeChild(t._markers)},_updateStyle:function(t){var e=t.options,i=t._container;DG.SVG.prototype._updateStyle.call(this,t),e.visibility&&(i.style.visibility=e.visibility)}}:{}),DG.Browser.svg&&DG.Entrance.Arrow.include({getArrowAnimation:function(t){var e={id:"animateArrowPathGeom",attributeName:"d",fill:"freeze",begin:"indefinite"};return e.getValues=this._getAnimationValues(t.length),e.keyTimes=this._getAnimateTiming(t),e.dur=this._getAnimationTime(t.length),e},_getAnimationValues:function(t){return 2===t?this._getShakeAnimationValues:this._getSlideAnimationValues},_getSlideAnimationValues:function(t){var e="",i="",n="",o="M "+t[0].x+" "+t[0].y,r="l -1 0";e=o+" "+r+"; ";for(var s=1;s<t.length;s++){if(n+=t[s].x-t[s-1].x+" "+(t[s].y-t[s-1].y),s===t.length-1){n=t[s].x-t[s-1].x+" "+(t[s].y-t[s-1].y),e+=o+" l "+i+n+";";break}e+=o+" l "+n+"; ",e+=o+" l "+n+" "+r+"; ",n+=" l ",i+=t[s].x-t[s-1].x+" "+(t[s].y-t[s-1].y)+" l "}return e},_getShakeAnimationValues:function(t){var e,i,n=[1,.4,1,.84,1,.94,1],o=t[1].x-t[0].x,r=t[1].y-t[0].y,s=" l "+o+" "+r;return e=t[0].x-o,i=t[0].y-r,n.reduce(function(t,n){return t+" M "+(e+o*n)+" "+(i+r*n)+s+";"},"M "+e+" "+i+s+"; ")},_getPolylineLength:function(t){for(var e=0,i=1;i<t.length;i++)e+=t[i-1].distanceTo(t[i]);return e},_getAnimateTiming:function(t){var e,i,n,o=[0],r=this._getPolylineLength(t);if(2===t.length)e="0; 0.33; 0.495; 0.66; 0.77; 0.88; 0.935; 1";else if(3===t.length)e="0; 0.33; 0.34; 1";else if(4===t.length)e="0; 0.25; 0.26; 0.5; 0.51; 1";else{for(var s=1;s<t.length;s++)n=t[s-1].distanceTo(t[s]),i=n/r,o.push(o[o.length-1]+i),s<t.length-1?o.push(o[o.length-1]):o[o.length-1]=1;e=o.join("; ")}return e},_getAnimationTime:function(t){return 2===t?"0.7s":3===t||4===t?"0.5s":"0.7s"}}),DG.Entrance.EventHandler=DG.Handler.extend({initialize:function(t,e){this._map=t,this._entrance=e},addHooks:function(){this._map.on(this._events(),this)},removeHooks:function(){this._map.off(this._events(),this)},_events:function(){return{layeradd:this._removeEntrance,zoomend:this._showOrHideEntrance,projectleave:this._showOrHideEntrance}},_showOrHideEntrance:function(){this._map.getZoom()>=DG.Entrance.SHOW_FROM_ZOOM?this._entrance.show(!1):this._entrance.hide()},_removeEntrance:function(t){(t.layer instanceof DG.Popup||t.layer instanceof DG.Entrance&&t.layer!==this._entrance)&&this._entrance.removeFrom(this._map)}}),DG.Map.mergeOptions({geoclicker:!1}),DG.Geoclicker=DG.Handler.extend({clickCount:0,pendingClick:0,timeout:250,initialize:function(t,e){this._map=t,this._controller=new DG.Geoclicker.Controller(t,e)},addHooks:function(){this._toggleEvents(!0),this._map.on("rulerstart",this._pause,this).on("rulerend",this._unpause,this)},removeHooks:function(){this._toggleEvents(),this._map.off("rulerstart",this._pause,this).off("rulerend",this._unpause,this)},_pause:function(){this._toggleEvents()},_unpause:function(){this.enabled()&&this._toggleEvents(!0)},_toggleEvents:function(t){this._map[t?"on":"off"](this._mapEventsListeners,this),this._map.poi&&this._map.poi.getMetaLayer()[t?"on":"off"]("click",this._mapEventsListeners.click,this)},getController:function(){return this._controller},_checkOpenPopup:function(){DG.Browser.mobile&&this._map._popup&&(this._map._popup.options.closeOnClick||this._map.options.closePopupOnClick)&&(this.popupWasOpen=!0)},_mapEventsListeners:{langchange:function(){this._controller.reinvokeHandler()},popupclose:function(t){this._controller.handlePopupClose(t.popup)},prepreclick:function(){this._checkOpenPopup()},click:function(t){0===this.clickCount?(this.clickCount=1,this._singleClick(t)):(this.clickCount=0,clearTimeout(this.pendingClick),this.popupWasOpen=!1)}},_singleClick:function(t){var e=this;clearTimeout(this.pendingClick),this.pendingClick=setTimeout(function(){if(t.meta&&(e._checkOpenPopup(),e._map.closePopup()),!e.popupWasOpen){var i=e._map.getZoom();e._controller.handleClick(t.latlng,i,t.meta)}e.clickCount=0,e.popupWasOpen=!1},this.timeout)}}),DG.Map.addInitHook("addHandler","geoclicker",DG.Geoclicker),DG.Geoclicker.clampHelper=function(t,e){var i,n,o,r,s,a,l,c,u,h=document.createElement.bind(document),d=document.createTextNode.bind(document);if(i=h("span"),function(t){t.position="absolute",t.whiteSpace="pre",t.visibility="hidden",t.margin="0 18px 8px 0"}(i.style),t.ownerDocument&&t.ownerDocument===document){for(r=a=0,s=1,u=!1,o=t.clientWidth,n=(t.textContent||t.innerText).replace(/\n/g," ");null!==t.firstChild;)t.removeChild(t.firstChild);t.appendChild(i),n.replace(/ |-/g,function(p,_){s!==e&&(i.appendChild(d(n.substr(r,_-r))),o<i.clientWidth?(u?(c=n.substr(r,_+1-r),r=_+1):(c=n.substr(r,a-r),r=a),l=h("span"),l.appendChild(d(c)),t.appendChild(l),l.className="dg-map-geoclicker__clamped-line",u=!0,s++):u=!1,a=_+1,i.removeChild(i.firstChild))}),t.removeChild(i),l=h("span"),l.className="dg-map-geoclicker__clamped-line dg-map-geoclicker__clamped-line_last",l.appendChild(d(n.substr(r))),t.appendChild(l)}},DG.Geoclicker.Provider={},DG.Geoclicker.Provider.CatalogApi=DG.Class.extend({options:{urlGeoSearch:"http://catalog.api.2gis.ru/2.0/geo/search",urlGeoGet:"http://catalog.api.2gis.ru/2.0/geo/get",urlDetails:"http://catalog.api.2gis.ru/2.0/catalog/branch/get",urlFirmsInHouse:"http://catalog.api.2gis.ru/2.0/catalog/branch/list",data:{key:"ruxlih0718"},geoFields:"items.geometry.selection,items.links,items.adm_div,items.address,items.floors,items.description",firmInfoFields:"items.reviews,items.photos,items.links,items.external_content",timeoutMs:5e3},initialize:function(t){this._map=t},getLocations:function(t){var e=t.zoom,i=t.latlng,n=t.beforeRequest||function(){},o=this.getTypesByZoom(e),r=i.lng+","+i.lat;return o?(n(),this.geoSearch(r,o,e).then(DG.bind(function(t){return this._filterResponse(t,o)},this))):Promise.reject("no type")},firmsInHouse:function(t,e){e=e||{};var i=DG.extend(this.options.data,{building_id:t,page:e.page||1});return this._performRequest(i,this.options.urlFirmsInHouse)},getFirmInfo:function(t){return this._performRequest({type:"filial",id:t,fields:this.options.firmInfoFields},this.options.urlDetails)},geoSearch:function(t,e,i){var n={point:t,type:e,zoom_level:i,fields:this.options.geoFields};return this._performRequest(n,this.options.urlGeoSearch)},geoGet:function(t){var e={id:t,fields:this.options.geoFields};return this._performRequest(e,this.options.urlGeoGet)},cancelLastRequest:function(){this._lastRequest&&this._lastRequest.abort()},getTypesByZoom:function(t){var e={"adm_div.settlement":8,"adm_div.city":8,"adm_div.division":11,"adm_div.district":12,street:14,building:14,"adm_div.place":15,poi:15,attraction:17},i=[];return Object.keys(e).forEach(function(n){t>=e[n]&&i.push(n)}),i.length?i.join(","):null},_performRequest:function(t,e){var i=this.options.data,n=DG.extend({key:i.key},t),o="get";return this.cancelLastRequest(),DG.ajax.corsSupport||(o=n.format="jsonp"),this._lastRequest=DG.ajax(e,{type:o,data:n,timeout:this.options.timeoutMs}),this._lastRequest},_filterResponse:function(t,e){var i,n,o,r,s,a={};if(this._isNotFound(t))return!1;for(r=t.result.items,i=r.length-1;i>=0;i--)n=r[i],s=n.type,n.subtype&&(s+="."+n.subtype),e&&-1===e.indexOf(s)||(a[s]=n,o=!0);return o?a:!1},_isNotFound:function(t){return!(t&&(!t.meta||!t.meta.error)&&t.result&&t.result.items&&t.result.items.length)}}),DG.Geoclicker.Handler={},DG.Geoclicker.Handler.Default=DG.Class.extend({includes:DG.Locale,statics:{Dictionary:{}},_eventHandlers:{},initialize:function(t,e,i){this._controller=t,this._view=e,this._map=i},handle:function(){return Promise.resolve({tmpl:"popupHeader",data:{title:this.t("we_have_not")}})},addClickEvent:function(){this._view._popup.on("click",this._runEventHandlers,this),this._map.once("popupclose",this._removeClickEvent,this)},_removeClickEvent:function(){this._view._popup.off("click",this._runEventHandlers,this)},_addEventHandler:function(t,e){this._eventHandlers[t]=e},_runEventHandlers:function(t){var e=t.originalEvent.target;for(var i in this._eventHandlers)if(this._eventHandlers.hasOwnProperty(i)&&e.className.indexOf(i)>-1)return DG.DomEvent.preventDefault(t.originalEvent),void this._eventHandlers[i].call(this,e)},_clearEventHandlers:function(){this._eventHandlers={}},_getDirectionsUrl:function(t){return DG.Util.template("http://2gis.{domain}/{projectCode}/center/{center}/zoom/{zoom}/routeTab/rsType/{rsType}/to/{point}{name}",{domain:this._map.projectDetector.getProject().domain,projectCode:this._map.projectDetector.getProject().code,center:this._map.getCenter().lng+","+this._map.getCenter().lat,zoom:this._map.getZoom(),name:encodeURIComponent(t),rsType:this._map.projectDetector.getProject().transport?"bus":"car",point:this._popup._latlng.lng+","+this._popup._latlng.lat})},_getDrilldown:function(t){var e,i=[];return t.adm_div&&(i=t.adm_div.reduce(function(t,e){return e.name&&t.push(e.name),t},[]).reverse()),i.length&&t.address&&t.address.postcode&&i.push(t.address.postcode),e=i.join(", ")}}),DG.Geoclicker.Handler.HandlerExample=DG.Geoclicker.Handler.Default.extend({handle:function(t,e){return Promise.resolve({tmpl:e+":<br/>"+t[e].id})}}),DG.Geoclicker.Handler.ApiError=DG.Geoclicker.Handler.Default.extend({handle:function(){var t=this._view.render({tmpl:"popupHeader",data:{title:this.t("apiErrorTitle")}});return Promise.resolve({header:t,tmpl:this.t("apiErrorBody")})}}),DG.Geoclicker.Handler.CityArea=DG.Geoclicker.Handler.Default.extend({_polylineStyleDefault:{fillColor:"#ff9387",color:"#ff9387",clickable:!1,noClip:!0,opacity:1},_polylineStyles:{11:{fillOpacity:.18,weight:1},12:{fillOpacity:.12,weight:1},13:{fillOpacity:.08,weight:2},18:{fillOpacity:0,weight:3}},handle:function(t,e){return t[e]?(this._stylesInited||this._initStyles(),this._popup=this._view.getPopup(),this._geometryZoomStyle=this._getPolyStyleNum(),this._geometry=DG.Wkt.geoJsonLayer(t[e].geometry.selection,{style:this._polylineStyles[this._geometryZoomStyle]}).addTo(this._map),this._map.on("zoomend",this._updateGeometry,this).once("popupclose",this._clearPopup,this),Promise.resolve(this._fillCityAreaObject(t,e))):!1},_fillCityAreaObject:function(t,e){var i={name:this.t("noname"),drilldown:"",purpose:this.t(e),type:e.split(".").join("_")};return i.drilldown=this._getDrilldown(t[e]),t[e].name&&(i.name=t[e].name),{tmpl:"cityarea",data:i,header:this._view.render({tmpl:"popupHeader",data:{title:i.name}})}},_initStyles:function(){this._stylesInited=!0,Object.keys(this._polylineStyles).forEach(function(t){DG.extend(this._polylineStyles[t],this._polylineStyleDefault)},this)},_getPolyStyleNum:function(){var t=this._map.getZoom();return Object.keys(this._polylineStyles).filter(function(e){return e>=t})[0]||!1},_updateGeometry:function(){var t=this._getPolyStyleNum();t&&t!==this._geometryZoomStyle&&(this._geometryZoomStyle=t,this._geometry.setStyle(this._polylineStyles[t]))},_clearPopup:function(){this._map.removeLayer(this._geometry).off("zoomend",this._updateGeometry,this)}}),DG.Geoclicker.Handler.House=DG.Geoclicker.Handler.Default.extend({_firmsOnPage:20,_scrollThrottleInterval:400,_scrollHeightReserve:60,options:{showBooklet:!0,showPhotos:!0,showRouteSearch:!0},handle:function(t){return t.building?(this.firmCard=null,this._page=1,this._houseObject=null,this._firmList=null,this._firmListObject=null,this._firmCardObject=null,this._onScroll=!1,this._isFirmlistOpen=!1,this._id=t.building.id,this._totalPages=1,this._api=this._controller.getCatalogApi(),this._popup=this._view.getPopup(),this._initedPopupClose=!1,this._directionsUrl=this._getDirectionsUrl(t.building.name),this._firmListLoader=this._view.initLoader(!0),this._houseObject=this._fillHouseObject(t.building),Promise.resolve(this._houseObject)):!1},_isRouteSearchAllowed:function(){var t=this._controller.getMap().projectDetector.getProject();return t.transport||t.roads},_firmCardSetup:function(){return{render:this._view._templates,lang:this._map.getLang(),domain:this._controller.getMap().projectDetector.getProject().domain,ajax:DG.bind(this._api.getFirmInfo,this._api),timezoneOffset:this._controller.getMap().projectDetector.getProject().timeOffset,map:this._map,popup:this._popup,isMobile:DG.Browser.mobile,showEntrance:DG.Entrance,gotoUrl:this._directionsUrl,onFirmReady:DG.bind(this._onFirmReady,this),onToggle:DG.bind(this._popup.resize,this._popup),showBooklet:this.options.showBooklet,showPhotos:this.options.showPhotos,showRouteSearch:this.options.showRouteSearch&&this._isRouteSearchAllowed(),t:DG.bind(this.t,this)}},_fillFirmCardObject:function(t){var e=this._firmCardSetup();return this.firmCard=new FirmCard(t,e),this._initPopupClose(),this.firmCard.getContainer()},_firmListSetup:function(){var t=this._firmCardSetup();return DG.extend(t,{backBtn:DG.bind(this._showHousePopup,this),onFirmClick:DG.bind(this._onFirmListClick,this),onShowLess:DG.bind(this._showHousePopup,this),pasteLoader:DG.bind(this._pasteLoader,this)}),{firmCard:t,firmlistItemTmpl:"firmlistItem",onListReady:DG.bind(this._renderFirmList,this)}},_initShortFirmList:function(t){var e=this._firmListSetup();return this._shortFirmList=new FirmCard.List(t,e),this._shortFirmList.renderList()},_initFirmList:function(t){if(!t)return!1;var e=t.result.items,i=this._firmListSetup();i.firmCard.backBtn=DG.bind(this._showListPopup,this),this._shortFirmList._toggleEventHandlers(!0),this._firmList=new FirmCard.List(e,i),this._firmListObject=this._fillFirmListObject(this._firmList.renderList()),this._clearAndRenderPopup(this._firmListObject)},_fillFirmListObject:function(t){var e=this;return{tmpl:t,header:this._header,footer:this._view.render({tmpl:"popupFooterBtns",data:{btns:[{name:"back",label:this.t("back_button"),icon:!0}]}}),afterRender:function(){e._initPopupClose(),e._totalPages>1&&e._firmListLoader&&this.tmpl.parentNode.appendChild(e._firmListLoader)}}},_onFirmReady:function(t){var e=this;t.afterRender=function(){var t=e._popup._popupStructure.header.firstChild;DG.Browser.ielt9||t.offsetHeight>72&&(DG.DomUtil.addClass(t,"dg-popup__header-teaser"),DG.Browser.webkit||DG.Geoclicker.clampHelper(t,3))},this._clearAndRenderPopup(t)},_showHousePopup:function(){this._popup.off("scroll",this._onScroll),this._clearAndRenderPopup(this._houseObject),this._shortFirmList._toggleEventHandlers()},_onFirmListClick:function(){this._popup.off("scroll",this._onScroll)},_pasteLoader:function(){var t=DG.DomUtil.create("div","dg-map-geoclicker__preloader-wrapper"),e=this._view.initLoader();t.insertBefore(e,t.firstChild),t.style.height=this._popup._contentNode.offsetHeight-1+"px",t.style.width=this._popup._contentNode.offsetWidth+"px",this._clearAndRenderPopup({tmpl:t})},_initPopupClose:function(){this._initedPopupClose||(this._controller.getMap().once("popupclose",DG.bind(this._onPopupClose,this)),this._initedPopupClose=!0)},_showListPopup:function(){var t=this._firmListObject;this._pasteLoader(),t?(this._clearAndRenderPopup(t),this._firmList._toggleEventHandlers()):t=this._api.firmsInHouse(this._id).then(DG.bind(this._initFirmList,this)),this._onScroll||(this._onScroll=DG.Util.throttle(this._handlePopupScroll,this._scrollThrottleInterval,this)),this._popup.on("scroll",this._onScroll)},_renderFirmList:function(){this._isFirmlistOpen||(this._popup.resize(),this._isFirmlistOpen=!0)},_onPopupClose:function(){this._initedPopupClose=!1,this._firmList&&(this._firmList.clearList(),this._firmList=null,this._popup.off("scroll",this._onScroll)),this._firmId=null,this.firmCard&&(this.firmCard._toggleEventHandlers(!0),this.firmCard=null),this._firmListLoader=null,this._page=1,this._clearEventHandlers()},_initShowMore:function(){var t=this._popup.findElement(".dg-popup__button_name_all");t&&this._addEventHandler("dg-popup__button_name_all",DG.bind(this._showListPopup,this))},_clearAndRenderPopup:function(t){this._clearEventHandlers(),this._popup.clear("header","footer"),this._view.renderPopup(t)},_appendFirmList:function(t){this._firmList.addFirms(t.result.items),this._popup._updateScrollPosition()},_handlePopupScroll:function(t){var e=t.originalEvent.target||t.target._scroller;DG.DomEvent.stop(t),this._totalPages<=1||e&&e.scrollHeight<=e.scrollTop+e.offsetHeight+this._scrollHeightReserve&&this._handlePaging()},_handlePaging:function(){if(this._page++,this._totalPages&&this._page<=this._totalPages&&this._api.firmsInHouse(this._id,{page:this._page}).then(DG.bind(this._appendFirmList,this)),this._page===this._totalPages){var t=this._firmListLoader;t&&t.parentNode&&t.parentNode.removeChild(t),this._popup.off("scroll",this._onScroll)}}}),DG.Geoclicker.Handler.House.include({_getAddressString:function(t){return t.address&&t.address.components?t.address.components.filter(function(t){return"street_number"===t.type}).map(function(t){return t.street+", "+t.number}).join(" / "):""},_fillBody:function(t){var e={},i=DG.DomUtil.create("div","dg-building-callout__body"),n=t.links.branches,o=this._getDrilldown(t);return t.building_name?e.address={header:this._getAddressString(t),drilldown:o}:o&&(e.address={drilldown:o}),e.purpose=t.purpose_name+(t.floors?", "+this.t("n_floors",t.floors.ground_count):""),t.links.branches.count>0&&(this._totalPages=Math.ceil(t.links.branches.count/this._firmsOnPage)),t.links.attractions&&t.links.attractions.length&&(e.attractions=t.links.attractions.reduce(function(t,e){return e.name&&t.push(e.name),t},[])),i.innerHTML=this._view.render({tmpl:"house",data:e}),n.items&&i.appendChild(this._initShortFirmList(n.items)),i},_fillHeader:function(t){var e={};return e.title=t.building_name?t.building_name:t.address&&t.address.components?this._getAddressString(t):t.purpose_name,this._header=this._view.render({tmpl:"popupHeader",data:e}),this._header},_fillFooter:function(t){var e=[],i=t.links.branches;return i.items&&i.items.length&&i.count>i.items.length&&e.push(this._getShowAllData(i.count)),this._isRouteSearchAllowed()&&e.push({name:"goto",label:this.t("go_to"),icon:!0,href:this._directionsUrl}),this._view.render({tmpl:"popupFooterBtns",data:{btns:e}})},_getShowAllData:function(t){return{name:"all",label:this.t("show_organization_in_building",t)}},_fillHouseObject:function(t){var e=this;return{header:this._fillHeader(t),tmpl:this._fillBody(t),footer:this._fillFooter(t),afterRender:function(){e._initShowMore(),e._initPopupClose()}}}}),DG.Geoclicker.Handler.Poi=DG.Geoclicker.Handler.House.extend({handle:function(t){if(!t.poi)return!1;if(this.firmCard=null,this._page=1,this._houseObject=null,this._firmList=null,this._firmListObject=null,this._firmCardObject=null,this._onScroll=!1,this._isFirmlistOpen=!1,this._id=t.poi.reference.id,this._totalPages=1,this._api=this._controller.getCatalogApi(),this._popup=this._view.getPopup(),this._initedPopupClose=!1,this._directionsUrl=this._getDirectionsUrl(t.poi.reference.name),this._firmListLoader=this._view.initLoader(!0),"building"===t.poi.reference.type){var e=this;return e._api.geoGet(t.poi.reference.id).then(function(t){return e._houseObject=e._fillHouseObject(t.result.items[0]),Promise.resolve(e._houseObject)})}return"branch"===t.poi.reference.type?(this._fillFirmCardObject(t.poi.reference.id),!0):!1}}),DG.Geoclicker.Handler.Sight=DG.Geoclicker.Handler.Default.extend({handle:function(t){return t.attraction?(this._popup=this._view.getPopup(),this._initedPopupClose=!1,Promise.resolve(this._fillSightObject(t))):!1},_fillSightObject:function(t){var e=t.attraction,i={},n=this,o={btns:[{name:"goto",label:this.t("go_to"),icon:!0}]};return e.name?(i.buildingName=e.name,i.purpose=e.subtype_name):i.buildingName=e.subtype_name,i.description=e.description,i.drillDown=this._getDrilldown(e),this._checkDescFieldHeight(i.description)&&(i.showMoreText=this.t("show_more_about_sight")),o.btns[0].href=this._getDirectionsUrl(i.buildingName),{tmpl:"sight",data:i,header:this._view.render({tmpl:"popupHeader",data:{title:i.buildingName}}),footer:this._view.render({tmpl:"popupFooterBtns",data:o}),afterRender:function(){n._needShowMore&&n._initShowMore(),n._initPopupClose()}}},_initPopupClose:function(){this._initedPopupClose||(this._controller.getMap().once("popupclose",DG.bind(this._clearPopup,this)),this._initedPopupClose=!0)},_clearPopup:function(){this._initedPopupClose=!1,this._clearEventHandlers()},_showMoreText:function(){this._desc.style.maxHeight="100%",this._link.parentNode.removeChild(this._link),this._popup.resize()},_initShowMore:function(){this._link=this._popup.findElement(".dg-map-geoclicker__show-more-sights-link"),this._desc=this._popup.findElement(".dg-map-geoclicker__sight-description"),this._link&&this._desc&&this._addEventHandler("dg-map-geoclicker__show-more-sights-link",DG.bind(this._showMoreText,this))},_checkDescFieldHeight:function(t){var e,i=DG.DomUtil.create("div","");return i.style.visibility="hidden",i.innerHTML=t,this._popup._contentNode.appendChild(i),e=i.offsetHeight,this._popup._contentNode.removeChild(i),this._needShowMore=e>40,this._needShowMore}}),DG.Geoclicker.View=DG.Class.extend({initialize:function(t,e){this._map=t,this._popup=DG.popup({maxHeight:300,minHeight:50,maxWidth:385,minWidth:310,sprawling:!0,closeOnClick:!0}),this._templates=DG.dust({cityarea:'(function(){dust.register("cityarea",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__purpose dg-map-geoclicker__purpose_type_").reference(ctx.get(["type"], false),ctx,"h").write("\\">").reference(ctx.get(["purpose"], false),ctx,"h").write("</div>").section(ctx.get(["drilldown"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__drilldown\\">").reference(ctx.get(["drilldown"], false),ctx,"h").write("</div>");}return body_0;})();',firmCardAddr:'(function(){dust.register("firmCardAddr",body_0);function body_0(chk,ctx){return chk.write("<address class=\\"dg-firm-card__address dg-firm-card__icon\\">").reference(ctx.get(["address"], false),ctx,"h").section(ctx.get(["comment"], false),ctx,{"block":body_1},null).write("</address>");}function body_1(chk,ctx){return chk.write("<span class=\\"dg-firm-card__comment\\">&mdash; ").reference(ctx.getPath(true, []),ctx,"h").write("</span>");}return body_0;})();',firmCardContacts:'(function(){dust.register("firmCardContacts",body_0);function body_0(chk,ctx){return chk.section(ctx.get(["groups"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.section(ctx.get(["contacts"], false),ctx,{"block":body_2},null);}function body_2(chk,ctx){return chk.helper("select",ctx,{"block":body_3},{"key":ctx.get(["type"], false),"type":"string"});}function body_3(chk,ctx){return chk.helper("eq",ctx,{"block":body_4},{"value":"phone","type":"string"}).helper("eq",ctx,{"block":body_6},{"value":"fax","type":"string"}).helper("eq",ctx,{"block":body_8},{"value":"website","type":"string"}).helper("eq",ctx,{"block":body_9},{"value":"email","type":"string"});}function body_4(chk,ctx){return chk.write("<div class=\\"dg-firm-card__phone dg-firm-card__icon\\"><span class=\\"dg-firm-card__phone-num\\">").reference(ctx.get(["text"], false),ctx,"h").section(ctx.get(["comment"], false),ctx,{"block":body_5},null).write("</span></div>");}function body_5(chk,ctx){return chk.write("<span class=\\"dg-firm-card__comment\\" title=\\"").reference(ctx.getPath(true, []),ctx,"h").write("\\">&mdash;&nbsp;&nbsp;").reference(ctx.getPath(true, []),ctx,"h").write("</span>");}function body_6(chk,ctx){return chk.write("<div class=\\"dg-firm-card__phone dg-firm-card__icon\\"><span class=\\"dg-firm-card__phone-num\\">").reference(ctx.get(["text"], false),ctx,"h").section(ctx.get(["comment"], false),ctx,{"block":body_7},null).write("</span></div>");}function body_7(chk,ctx){return chk.write("<span class=\\"dg-firm-card__comment\\" title=\\"").reference(ctx.getPath(true, []),ctx,"h").write("\\">&mdash;&nbsp;&nbsp;").reference(ctx.getPath(true, []),ctx,"h").write("</span>");}function body_8(chk,ctx){return chk.write("<div class=\\"dg-firm-card__link dg-firm-card__site dg-firm-card__icon\\"><a href=\\"").reference(ctx.get(["url"], false),ctx,"h").write("\\" target=\\"_blank\\" class=\\"dg-link_scheme_dark dg-firm-card__sitelink\\">").reference(ctx.get(["text"], false),ctx,"h").write("</a></div>");}function body_9(chk,ctx){return chk.write("<div class=\\"dg-firm-card__link dg-firm-card__email dg-firm-card__icon\\"><a href=\\"mailto: ").reference(ctx.get(["value"], false),ctx,"h").write("\\">").reference(ctx.get(["value"], false),ctx,"h").write("</a></div>");}return body_0;})();',firmCardHeader:'(function(){dust.register("firmCardHeader",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-popup__header-title dg-popup__header-title_for_firmcard\\" title=\\"").reference(ctx.get(["firmName"], false),ctx,"h").write("\\">").reference(ctx.get(["firmName"], false),ctx,"h").write("</div>").exists(ctx.get(["links"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<div class=\\"dg-popup__header-links\\">").section(ctx.get(["links"], false),ctx,{"block":body_2},null).write("</div>");}function body_2(chk,ctx){return chk.helper("eq",ctx,{"else":body_3,"block":body_6},{"key":body_7,"value":"flamp_stars","type":"string"});}function body_3(chk,ctx){return chk.write("<a class=\\"dg-popup__header-link dg-popup__link dg-popup__link_type_").reference(ctx.get(["name"], false),ctx,"h").write("\\"").exists(ctx.get(["href"], false),ctx,{"else":body_4,"block":body_5},null).write(">").reference(ctx.get(["label"], false),ctx,"h").write("</a>");}function body_4(chk,ctx){return chk.write("href=\\"javascript:void(0)\\"");}function body_5(chk,ctx){return chk.write("href=").reference(ctx.get(["href"], false),ctx,"h").write(" target=\\"_blank\\"");}function body_6(chk,ctx){return chk.write("<div class=\\"dg-popup__rating\\"><div class=\\"dg-popup__rating-stars\\" style=\\"width: ").reference(ctx.get(["width"], false),ctx,"h").write("%\\"></div></div>");}function body_7(chk,ctx){return chk.reference(ctx.get(["name"], false),ctx,"h");}return body_0;})();',firmCardRubric:'(function(){dust.register("firmCardRubric",body_0);function body_0(chk,ctx){return chk.section(ctx.get(["rubrics"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<section class=\\"dg-firm-card__rubrics\\">").exists(ctx.get(["primary"], false),ctx,{"block":body_2},null).exists(ctx.get(["additional"], false),ctx,{"block":body_4},null).write("</section>");}function body_2(chk,ctx){return chk.write("<ul class=\\"dg-firm-card__rubrics-list dg-firm-card__rubrics-list_type_primary\\">").section(ctx.get(["primary"], false),ctx,{"block":body_3},null).write("</ul>");}function body_3(chk,ctx){return chk.write("<li class=\\"dg-firm-card__rubrics-list-item\\">").reference(ctx.get(["name"], false),ctx,"h").write("</li>");}function body_4(chk,ctx){return chk.write("<ul class=\\"dg-firm-card__rubrics-list dg-firm-card__rubrics-list_type_additional\\">").section(ctx.get(["additional"], false),ctx,{"block":body_5},null).write("</ul>");}function body_5(chk,ctx){return chk.write("<li class=\\"dg-firm-card__rubrics-list-item\\">").reference(ctx.get(["name"], false),ctx,"h").write("</li>");}return body_0;})();',
firmCardSchedule:'(function(){dust.register("firmCardSchedule",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-firm-card__schedule dg-schedule dg-schedule_open_").exists(ctx.getPath(false, ["forecast","open"]),ctx,{"else":body_1,"block":body_2},null).write(" dg-schedule_works-everyday_").exists(ctx.getPath(false, ["schedule","everyday"]),ctx,{"else":body_3,"block":body_4},null).write("\\">").exists(ctx.get(["schedule"], false),ctx,{"block":body_5},null).write("</div>");}function body_1(chk,ctx){return chk.write("false");}function body_2(chk,ctx){return chk.write("true");}function body_3(chk,ctx){return chk.write("false");}function body_4(chk,ctx){return chk.write("true");}function body_5(chk,ctx){return chk.exists(ctx.getPath(false, ["forecast","today"]),ctx,{"block":body_6},null).section(ctx.getPath(false, ["forecast","now"]),ctx,{"block":body_10},null).notexists(ctx.getPath(false, ["schedule","everyday"]),ctx,{"block":body_12},null);}function body_6(chk,ctx){return chk.write("<div class=\\"dg-schedule__today\\"><div class=\\"dg-schedule__today-inner\\">").reference(ctx.getPath(false, ["forecast","today","text"]),ctx,"h").write("&nbsp;").exists(ctx.getPath(false, ["forecast","today","from"]),ctx,{"block":body_7},null).exists(ctx.getPath(false, ["schedule","lunch"]),ctx,{"block":body_8},null).write("</div></div>");}function body_7(chk,ctx){return chk.reference(ctx.getPath(false, ["forecast","today","from"]),ctx,"h").write("&ndash;").reference(ctx.getPath(false, ["forecast","today","to"]),ctx,"h");}function body_8(chk,ctx){return chk.write(",&nbsp;").reference(ctx.getPath(false, ["forecast","today","lunchStr"]),ctx,"h").write("&nbsp;").section(ctx.getPath(false, ["schedule","lunch"]),ctx,{"block":body_9},null);}function body_9(chk,ctx){return chk.reference(ctx.get(["from"], false),ctx,"h").write("&ndash;").reference(ctx.get(["to"], false),ctx,"h");}function body_10(chk,ctx){return chk.write("<div class=\\"dg-schedule__now\\"><span class=\\"dg-schedule__now-text\\">").reference(ctx.getPath(true, []),ctx,"h").section(ctx.getPath(false, ["schedule","comment"]),ctx,{"block":body_11},null).write("</span></div>");}function body_11(chk,ctx){return chk.write(", ").reference(ctx.getPath(true, []),ctx,"h");}function body_12(chk,ctx){return chk.exists(ctx.getPath(false, ["schedule","week"]),ctx,{"block":body_13},null);}function body_13(chk,ctx){return chk.exists(ctx.getPath(false, ["schedule","week","evently"]),ctx,{"block":body_14},null).exists(ctx.getPath(false, ["schedule","week","table"]),ctx,{"block":body_22},null);}function body_14(chk,ctx){return chk.write("<div class=\\"dg-schedule__table\\">").section(ctx.getPath(false, ["schedule","week","evently"]),ctx,{"block":body_15},null).write("</div>");}function body_15(chk,ctx){return chk.write("<div class=\\"dg-schedule__string\\">").exists(ctx.get(["alltime"], false),ctx,{"block":body_16},null).exists(ctx.get(["everyday"], false),ctx,{"else":body_17,"block":body_18},null).exists(ctx.get(["holiday"], false),ctx,{"else":body_19,"block":body_21},null).write("</div>");}function body_16(chk,ctx){return chk.reference(ctx.get(["alltimeStr"], false),ctx,"h");}function body_17(chk,ctx){return chk.reference(ctx.get(["dayList"], false),ctx,"h");}function body_18(chk,ctx){return chk.reference(ctx.getPath(false, ["forecast","today","text"]),ctx,"h");}function body_19(chk,ctx){return chk.write("<span class=\\"schedule__string-time\\">&nbsp;").reference(ctx.get(["from"], false),ctx,"h").write("&ndash;").reference(ctx.get(["to"], false),ctx,"h").write("</span>").section(ctx.get(["lunch"], false),ctx,{"block":body_20},null);}function body_20(chk,ctx){return chk.write("<p>").reference(ctx.get(["lunchStr"], false),ctx,"h").write("&mdash;<span class=\\"schedule__string-time\\">").reference(ctx.get(["from"], false),ctx,"h").write("&ndash;").reference(ctx.get(["to"], false),ctx,"h").write("</span></p>");}function body_21(chk,ctx){return chk.write("&nbsp;&mdash;<span class=\\"schedule__string-time\\">&nbsp;").reference(ctx.get(["holidayStr"], false),ctx,"h").write("</span>");}function body_22(chk,ctx){return chk.write("<div><div class=\\"dg-schedule__table\\"><div class=\\"dg-schedule__tc dg-schedule__tc_pre\\"><div class=\\"dg-schedule__day-name\\">&nbsp;</div><div class=\\"dg-schedule__table-clock dg-schedule__td\\"></div>").exists(ctx.getPath(false, ["schedule","week","hasLunch"]),ctx,{"block":body_23},null).write("</div>").section(ctx.getPath(false, ["schedule","week","table"]),ctx,{"block":body_24},null).write("</div>  </div>");}function body_23(chk,ctx){return chk.write("<div class=\\"dg-schedule__table-lunch dg-schedule__td\\"></div>");}function body_24(chk,ctx){return chk.helper("if",ctx,{"block":body_25},{"cond":body_26}).write("<div class=\\"dg-schedule__tc").exists(ctx.get(["active"], false),ctx,{"block":body_27},null).write("\\"><div class=\\"dg-schedule__day-name\\">").reference(ctx.get(["key"], false),ctx,"h").write("</div><div class=\\"dg-schedule__td\\">").exists(ctx.get(["from"], false),ctx,{"else":body_28,"block":body_29},null).write("</div>").section(ctx.get(["lunch"], false),ctx,{"block":body_30},null).write("</div> ").helper("if",ctx,{"block":body_33},{"cond":body_34});}function body_25(chk,ctx){return chk.write("<span class=\\"dg-schedule__table-cell-group\\">");}function body_26(chk,ctx){return chk.write("(").reference(ctx.get(["$idx"], false),ctx,"h").write(" == ").reference(ctx.get(["$len"], false),ctx,"h").write(" - 2)");}function body_27(chk,ctx){return chk.write(" dg-schedule__tc_active_true");}function body_28(chk,ctx){return chk.write("&ndash;");}function body_29(chk,ctx){return chk.reference(ctx.get(["from"], false),ctx,"h").write(" ").reference(ctx.get(["to"], false),ctx,"h");}function body_30(chk,ctx){return chk.write("<div class=\\"dg-schedule__td\\">").exists(ctx.get(["from"], false),ctx,{"else":body_31,"block":body_32},null).write("</div>");}function body_31(chk,ctx){return chk.write("&ndash;");}function body_32(chk,ctx){return chk.reference(ctx.get(["from"], false),ctx,"h").write(" ").reference(ctx.get(["to"], false),ctx,"h");}function body_33(chk,ctx){return chk.write("</span>");}function body_34(chk,ctx){return chk.write("(").reference(ctx.get(["$idx"], false),ctx,"h").write(" == ").reference(ctx.get(["$len"], false),ctx,"h").write(")");}return body_0;})();',firmlistItem:'(function(){dust.register("firmlistItem",body_0);function body_0(chk,ctx){return chk.write("<a id=\\"").reference(ctx.getPath(false, ["firm","id"]),ctx,"h").write("\\" class=\\"dg-popup__link\\" href=\\"#\\">").reference(ctx.getPath(false, ["firm","name"]),ctx,"h").write("</a>");}return body_0;})();',frimCardPayments:'(function(){dust.register("frimCardPayments",body_0);function body_0(chk,ctx){return chk.exists(ctx.get(["payments"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<section class=\\"dg-firm-card__aa\\"><ul class=\\"dg-firm-card__aa-list\\">").section(ctx.get(["payments"], false),ctx,{"block":body_2},null).write("</ul></section>");}function body_2(chk,ctx){return chk.write("<li class=\\"dg-firm-card__aa-list-item\\">").reference(ctx.getPath(true, []),ctx,"h").write("</li>");}return body_0;})();',house:'(function(){dust.register("house",body_0);function body_0(chk,ctx){return chk.section(ctx.get(["address"], false),ctx,{"block":body_1},null).section(ctx.get(["purpose"], false),ctx,{"block":body_4},null).section(ctx.get(["attractions"], false),ctx,{"block":body_5},null);}function body_1(chk,ctx){return chk.write("<address class=\\"dg-map-geoclicker__address\\">").section(ctx.getPath(false, ["address","header"]),ctx,{"block":body_2},null).section(ctx.getPath(false, ["address","drilldown"]),ctx,{"block":body_3},null).write("</address>");}function body_2(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__address-header\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}function body_3(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__address-drilldown\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}function body_4(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__purpose\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}function body_5(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__purpose dg-map-geoclicker__purpose_type_sight\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}return body_0;})();',loader:'(function(){dust.register("loader",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-preloader dg-preloader_scheme_regular dg-preloader_animation_").exists(ctx.get(["anim"], false),ctx,{"else":body_1,"block":body_2},null).exists(ctx.get(["small"], false),ctx,{"block":body_3},null).write("\\"></div>");}function body_1(chk,ctx){return chk.write("false");}function body_2(chk,ctx){return chk.write("true");}function body_3(chk,ctx){return chk.write(" dg-preloader_size_small");}return body_0;})();',popupFooter:'(function(){dust.register("popupFooter",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-popup__footer-title\\"><a class=\\"dg-popup__show-less-house-link\\" href=\\"javascript:void(0)\\">").reference(ctx.get(["hideFirmsText"], false),ctx,"h").write("</a></div>");}return body_0;})();',popupFooterBtns:'(function(){dust.register("popupFooterBtns",body_0);function body_0(chk,ctx){return chk.exists(ctx.get(["btns"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<footer class=\\"dg-popup__footer-buttons\\">").section(ctx.get(["btns"], false),ctx,{"block":body_2},null).write("</footer>");}function body_2(chk,ctx){return chk.write("<div class=\\"dg-popup__footer-button-wrapper\\"><a class=\\"dg-popup__button_name_").reference(ctx.get(["name"], false),ctx,"h").write(" dg-popup__footer-button").exists(ctx.get(["icon"], false),ctx,{"block":body_3},null).write("\\"").exists(ctx.get(["href"], false),ctx,{"else":body_4,"block":body_5},null).write(">").reference(ctx.get(["label"], false),ctx,"h").write("</a></div>");}function body_3(chk,ctx){return chk.write(" dg-popup__footer-icon-button");}function body_4(chk,ctx){return chk.write("href=\\"javascript:void(0)\\"");}function body_5(chk,ctx){return chk.write("href=").reference(ctx.get(["href"], false),ctx,"h").write(" target=\\"_blank\\"");}return body_0;})();',popupHeader:'(function(){dust.register("popupHeader",body_0);function body_0(chk,ctx){return chk.section(ctx.get(["title"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<div class=\\"dg-popup__header-title\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}return body_0;})();',sight:'(function(){dust.register("sight",body_0);function body_0(chk,ctx){return chk.section(ctx.get(["purpose"], false),ctx,{"block":body_1},null).section(ctx.get(["address"], false),ctx,{"block":body_2},null).section(ctx.get(["description"], false),ctx,{"block":body_5},null);}function body_1(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__purpose dg-map-geoclicker__purpose_type_sight\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}function body_2(chk,ctx){return chk.write("<address class=\\"dg-map-geoclicker__address\\">").section(ctx.getPath(false, ["address","header"]),ctx,{"block":body_3},null).section(ctx.getPath(false, ["address","drilldown"]),ctx,{"block":body_4},null).write("</address>");}function body_3(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__address-header\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}function body_4(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__address-drilldown\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}function body_5(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__sight-description\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>").section(ctx.get(["showMoreText"], false),ctx,{"block":body_6},null);}function body_6(chk,ctx){return chk.write("<a class=\\"dg-map-geoclicker__show-more-sights-link\\" href=\\"javascript:void(0)\\">").reference(ctx.getPath(true, []),ctx,"h").write("</a>");}return body_0;})();'}),e&&DG.Util.setOptions(this,e)},initLoader:function(t){var e=document.createElement("div");return e.innerHTML=this._templates("loader",{small:t,anim:this._detectCssAnimation()}),e.firstChild},showPopup:function(t,e){this._popup.setContent(e).setLatLng(t).openOn(this._map)},render:function(t){var e,i={};return t=t||{},t.tmpl=t.tmpl||"",e=t.data?this._templates(t.tmpl,t.data):t.tmpl,t.beforeRender&&t.beforeRender(),t.popup&&(t.header&&(i.header=t.header),t.footer&&(i.footer=t.footer),i.body=e,this._popup.setContent(i)),t.afterRender&&t.afterRender(),e},renderPopup:function(t){return t.popup=!0,this.render(t)},getPopup:function(){return this._popup},_detectCssAnimation:function(){var t=!1,e="Webkit Moz O ms Khtml".split(" "),i=document.createElement("div");if(i.style.animationName&&(t=!0),t===!1)for(var n=0;n<e.length;n++)if(i.style[e[n]+"AnimationName"]!==undefined){t=!0;break}return t}}),DG.Geoclicker.Controller=DG.Class.extend({options:{handlersSequence:{poi:DG.Geoclicker.Handler.Poi,attraction:DG.Geoclicker.Handler.Sight,building:DG.Geoclicker.Handler.House,street:DG.Geoclicker.Handler.CityArea,"adm_div.place":DG.Geoclicker.Handler.CityArea,"adm_div.district":DG.Geoclicker.Handler.CityArea,"adm_div.division":DG.Geoclicker.Handler.CityArea,"adm_div.settlement":DG.Geoclicker.Handler.CityArea,"adm_div.city":DG.Geoclicker.Handler.CityArea,"default":DG.Geoclicker.Handler.Default,apiError:DG.Geoclicker.Handler.ApiError}},initialize:function(t,e){this._options=e,this._handlers={},this._catalogApi=new DG.Geoclicker.Provider.CatalogApi(t),this._map=t,this._view=new DG.Geoclicker.View(t),this._renderHandlerResult=DG.bind(this._renderHandlerResult,this),this._lastHandleClickArguments=null},handlePopupClose:function(t){t===this._view.getPopup()&&(this._lastHandleClickArguments=null,this._catalogApi.cancelLastRequest())},handleClick:function(t,e,i){function n(){var e=o._view.initLoader();o._view._popup.clear(),o._view.showPopup(t,e),o._lastHandleClickArguments=r}var o=this,r=Array.prototype.slice.call(arguments,0);i&&i.linked?(n(),o.handleResponse({poi:{reference:i.linked}})):this._catalogApi.getLocations({latlng:t,zoom:e,beforeRequest:n}).then(function(t){o.handleResponse(t)},function(t){o.handleResponse(t)})},handleResponse:function(t){var e;if(!t)return void this._runHandler("default");if("no type"!==t){if("aborted"===t)return void this._runHandler("apiError");for(e=this.findHandler(t);e;){if(this._runHandler(e,t))return;delete t[e],e=this.findHandler(t)}this._runHandler("default")}},findHandler:function(t){for(var e in this.options.handlersSequence)if(t[e])return e;return null},getCatalogApi:function(){return this._catalogApi},getMap:function(){return this._map},reinvokeHandler:function(){this._lastHandleClickArguments&&this.handleClick.apply(this,this._lastHandleClickArguments)},_runHandler:function(t,e){e=e||{},this._initHandlerOnce(t),this._handlers[t].addClickEvent();var i=this._handlers[t].handle(e,t);return i&&i.then?i.then(this._renderHandlerResult):i},_renderHandlerResult:function(t){this._view.renderPopup(t)},_initHandlerOnce:function(t){this._handlers[t]||(this._handlers[t]=new this.options.handlersSequence[t](this,this._view,this._map,this._options))}}),DG.Geoclicker.Handler.Default.Dictionary.it=DG.extend({apiErrorTitle:"Oh oh, c'&nbsp;un&nbsp;errore",apiErrorBody:"I nostri server si rifiutano di rispondere. Stiamo facendo del nostro meglio per convincerli a&nbsp;comportarsi bene. Ritorna tra qualche minuto.",we_have_not:"Non disponiamo ancora di informazioni su questo posto",noname:"Nome non indicato","adm_div.place":"Luogo","adm_div.division":"Zona","adm_div.settlement":"Comune",street:"Via","adm_div.district":"Municipalit","adm_div.city":"itt",go_to:"Come arrivare",show_organization_in_building:["{n} azienda in tutto","{n} aziende in tutto"],show_more_about_sight:"Maggiori informazioni",back_button:"Indietro",n_floors:["{n} piano","{n} piani"]},DG.Dictionary.it),DG.Geoclicker.Handler.Default.Dictionary.ru=DG.extend({apiErrorTitle:" ",apiErrorBody:"   .     ,   .  &nbsp; &nbsp; .",we_have_not:"      ",noname:" ","adm_div.place":"","adm_div.division":"","adm_div.settlement":" ",street:"","adm_div.district":"","adm_div.city":"",go_to:" ",show_organization_in_building:[" {n} "," {n} "," {n} "],show_more_about_sight:"",back_button:"",n_floors:["{n} ","{n} ","{n} "]},DG.Dictionary.ru),DG.Geoclicker.Handler.Default.Dictionary.en=DG.extend({apiErrorTitle:"Oops! Error detected.",apiErrorBody:"Our servers are not responding. We are doing our best to straighten them out. Please return to us in a few minutes.",we_have_not:"We haven't collected info about this place yet",noname:"No name","adm_div.place":"Place","adm_div.division":"Area","adm_div.settlement":"Village",street:"Street","adm_div.district":"District","adm_div.city":"City",go_to:"Directions to here",show_organization_in_building:["{n} organization total","{n} organizations total"],back_button:"Back",show_more_about_sight:"More information",n_floors:["{n} floor","{n} floors"]},DG.Dictionary.en),DG.Geoclicker.Handler.Default.Dictionary.cs=DG.extend({apiErrorTitle:"Chybika se&nbsp;vloudila",apiErrorBody:"Nae servery odmtaj reagovat. Ji nyn vynakldme veker sil, abychom je pivedli k rozumu. Zkuste akci opakovat za nkolik minut.",we_have_not:"O tomto mst zatm nemme informace",noname:"Bez nzvu","adm_div.place":"Msto","adm_div.division":"Sprvn obvod","adm_div.settlement":"Obec",street:"Ulice","adm_div.district":"Mstsk st","adm_div.city":"Msto",go_to:"Cesta sem",show_organization_in_building:["Celkem {n} organizace","Celkem {n} organizace","Celkem {n} organizac"],back_button:"Zpt",show_more_about_sight:"Vce",n_floors:["{n} patro","{n} patra","{n} pater"]},DG.Dictionary.cs),DG.Geoclicker.Handler.Default.Dictionary.es=DG.extend({apiErrorTitle:"Vaya, ha ocurrido un error",apiErrorBody:"Nuestros servidores se niegan a responder. Ya nos estamos esforzando por hacerlos entrar en razn. Vuelva con nosotrospasados unos minutos.",we_have_not:"Todava no hemos recopilado la informacin sobre este lugar",noname:"Sin nombre","adm_div.place":"Lugar","adm_div.division":"Comuna","adm_div.settlement":"Poblacin",street:"Calle","adm_div.district":"Comuna","adm_div.city":"Ciudad",go_to:"Ir para all",show_organization_in_building:["Total {n} organizacin","Total {n} organizaciones","Total {n} organizaciones"],show_more_about_sight:"Read more",back_button:"Atrs",n_floors:["{n} piso","{n} pisos"]},DG.Dictionary.es);var FirmCard=function(t,e){this._setOptions(e),this._firmContentObject={},this._schedule=new FirmCard.Schedule({localLang:this.options.lang,dict:this.dict}),this.render(t)};FirmCard.prototype={render:function(t){return t?(t!==this._firmId?(this._firmContentObject={},this._renderCardById(t)):this._toggleEventHandlers(),this._firmContentObject):void 0},getSchedule:function(){return this._schedule},getContainer:function(){return this._container},_renderCardById:function(t){var e=this;this.options.ajax(t).then(function(i){if(!i)return!1;var n=i.result.items;"undefined"!==n&&(e._firmData=n[0],e._convertWebsite(),e._firmId=t,e._renderFirmCard(),e._toggleEventHandlers())},function(t){e._renderError()})},_createFirmContainer:function(){var t=document.createElement("div");return t.setAttribute("id","dg-map-firm-full-"+this._firmId),t.setAttribute("class","dg-map-firm-full"),t},_getPaymentTypes:function(t){var e=[],i="general_payment_type";return t.attribute_groups?(t.attribute_groups.forEach(function(t){t.name||t.attributes.forEach(function(t){t.tag.substring(0,i.length)===i&&e.push(t.name)})}),e):e},_groupRubrics:function(t){var e={primary:[],additional:[]};return t.rubrics&&t.rubrics.length?(t.rubrics.forEach(function(t){e[t.kind].push(t)}),e):e},_convertWebsite:function(){this._firmData.contact_groups&&this._firmData.contact_groups.forEach(function(t){t.contacts&&t.contacts.forEach(function(t){"website"==t.type&&(t.url||(t.url=t.value))})})},_renderFirmCard:function(){var t,e,i,n,o,r,s,a=this._firmData,l=this._container=this._createFirmContainer();e=this._schedule.transform(a.schedule,{zoneOffset:this.options.timezoneOffset,apiLang:this.options.lang,localLang:this.options.lang}),i=this._schedule.forecast(e),r=this._getPaymentTypes(a),s=this._groupRubrics(a),t=this._buildFirmCardBody(this._getConfigFirmCardBody(a,e,i,r,s)),n=this._fillHeaderLinks(),o=this._fillFooterButtons(),this._firmContentObject.header=this.options.render("firmCardHeader",{firmName:a.name,links:n}),l.innerHTML=t,this._firmContentObject.tmpl=l,o.length&&(this._footerContainer=document.createElement("div"),this._footerContainer.innerHTML=this.options.render("popupFooterBtns",{btns:o}),this._firmContentObject.footer=this._footerContainer),this.options.onFirmReady&&this.options.onFirmReady(this._firmContentObject)},_renderError:function(){this._firmContentObject.header=this.options.render("popupHeader",{title:this.options.t("apiErrorTitle")}),this._firmContentObject.tmpl=this.options.t("apiErrorBody"),this.options.onFirmReady&&this.options.onFirmReady(this._firmContentObject)},_getConfigFirmCardBody:function(t,e,i,n,o){return[{tmpl:"firmCardAddr",data:{address:t.address_name,comment:t.address_comment}},{tmpl:"firmCardContacts",data:{groups:t.contact_groups}},{tmpl:"firmCardSchedule",data:{schedule:e,forecast:i}},{tmpl:"frimCardPayments",data:{payments:n}},{tmpl:"firmCardRubric",data:{rubrics:o}}]},_buildFirmCardBody:function(t){var e=this;return t.reduce(function(t,i){var n=e.options.render(i.tmpl,i.data);return t+n},"")},_fillFooterButtons:function(){var t=[];return this.options.backBtn&&t.push({name:"firm-card-back",label:this.dict.t(this.options.lang,"btnBack"),icon:!0}),this.options.showRouteSearch&&t.push({name:"goto",label:this.dict.t(this.options.lang,"btnFindWay"),icon:!0,href:this.options.gotoUrl}),this._firmData.links&&this._firmData.links.entrances&&this.options.showEntrance&&t.push({name:"show-entrance",label:this.dict.t(this.options.lang,"btnEntrance"),icon:!0}),t},_fillHeaderLinks:function(){var t,e,i=[],n=this._firmData.reviews;this._firmData.external_content&&this._firmData.external_content.forEach(function(e){e&&"booklet"==e.type&&(t=e)}),n&&n.is_reviewable&&(i.push({name:"flamp_stars",width:20*n.rating}),i.push({name:"flamp_reviews",label:this.dict.t(this.options.lang,"linkReviews",n.review_count?n.review_count:0),href:FirmCard.DataHelper.getFlampUrl(this._firmId)}));for(var o,r=this._firmData.external_content,s=0;s<r.length;s++)if("photo_album"==r[s].type&&"common"==r[s].subtype){o=r[s];break}return!this.options.isMobile&&o&&o.count&&this.options.showPhotos&&(e=L.Util.template("http://2gis.{domain}/photos/{id}",{id:this._firmId,domain:this.options.domain}),i.push({name:"photos",href:e,label:this.dict.t(this.options.lang,"linkPhoto",o.count)})),!this.options.isMobile&&t&&t.url&&this.options.showBooklet&&i.push({name:"booklet",href:t.url,label:this.dict.t(this.options.lang,"linkBooklet")}),i},_events:{"dg-popup__button_name_firm-card-back":function(){this.options.backBtn(),this._toggleEventHandlers(!0)},"dg-popup__button_name_show-entrance":function(){var t=new this.options.showEntrance({vectors:this._firmData.links.entrances[0].geometry.vectors});t.addTo(this.options.map).show(),this._toggleEventHandlers(!0)},"dg-schedule__today":function(t){this._onToggleSchedule(t)}},_toggleEventHandlers:function(t){this.options.popup[t?"off":"on"]("click",this._onClick,this),this.options.map[t?"off":"on"]("popupclose",this._onClose,this)},_onClick:function(t){var e=t.originalEvent.target;for(var i in this._events)if(this._events.hasOwnProperty(i)&&e.className.indexOf(i)>-1)return DG.DomEvent.preventDefault(t.originalEvent),void this._events[i].call(this,e)},_onClose:function(t){this._toggleEventHandlers(!0)},_onToggleSchedule:function(t){var e=this._container.querySelector(".dg-schedule__table"),i=this._container.querySelector(".dg-schedule__now"),n=" dg-schedule__today_shown_true";e&&("block"===e.style.display?(e.style.display="none",i.style.display="block",t.className=t.className.replace(n,"")):(i.style.display="none",e.style.display="block",t.className+=n),this.options.onToggle&&this.options.onToggle())},_setOptions:function(t){var e,t=t||{};this.options=t,t.lang=t.lang||"ru";for(e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e])},_hasTouch:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}},FirmCard.DataHelper={FLAMP_URL:"http://flamp.ru/r/",FLAMP_GOOGLE_ANALYTICS:"utm_source=api2gis&utm_medium=api&utm_campaign=geoclicker",payMethods:["americanexpress","cash","dinersclub","goldcrown","internet","mastercard","noncash","visa"],_msgs:{},getFlampUrl:function(t){return this.FLAMP_URL.concat(t,"?",this.FLAMP_GOOGLE_ANALYTICS)},msg:function(t){return this._msgs.hasOwnProperty(t)?this._msgs[t]:(console&&console.log("Cant't find translation for '"+t+"'."),t.toString().replace("_"," "))},getProjectTime:function(t,e){var i,n;return i=e?new Date(e):new Date,t?(n=i.getTime()+6e4*i.getTimezoneOffset(),new Date(n+6e4*t)):i}},function(){FirmCard.List=function(t,e){this._firms={},this._setOptions(e),this._container=e&&e.container||document.createElement("ul"),this._container.setAttribute("class","dg-building-callout__list"),this._eventHandlersInited=!1,this._firmCard=this._createFirm(),this.renderList(t)},FirmCard.List.prototype={renderList:function(t){return t&&(this._toggleEventHandlers(),this.addFirms(t)),this.options.onListReady&&this.options.onListReady(this._container),this._container},_processFirms:function(t,e){if(t){var i="_"+e+"Firm";if(this._isArray(t))for(var n=0,o=t.length;o>n;n++)this[i](t[n]);else this[i](t)}},addFirms:function(t){this._processFirms(t,"add")},removeFirms:function(t){this._processFirms(t,"remove")},setLang:function(t){this.options.firmCard.lang=t},getLang:function(){return this.options.firmCard.lang},getContainer:function(){return this._container},clearList:function(){this._firms={},this._toggleEventHandlers(!0),this._clearContainer()},_removeFirm:function(t){return this._firms[t]?(this._container.removeChild(this._firms[t]),void delete this._firms[t]):!1},_addFirm:function(t){var e,i,n,o=this.options.firmlistItemTmpl;i={name:t.name,id:t.id.split("_").slice(0,1)},i.id in this._firms||(e=this._createListItem(),n=o?this.options.firmCard.render(o,{firm:i}):i.name,e.insertAdjacentHTML("beforeend",n),this._firms[i.id]=e,this._container.appendChild(e))},_createListItem:function(){var t=document.createElement("li");return t.setAttribute("class","dg-building-callout__list-item"),t},_isArray:function(t){return"[object Array]"==={}.toString.call(t)},_createFirm:function(t){return new FirmCard(t,this.options.firmCard)},_isEmptyObj:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},_events:{"dg-popup__link":function(t){var e=this._firmCard.render(t.id);this.options.firmCard[this._isEmptyObj(e)?"pasteLoader":"onFirmReady"](e),this.options.firmCard.onFirmClick&&this.options.firmCard.onFirmClick(),this._toggleEventHandlers(!0)},"dg-building-callout__list-item":function(t){t=t.children[0],this._events["dg-popup__link"].call(this,t)},"dg-popup__button_name_back":function(){this.options.firmCard.onShowLess(),this._toggleEventHandlers(!0)}},_toggleEventHandlers:function(t){this.options.firmCard.popup[t?"off":"on"]("click",this._onClick,this)},_onClick:function(t){var e=t.originalEvent.target;for(var i in this._events)if(this._events.hasOwnProperty(i)&&e.className.indexOf(i)>-1)return DG.DomEvent.preventDefault(t.originalEvent),void this._events[i].call(this,e)},_clearContainer:function(){for(var t=this._container;t.hasChildNodes();)t.removeChild(t.firstChild)},_setOptions:function(t){t||(t={}),this.options=t,this.options.firmCard||(this.options.firmCard={}),t.firmCard.lang||(this.options.firmCard.lang="ru");for(var e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e])}}}(),FirmCard.Schedule=function(t){return t=t||{},this.localLang=t.localLang||"ru",this.dict=t.dict,this},FirmCard.Schedule.prototype={setLang:function(t){return this.localLang=t||"ru",this},transform:function(t,e){function i(t,e){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}}function n(t){return t.charAt(0).toUpperCase()+t.slice(1)}function o(t){return t.substr(0,2)}function r(t){return t.substr(3,2)}function s(t){var e=+o(t)%24+"";return 1===e.length&&(e="0"+e),e+":"+r(t)}function a(t){return t%7}function l(t,e){return null==t?void 0:null==e?t[t.length-1]:slice.call(t,Math.max(t.length-e,0))}function c(t,e){if(t===e)return!0;if(!(t instanceof Object&&e instanceof Object))return!1;if(t.constructor!==e.constructor)return!1;for(var i in t)if(t.hasOwnProperty(i)){if(!e.hasOwnProperty(i))return!1;if(t[i]!==e[i]){if("object"!=typeof t[i])return!1;if(!c(t[i],e[i]))return!1}}for(i in e)if(e.hasOwnProperty(i)&&!t.hasOwnProperty(i))return!1;return!0}function u(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),o=0,r=new Array(n);n>o;)r[o++]=t,t+=i;return r}function h(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach(function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t}function d(t,e){return p(t.map(function(t,i,n){return{value:t,index:i,criteria:e.call(this,t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")}function p(t,e){var i,n=[];for(i=0;i<t.length;++i)n[i]=t[i][e];return n}function _(t){var e,i,n,s,a=[];if(!t||!t.working_hours)return[];for(var l=0;l<t.working_hours.length;l++)e=t.working_hours[l].from,i=t.working_hours[l].to,n=o(i)-o(e),s=r(i)-r(e),(0>n||0===n&&0>=s)&&(i=+o(i)+24+":"+r(i)),a[2*l]={time:e,type:"open"},a[2*l+1]={time:i,type:t.working_hours.length-1===l?"close":"lunch"};return a}function m(t){for(var e,i,n=[],s=[],l=G.indexOf(w),c=0;7>c;c++)i=a(l+c),e=_(t[G[i]]),e.forEach(function(t){var e=new Date(E);e.setDate(e.getDate()+c),e.setHours(o(t.time)),e.setMinutes(r(t.time));var i=e.getTime();n.push({ts:i,type:t.type}),n[n.length-1]&&n[n.length-2]&&n[n.length-1].ts===n[n.length-2].ts&&(n.pop(),n.pop()),n[n.length-1]&&n[n.length-2]&&n[n.length-1].ts<=E&&n[n.length-2].ts<=E&&(n[n.length-1].ts+=6048e5,n[n.length-2].ts+=6048e5)});for(n=d(n,function(t){return t.ts}),c=0;c<n.length;)n[c+1]&&n[c].ts===n[c+1].ts?c++:s.push(n[c].ts),c++;return 2===s.length&&s[1]-s[0]===6048e5?[]:n}function f(t,e,i){if(1===e&&t>B)return R(A,"tommorow");if(e>1)switch(i){case 0:return R(A,"nextSun");case 1:return R(A,"nextMon");case 2:return R(A,"nextTue");case 3:return R(A,"nextWed");case 4:return R(A,"nextThu");case 5:return R(A,"nextFri");case 6:return R(A,"nextSat")}}function g(t,e){var i,n=864e5,o=new Date(t.ts);return i=Math.round((o-e)/n),"open"===t.type&&o.getHours()<1&&i++,i}function y(e){var i,n,o=[];C.now={},n=m(t),n.length||(C.always=!0,C.now.open=!0);for(var r=0;r<n.length;r++)if(E>=(n[r-1]&&n[r-1].ts||0)&&E<n[r].ts){var a=Math.floor((n[r].ts-E)/36e5),c=Math.floor((n[r].ts-E)/6e4-60*a),u=new Date(E),h="open"!==n[r].type,d=g(n[r],u);c=10*Math.floor(c/10)?10*Math.floor(c/10):5,C.now.open=h,C.now.lunch=!!(n[r-1]&&"lunch"===n[r-1].type||"lunch"===l(n).type),C.will={willType:n[r].type,d:d,h:a,m:c};var y=new Date(n[r].ts);C.will.when=f(a,d,y.getDay());var v=new Date(n[r].ts),L=v.getHours(),b=v.getMinutes();10>L&&(L="0"+L),10>b&&(b="0"+b),C.will.till=L+":"+b}if(e){for(i=p(_(e),"time"),r=2;r<i.length;r+=2)o.push({from:i[r-1],to:i[r]});x=s(i[0]),D=s(i[i.length-1]),C.today=x===D?{alltime:!0,
alltimeStr:R(A,"worksAroundTheClock"),from:"00:00",to:"24:00"}:{from:x,to:D},o.length>0&&(C.lunch=o,C.lunchStr=R(A,"lunch"))}}function v(){for(var e=[],i=!1,n=0;7>n;n++){var o=G[n],r=0;if(e[n]={},t[o]){for(var a=t[o],l=p(_(a),"time"),c=[],d=2;d<l.length;d+=2)i=!0,c.push({from:l[d-1],to:l[d]});r=Math.max(l.length/2,r),e[n]={from:s(l[0]),to:s(l[l.length-1]),lunch:c}}o===w&&(e[n].active=!0),e[n].key=O[n]}return e.forEach(function(t){t.lunch&&h(t.lunch,u(1,r))}),{table:e,hasLunch:i}}function L(t,e){var i,o={dayList:[],lunch:[]},r=[];if(t&&t.working_hours&&t.working_hours.length){i=p(_(t),"time"),i.forEach(function(t,e){0===e?o.from=s(t):e===i.length-1?o.to=s(t):r.push(s(t))});for(var l=0;l<r.length;l+=2)o.lunch.push({from:r[l],to:r[l+1],lunchStr:n(R(A,"lunch"))});"00:00"==o.from&&"00:00"==o.to&&(o.to="24:00"),t.round_the_clock&&(o.alltime=!0,o.alltimeStr=R(A,"worksAroundTheClock"))}else o.holiday=!0;var u=[0,0,0,0,0,0,0],h=0;return G.forEach(function(i,n){if(c(e[i],t)||!e[i]&&null===t)o.dayList.push(T[n]),u[a(n+N)]=1,h++;else{if(h>2){for(var r=o.dayList.pop(),s=1;h-1>s;s++)o.dayList.pop();o.dayList[o.dayList.length-1]+="  "+r}h=0}}),o.budni=c(z,u),o.everyday=1===Math.min.apply(Math,u),o.holiday&&(o.holidayStr=R(A,"restDay",o.dayList.length).slice(2)),o.dayList=o.dayList.join(", "),o.dayList=o.dayList.charAt(0).toUpperCase()+o.dayList.slice(1),o}function b(t,e){for(var i=[],n=t.length-1;n>=0;n--)i.push(L(t[n],e));return i}if(t){e=e||{};for(var w,k,x,D,P=e.zoneOffset||0,C={},E=e.now||FirmCard.DataHelper.getProjectTime(P).getTime(),G=[],O=[],T=[],S=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],M=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],A=e.localLang||this.localLang,z=e.localWorkingDays||[0,1,1,1,1,1,0],N=e.firstdayOffset||1,B=e.minHoursToDisplayClosure||4,R=i(this.dict.t,this.dict),U=0;7>U;U++)G[U]=S[U],O[U]=this.dict.t(A,S[U].toLowerCase()),T[U]=this.dict.t(A,M[U]);w=S[(new Date(E).getDay()-N)%7],k=t[w],y(k);var j=[],I=0,H=0,F=[];if(Object.keys(t).forEach(function(e){t[e]&&t[e].working_hours&&(I++,c(t[e],l(j))||j.push(t[e]))}),H=j.length,7>I&&H++,H>2)C.week=v(t);else if(1===H)C.week={evently:[L(t[G[0]],t)]};else{for(U=0;H>U;U++)if(F[U]=0,j[U])for(var Z=p(_(j[U]),"time"),W=0;W<Z.length;W+=2){var q=o(Z[W+1])+r(Z[W+1])/60-(o(Z[W])+r(Z[W])/60);F[U]+=q}else j[U]=null;var Y=d(j,function(t,e){return F[e]});C.week={evently:b(Y,t)}}return C.comment=t.comment,C.week&&C.week.evently&&1===C.week.evently.length&&(C.everyday=C.week.evently[0].everyday),C}},forecast:function(t,e){var i,n,o="",r={},s=e&&e.maxHours||1;return t?t.always?{today:{text:this.dict.t(this.localLang,"aroundTheClock")},open:!0}:(t.will&&t.will.h<s&&(t.will.h&&(o+=this.dict.t(this.localLang,"nHours",t.will.h)+" "),t.will.m&&(o+=this.dict.t(this.localLang,"nMins",t.will.m))),t.today?(r.text=this.dict.t(this.localLang,"today"),t.everyday&&(r.text=this.dict.t(this.localLang,"everyday")),r.from=t.today.from,r.to=t.today.to,r.lunch=t.lunch,r.lunch&&(r.lunchStr=this.dict.t(this.localLang,"lunch"))):r.text=this.dict.t(this.localLang,"todayIsRestDay"),t.always?(r.text=this.dict.t(this.localLang,"aroundTheClock"),i=!0):t.now&&(i=t.now.open,n=i?t.will&&"lunch"===t.will.willType?t.will&&t.will.h<s?this.dict.t(this.localLang,"_in")+" "+this.dict.t(this.localLang,"nMins",o)+this.dict.t(this.localLang,"isClosingOnDinner"):this.dict.t(this.localLang,"isOpen"):t.will.h<s?this.dict.t(this.localLang,"closeIn")+this.dict.t(this.localLang,"nMins",o):this.dict.t(this.localLang,"isOpen"):t.will&&t.will.when?this.dict.t(this.localLang,"open")+t.will.when:t.now&&t.now.lunch?t.will.h<s?this.dict.t(this.localLang,"Lunch")+this.dict.t(this.localLang,"openIn")+this.dict.t(this.localLang,"nMins",o):this.dict.t(this.localLang,"Lunch")+this.dict.t(this.localLang,"openAt")+t.will.till:t.will&&t.will.h<s?this.dict.t(this.localLang,"openIn")+this.dict.t(this.localLang,"nMins",o):this.dict.t(this.localLang,"openAt")+t.will.till),{today:r,now:n,open:i,week:t.week,comment:t.comment,everyday:t.everyday}):{}}},FirmCard.prototype.dict={t:function(t,e,i){var n,o,r,s=!1;return"undefined"==typeof this[t]&&(t="ru"),o=this[t][e],(s="undefined"!=typeof o)?(n=s?o:e,i!==undefined&&(i=parseInt(i,10),i=isNaN(i)?0:i,r=this[t].pluralRules(i),n=i+" "+o[r]),n?n:e):e},ru:{pluralRules:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&4>=t%10&&t%10%1===0&&(12>t%100||t%100>14)?1:t%10===0||t%10>=5&&9>=t%10&&t%10%1===0||t%100>=11&&14>=t%100&&t%100%1===0?2:void 0},btnBack:"",btnFindWay:" ",btnEntrance:" ",linkReviews:["","",""],linkPhoto:["","",""],linkBooklet:"",tommorow:"",afterTommorow:"",afterWeek:" ",nextSun:" ",nextMon:" ",nextTue:" ",nextWed:" ",nextThu:" ",nextFri:" ",nextSat:" ",willOpen:"",willClose:"",isOpen:"",openTill:"  ",closeIn:"  ",openAt:"  ",openIn:"  ",open:" ",nHours:["","",""],nMins:["","",""],lunch:"",Lunch:". ",workingDays:" ",weekdays:" ",restDay:["","",""],reviewsOnFlamp:"  ",writeReviewOnFlamp:"   ",payment:"",everyday:" c",worksAroundTheClock:" ",aroundTheClock:"",knowMore:" ",toClose:" ",monday:"",tuesday:"",wednesday:"",thursday:"",friday:"",saturday:"",sunday:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:"",toLunch:" ",today:"",lessThenHour:" ",youCouldLate:"   ",workingTime:" ",showAllOrgInRubric:"   ",todayIsRestDay:" ",internet:"  ",noncash:" ",goldcrown:" ",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:" ",americanexpress:"American Express",hour:"",less:"",_in:"",isClosingOnDinner:"   "},it:{pluralRules:function(t){return 1===t?0:1},btnBack:"Indietro",btnFindWay:"Come arrivare ",btnEntrance:"Trova l'ingresso",linkReviews:["recensione","recensioni"],linkPhoto:["fotografia","fotografie"],linkBooklet:"Sull'azienda",tommorow:"domani",afterTommorow:"dopodomani",afterWeek:"tra una settimana",nextSun:"la domenica",nextMon:"il lunedi",nextTue:"il marted",nextWed:"il mercoled",nextThu:"il giovedi",nextFri:"il venerd",nextSat:"il sabato",willOpen:"apre",willClose:"ciuso",isOpen:"Aperto",openTill:"Aperto fino alle ",closeIn:"Chiude tra ",openAt:"Apre alle ",openIn:"Apre tra ",open:"Apre ",nHours:["ora","ore"],nMins:["minuto","minuti"],lunch:"pausa pranzo",Lunch:"Pausa pranzo. ",workingDays:"Giorni feriali",weekdays:"Giorni feriali",restDay:["chiusura","chiusura"],reviewsOnFlamp:"Recensioni su Flamp",writeReviewOnFlamp:"Scrivi una recensione su Flamp",payment:"pagamento",everyday:"Ogni giorno dalole",worksAroundTheClock:"Operativo 24 ore su 24",aroundTheClock:"24 ore su 24",knowMore:"ulteriori informazioni",toClose:"fino alla chiusura",monday:"lunedi",tuesday:"marted",wednesday:"mercoled",thursday:"giovedi",friday:"venerd",saturday:"sabato",sunday:"domenica",mon:"lun",tue:"mar",wed:"mer",thu:"gio",fri:"ven",sat:"sab",sun:"dom",toLunch:"fino alla pausa pranzo",today:"Oggi",lessThenHour:"meno di un'ora",youCouldLate:"affrettarsi, chiusura imminente",workingTime:"orario di lavoro",showAllOrgInRubric:"Visualizza tutte le aziende della categoria",todayIsRestDay:"oggi chiuso",internet:"Pagamento on-line",noncash:"Pagamento non in contanti",goldcrown:"Zolotaja Korona",dinersclub:"Diners Club",mastercard:"MasterCard",maestrocard:"MaestroCard",visa:"Visa",cash:"Pagamento in contanti",americanexpress:"American Express",hour:"un'ora",less:"meno di",_in:"Tra",isClosingOnDinner:"chiude per pausa pranzo"},en:{pluralRules:function(t){return 1===t?0:1},btnBack:"Back",btnFindWay:"Get here",btnEntrance:"Find entrance",linkReviews:["review","reviews"],linkPhoto:["photo","photos"],linkBooklet:"About company",tommorow:"tomorrow",afterTommorow:"the day after tomorrow",afterWeek:"in a week",nextSun:"on Sunday",nextMon:"on Monday",nextTue:"on Tuesday",nextWed:"on Wednesday",nextThu:"on Thursday",nextFri:"on Friday",nextSat:"on Saturday",willOpen:"opens ",willClose:"closes",isOpen:"Open",openTill:"Open till ",closeIn:"Closes in ",openAt:"Opens at ",openIn:"Opens in ",open:"Opens ",nHours:["hour","hours"],nMins:["minute","minutes"],lunch:"lunch break",Lunch:"Lunch break. ",workingDays:"Working days",weekdays:"Weekdays",restDay:["day off","days off"],reviewsOnFlamp:"Reviews on Flamp",writeReviewOnFlamp:"Write a review on Flamp",payment:"payment",everyday:"Daily from",worksAroundTheClock:"Open 24 hours",aroundTheClock:"24h",knowMore:"see also",toClose:"until closing",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat",sun:"Sun",toLunch:"until lunch",today:"Today",lessThenHour:"less then one hour",youCouldLate:"you might be late",workingTime:"working hours",showAllOrgInRubric:"Show all organizations in the category",todayIsRestDay:"closed today",internet:"Online",noncash:" No-cash",goldcrown:"Golden Crown",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Cash",americanexpress:"American Express",hour:"hour",less:"less",_in:"In",isClosingOnDinner:"will be closing for lunch"},cs:{pluralRules:function(t){return 1===t?0:t>=2&&4>=t?1:2},btnBack:"Zpt",btnFindWay:"Jet sem",btnEntrance:"Hledat vstup",linkReviews:["recenze","recenze","recenz"],linkPhoto:["fotografie","fotografie","fotografi"],linkBooklet:"Letk",tommorow:"ztra",afterTommorow:"pozt",afterWeek:"za tden",nextSun:"v nedli",nextMon:"v pondl",nextTue:"v ter",nextWed:"ve stedu",nextThu:"ve tvrtek",nextFri:"v ptek",nextSat:"v sobotu",willOpen:"oteve se",willClose:"zave se",isOpen:"Oteveno",openTill:"Oteveno do ",closeIn:"Zave se za ",openAt:"Oteve se v ",openIn:"Oteve se za ",open:"Oteve se ",nHours:["hodinu","hodiny","hodin"],nMins:["minutu","minuty","minut"],lunch:"poledn pestvka",Lunch:"Poledn pestvka. ",workingDays:"Vedn dny",weekdays:"Vedn dny",restDay:["zaveno","zaveno"],reviewsOnFlamp:"Recenze na Flampu",writeReviewOnFlamp:"Napsat recenzi na Flampu",payment:"platba",everyday:"Denn od ",worksAroundTheClock:"Pracuje nonstop",aroundTheClock:"Nonstop",knowMore:"dozvdt se vce",toClose:"do uzaven",monday:"pondl",tuesday:"ter",wednesday:"steda",thursday:"tvrtek",friday:"ptek",saturday:"sobota",sunday:"nedle",mon:"po",tue:"t",wed:"st",thu:"t",fri:"p",sat:"so",sun:"ne",toLunch:"do poledn pestvky",today:"Dnes",lessThenHour:"mn ne hodinu",youCouldLate:"nemuste to stihnout",workingTime:"pracovn doba",showAllOrgInRubric:"Zobrazit vechny organizace v rubrice",todayIsRestDay:"Dnes je zaveno",internet:"Platba prostednictvm Internetu",noncash:"Bezhotovostn platba",goldcrown:"Zolotaja Korona",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Platba hotov",americanexpress:"American Express",hour:"hodinu",less:"mn",_in:"Za",isClosingOnDinner:"zan poledn pestvka"},es:{pluralRules:function(t){return 1===t?0:t>=2&&4>=t?1:2},btnBack:"Atrs",btnFindWay:"Ir para all",btnEntrance:"Buscar acceso",linkReviews:["comentario","comentarios","comentarios"],linkPhoto:["foto","fotos","fotos"],linkBooklet:"Folleto",tommorow:"maana",afterTommorow:"pasado maana",afterWeek:"en una semana ms",nextSun:"el domingo",nextMon:"el lunes",nextTue:"el martes",nextWed:"el mircoles",nextThu:"el jueves",nextFri:"el viernes",nextSat:"el sbado",willOpen:"se abrir",willClose:"se cerrar",isOpen:"Abierto",openTill:"Abierto hasta ",closeIn:"Se cerrar dentro de ",openAt:"Se abrir el ",openIn:"Se abrir dentro de ",open:"Se abrir ",nHours:["hora","horas","horas"],nMins:["minuto","minutos","minutos"],lunch:"hora de colacin",Lunch:"Hora de colacin. ",workingDays:"Das laborables",weekdays:"Das laborables",restDay:["cerrado","cerrado"],reviewsOnFlamp:"Comentarios en Flamp",writeReviewOnFlamp:"Escribir un comentario en Flamp",payment:"pago",everyday:"Cada da desde",worksAroundTheClock:"Abierto las 24 horas",aroundTheClock:"24 horas",knowMore:"para saber ms",toClose:"hasta el cierre",monday:"lunes",tuesday:"martes",wednesday:"mircoles",thursday:"jueves",friday:"viernes",saturday:"sbado",sunday:"domingo",mon:"lun",tue:"mar",wed:"mi",thu:"jue",fri:"vie",sat:"sb",sun:"dom",toLunch:"antes de la hora de colacin",today:"Hoy",lessThenHour:"menos de una hora",youCouldLate:"puede ser que no alcanzas a llegar",workingTime:"horario de trabajo",showAllOrgInRubric:"Mostrar todas las empresas de la categora",todayIsRestDay:"Hoy cerrado",internet:"Pago por Internet",noncash:"Pago sin efectivo",goldcrown:"Zolotaya Korona",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Pago en efectivo",americanexpress:"American Express",hour:"hora",less:"menos de",_in:"Dentro de",isClosingOnDinner:"se cierra por hora de colacin"}},DG.Traffic=DG.TileLayer.extend({options:{period:0,disableLabel:!1},statics:{Dictionary:{},tileUrl:"http://traffic{s}.maps.2gis.com/{projectCode}/traffic/{z}/{x}/{y}/speed/{period}/{timestampString}",metaUrl:"http://meta{s}.maps.2gis.com/{projectCode}/meta/{z}/{x}/{y}/graph_speed/{period}/{timestampString}",timeUrl:"http://traffic{s}.maps.2gis.com/{projectCode}/meta/speed/time/",updateInterval:3e5,layersOptions:{errorTileUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",subdomains:"012345679",maxNativeZoom:18,detectRetina:!0,minZoom:10}},initialize:function(t){t=DG.setOptions(this,DG.extend(t||{},DG.Traffic.layersOptions)),t.timestampString=t.period?"":"?"+(new Date).getTime(),this._metaLayer=DG.Meta.layer(null,{detectRetina:t.detectRetina,maxNativeZoom:t.maxNativeZoom,dataFilter:DG.bind(this._processData,this),minZoom:t.minZoom}),this._isDg=!0,this._onTimer=DG.bind(this._onTimer,this),DG.TileLayer.prototype.initialize.call(this,DG.Traffic.tileUrl,t)},onAdd:function(t){this._updateLayerProject(),t.addLayer(this._metaLayer).on("projectchange projectleave",this._onMapProjectChange,this),this.options.disableLabel||(this._metaLayer.on(this._layerEventsListeners,this),this._labelHelper=DG.label()),DG.Traffic.updateInterval&&(this._updateTimer=setInterval(this._onTimer,DG.Traffic.updateInterval)),DG.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){clearInterval(this._updateTimer),t.removeLayer(this._metaLayer).off("projectchange projectleave",this._onMapProjectChange,this),this.options.disableLabel||(this._metaLayer.off(this._layerEventsListeners,this),this._map.removeLayer(this._labelHelper),this._labelHelper=null),DG.TileLayer.prototype.onRemove.call(this,t)},update:function(){var t=this;this._getTimestampString().then(function(e){t.options.timestampString="?"+e},function(){t.options.timestampString="?"+(new Date).getTime()}).then(function(){t.fire("update",{timestamp:t.options.timestampString}),t._layerEventsListeners.mouseout.call(t),t._metaLayer.getOrigin().setURL(t._prepareMetaURL(),t),t.redraw()})},getSubdomain:function(){return DG.Traffic.layersOptions.subdomains[Math.floor(Math.random()*DG.Traffic.layersOptions.subdomains.length)]},_getTimestampString:function(){return DG.ajax(DG.Util.template(DG.Traffic.timeUrl,DG.extend({s:this.getSubdomain(),projectCode:this._map.projectDetector.getProject().code},this.options||{})),{type:"get"})},_onTimer:function(){0===this.options.period&&this.update()},_processData:function(t,e){var i=this._map,n=e.multiplyBy(this._getTileSize()),o={};return DG.Util.isArray(t)?(t[1].forEach(function(t){this[t.graph_id]=t.speed_text},o),t[0].map(function(t){var e=DG.Wkt.toGeoJSON(t.geometry[0].object[0]);return e.coordinates[0]=e.coordinates[0].map(function(t){return i.project([t[1],t[0]]).round().subtract(n)}),{id:t.graph_id,speed:o[t.graph_id],geometry:e}})):[]},_prepareMetaURL:function(){return DG.Util.template(DG.Traffic.metaUrl,DG.extend({x:"{x}",y:"{y}",z:"{z}",s:"{s}"},this.options))},_updateLayerProject:function(){var t=this._map.projectDetector.getProject();DG.setOptions(this,t&&t.traffic?{projectCode:t.code,bounds:t.latLngBounds,minZoom:Math.max(t.minZoom,DG.Traffic.layersOptions.minZoom),maxZoom:t.maxZoom}:{maxZoom:0,minZoom:0}),this._metaLayer.getOrigin().setURL(this._prepareMetaURL())},_onMapProjectChange:function(){this._updateLayerProject(),this.redraw()},_layerEventsListeners:{mouseover:function(t){this._setCursor("pointer"),this._labelHelper&&t.meta.speed&&this._labelHelper.setPosition(t.latlng).setContent(t.meta.speed+" "+this.t("speed_unit_km_h")).addTo(this._map)},mouseout:function(){this._setCursor(""),this._labelHelper&&this._map.removeLayer(this._labelHelper)},mousemove:function(t){this._labelHelper&&this._labelHelper.setPosition(t.latlng)}},_setCursor:function(t){this._map.getContainer().style.cursor=t}}),DG.Traffic.include(DG.Locale),DG.traffic=function(t){return new DG.Traffic(t)},DG.Traffic.Dictionary.ru={speed_unit_km_h:"/"},DG.Traffic.Dictionary.it={speed_unit_km_h:"km/h"},DG.Traffic.Dictionary.cs={speed_unit_km_h:"km/h"},DG.Traffic.Dictionary.es={speed_unit_km_h:"km/h"},DG.Traffic.Dictionary.en={speed_unit_km_h:"km/h"},DG.Control.Traffic=DG.RoundControl.extend({options:{position:"topright",iconClass:"traffic"},statics:{Dictionary:{},scoreUrl:"http://traffic{s}.maps.2gis.com/{projectCode}/meta/score/0/",trafficMinZoom:10},initialize:function(t){this._trafficClass="dg-traffic-control",this._controlHideClass="dg-control-round_is-hidden_true",DG.setOptions(this,t),DG.extend(this,{_active:!1,_trafficLayer:null}).on(this._controlEvents,this)},_controlEvents:{add:function(){this._trafficLayer=DG.traffic(),this._map.on("zoomend projectchange projectleave",this._updateControlVisibility,this)},click:function(){this._active=!this._active,this._active?(this.setState("active"),this._showTraffic()):(this.setState(""),this._hideTraffic())},remove:function(){this.off(this._controlEvents,this),this._map.off("zoomend projectchange projectleave",this._updateControlVisibility,this),this._active&&(this._map.removeLayer(this._trafficLayer),this._active=!1),this._trafficLayer=null}},_showTraffic:function(){this._updateTrafficScore(),this._map.addLayer(this._trafficLayer)},_hideTraffic:function(){this._handleDom("remove"),this._map.removeLayer(this._trafficLayer)},_handleDom:function(t,e){var i=this._link;i.innerHTML=e||"",DG.DomUtil[t+"Class"](i,this._trafficClass),DG.DomUtil[t+"Class"](i,this._trafficClass+"_color_"+this._scoreRate)},_getTrafficColor:function(t){var e="green";return t>7?e="red":t>4&&(e="yellow"),e},_updateControlVisibility:function(){var t=this._map.projectDetector.getProject(),e=t&&t.traffic,i=this._map.getZoom()<DG.Control.Traffic.trafficMinZoom||!e?"addClass":"removeClass";DG.DomUtil[i](this._container,this._controlHideClass),this._active&&e&&this._updateTrafficScore()},_updateTrafficScore:function(){var t=this;this._getTrafficScore().then(function(e){e=parseInt(e,10),t._scoreRate=t._getTrafficColor(e),t._handleDom("add",e)})},_getTrafficScore:function(){var t=DG.Util.template(DG.Control.Traffic.scoreUrl,{s:this._trafficLayer.getSubdomain(),projectCode:this._map.projectDetector.getProject().code});return DG.ajax(t,{type:"get"})},_renderTranslation:function(){this._link.title=this.t("button_title")}}),DG.control.traffic=function(t){return new DG.Control.Traffic(t)},DG.Control.Traffic.Dictionary.ru={button_title:""},DG.Control.Traffic.Dictionary.it={button_title:"Colonna"},DG.Control.Traffic.Dictionary.cs={button_title:"Zcpy"},DG.Control.Traffic.Dictionary.es={button_title:"Taco"},DG.Control.Traffic.Dictionary.en={button_title:"Traffic"},DG.Ruler=DG.Layer.extend({options:{editable:!0},includes:[DG.Locale],statics:{Dictionary:{}},initialize:function(t,e){DG.Util.setOptions(this,e),this._layers={back:null,middle:null,front:null,mouse:null},this._points=[],this._layersContainer=DG.featureGroup(),Object.keys(this._layers).forEach(function(t){this._layersContainer.addLayer(this._layers[t]=DG.featureGroup())},this),this._reset(),DG.Browser.touch?(delete this._lineMouseEvents.mouseover,delete this._lineMouseEvents.mouseout,delete this._lineMouseEvents.mousemove):delete this._lineMouseEvents.click,t&&t.length&&this.setLatLngs(t)},onAdd:function(t){this._map=t.on("langchange",this._updateDistance,this),this._map.getPane("rulerLabelPane")||this._map.createPane("rulerLabelPane"),this._map.getPane("rulerEventPane")||this._map.createPane("rulerEventPane"),this._layersContainer.addTo(this._map),this._points.length&&(this._layers.mouse.fire("layeradd"),this._updateDistance()),this._layers.mouse.on(this._lineMouseEvents,this)},onRemove:function(t){t.off("langchange",this._updateDistance,this).removeLayer(this._layersContainer),this._layers.mouse.off(this._lineMouseEvents,this),this._reset()},getTotalDistance:function(){return this._calcDistance()},spliceLatLngs:function(t){var e=this._points.length,i=t>=0?Math.min(t,e):e-t,n=Array.prototype.splice.apply(this._points,arguments).map(function(t){return this._layers.mouse.removeLayer(t),t.off().getLatLng()},this),o=this._points.length;if(o){for(var r=i;o>r;r++)this._points[r]instanceof DG.Ruler.LayeredMarker||(this._points[r]=this._createPoint(this._points[r],this.options.iconStyles.large).on(this._pointEvents,this).once("add",this._addCloseHandler,this).addTo(this._layers.mouse,this._layers)),r&&!this._points[r-1]._legs&&this._addLegs(this._points[r-1]),this._points[r].setPointStyle(this.options.iconStyles[r&&o-1>r?"small":"large"]),this._points[r]._pos=r;this._removeLegs(this._points[o-1]),e>0&&o>e&&this._points[e-1].collapse(),this._points[i]&&this._updateLegs(this._points[i]),i>1&&this._points[i-1].setPointStyle(this.options.iconStyles.small),this._updateDistance(),this._normalizeRulerPoints()}return DG.Browser.touch&&this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),this._fireChangeEvent(),n},addLatLng:function(t){var e=this._points[this._points.length-1]||null;return t=DG.latLng(t),e&&(t=this._normalizeLatLng(t,e.getLatLng())),this.spliceLatLngs(this._points.length,0,t),this},getLatLngs:function(){return this._points.map(function(t){return t.getLatLng()})},setLatLngs:function(t){var e=t.slice();return e.unshift(0,this._points.length),this.spliceLatLngs.apply(this,e),this},_reset:function(){DG.extend(this,{_lineMarkerHelper:null,_morphingNow:!1})},_lineMouseEvents:{click:function(t){var e=t.layer;if(e instanceof DG.Marker&&e._pos!==this._points.length-1)this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),e.setText(this._getFormatedDistance(e)),this._lineMarkerHelper=e;else if(e instanceof DG.Path&&this.options.editable){var i=t.latlng,n=e._point._pos+1;this.spliceLatLngs(n,0,i)}},mouseover:function(t){var e=t.layer;if(e._hovered=!0,!this._morphingNow)if(e instanceof DG.Marker&&e._pos!==this._points.length-1)e.setText(this._getFormatedDistance(e));else if(e instanceof DG.Path&&!this._lineMarkerHelper){var i=e._point;this._lineMarkerHelper=this._addRunningLabel(this._nearestPoint(i._legs.middle,t.latlng),i)}},mouseout:function(t){var e=t.layer,i=t.originalEvent;e._hovered=!1,this._morphingNow||e._pos===this._points.length-1||(e instanceof DG.Marker?(!i.relatedTarget||i.relatedTarget!==e.querySelector("container")&&i.relatedTarget.parentNode!==e.querySelector("container"))&&e.collapse():this._removeRunningLabel())},mousemove:function(t){if(!this._morphingNow&&this._lineMarkerHelper){var e=t.layer._point,i=this._nearestPoint(e._legs.middle,t.latlng);this._lineMarkerHelper.setLatLng(i).setText(this._getFormatedDistance(e,e.getLatLng().distanceTo(i)))}},layeradd:function(){Object.keys(this._layers).forEach(function(t){this._layers[t].bringToFront()},this)}},_fireChangeEvent:function(){this.fire("changed",{latlngs:this.getLatLngs()})},_addRunningLabel:function(t,e){var i=this._createPoint(t).addTo(this._layers.mouse,this._layers);return this._map.getPane("rulerLabelPane").appendChild(i._icon),i.setText(this._getFormatedDistance(e,e.getLatLng().distanceTo(t)))},_removeRunningLabel:function(){this._lineMarkerHelper&&(this._layers.mouse.removeLayer(this._lineMarkerHelper),this._lineMarkerHelper=null)},_insertPointInLine:function(t){var e,i=this._lineMarkerHelper.getLatLng(),n=t.target._point._pos+1;if(L.Browser.ie){var o=t.originalEvent.target||t.originalEvent.srcElement,r=o.parentNode;r.appendChild(o)}if(L.DomEvent.stopPropagation(t.originalEvent),this.spliceLatLngs(n,0,i),e=this._points[n],e.setText(this._getFormatedDistance(e)),document.createEvent){var s=document.createEvent("MouseEvents");s.initMouseEvent("mousedown",!1,!1,document.defaultView,1,0,0,0,0,!1,!1,!1,!1,1,e._icon),e._icon.dispatchEvent(s)}else e._icon.fireEvent("onMouseDown",DG.extend(document.createEventObject(),{button:1,bubbles:!1,cancelable:!1}));this._removeRunningLabel(),this._updateLegs(e)},_nearestPoint:function(t,e){for(var i,n,o=this,r=this._project(e),s=t.getLatLngs().map(function(t){return o._project(t)}),a=0;a<s.length-1;a++){var l=DG.LineUtil.pointToSegmentDistance(r,s[a],s[a+1]);(i===undefined||i>l)&&(i=l,n=a)}var c=DG.LineUtil.closestPointOnSegment(r,s[n],s[n+1]);return this._unproject(c)},_addCloseHandler:function(t){t.target.on("click",this._deletePoint,this).querySelector("remove-link").style.display="inline-block"},_createPoint:function(t,e){var i=e?e:this.options.iconStyles.large,n={};return Object.keys(i).forEach(function(e){n[e]=DG.circleMarker(t,i[e])}),DG.Ruler.layeredMarker(t,{layers:n,draggable:this.options.editable})},_normalizeLatLng:function(t,e){for(var i=t.lng<e.lng?360:-360,n=t.lng;Math.abs(n-e.lng)>180;)n+=i;return DG.latLng(t.lat,n)},_normalizeRulerPoints:function(t){t=t||this._points[0];var e,i,n,o,r,s=this,a=t._pos,l=[];for(e=a+1;e<this._points.length;e++)i=this._points[e],n=this._points[e-1],o=i.getLatLng(),r=this._normalizeLatLng(o,n.getLatLng()),r.equals(o)||(i.setLatLng(r),l.push(e));for(e=a-1;e>=0;e--)i=this._points[e],n=this._points[e+1],o=i.getLatLng(),r=this._normalizeLatLng(o,n.getLatLng()),r.equals(o)||(i.setLatLng(r),l.push(e));l.sort().reduce(function(t,e){var i=t&&t===e-1;return s._updateLegs(s._points[e],i),e},null)},_pointEvents:{drag:function(t){var e=t.target;this._normalizeRulerPoints(e),DG.Browser.touch||e===this._points[this._points.length-1]||e.setText(this._getFormatedDistance(e)),this._updateLegs(e),this._updateDistance()},dragend:function(t){var e=t.target;this._morphingNow=!1,e._hovered||e===this._points[this._points.length-1]||e.collapse(),this._fireChangeEvent()},dragstart:function(){DG.Browser.touch&&this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),this._morphingNow=!0}},_deletePoint:function(t){var e=t.originalEvent,i=e.target||e.srcElement;("dg-ruler__label-remove-link"===i.className||"dg-ruler__remove-link-overlay"===i.className)&&(DG.DomEvent.stop(t.originalEvent),this.spliceLatLngs(t.target._pos,1))},_degToRad:function(t){return Math.PI/180*t},_radToDeg:function(t){return 180/Math.PI*t},_project:function(t){return this._map?this._map.project(t):DG.CRS.EPSG3857.latLngToPoint(t,1)},_unproject:function(t){return this._map?this._map.unproject(t):DG.CRS.EPSG3857.pointToLatLng(t,1)},_calcAngle:function(t,e,i){e=this._normalizeLatLng(e,t),i=this._normalizeLatLng(i,t),t=this._project(t),e=this._project(e),i=this._project(i);var n=e.x-t.x,o=i.x-t.x,r=e.y-t.y,s=i.y-t.y,a=n*o+r*s,l=Math.sqrt(n*n+r*r),c=Math.sqrt(o*o+s*s);return Math.acos(a/(l*c))},_calcMidPoint:function(t,e){var i=this._degToRad(t.lng),n=this._degToRad(t.lat),o=this._degToRad(e.lng),r=this._degToRad(e.lat),s=Math.acos(Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos(i-o)),a=.5,l=Math.sin((1-a)*s)/Math.sin(s),c=Math.sin(a*s)/Math.sin(s),u=l*Math.cos(n)*Math.cos(i)+c*Math.cos(r)*Math.cos(o),h=l*Math.cos(n)*Math.sin(i)+c*Math.cos(r)*Math.sin(o),d=l*Math.sin(n)+c*Math.sin(r),p=Math.atan2(d,Math.sqrt(u*u+h*h)),_=Math.atan2(h,u);return DG.latLng(this._radToDeg(p),this._radToDeg(_))},_adaptiveSample:function(t,e,i,n){if(i>9)return[];n=n||this._calcMidPoint(t,e);var o=this._calcMidPoint(t,n),r=this._calcMidPoint(n,e),s=this._calcAngle(o,n,t),a=this._calcAngle(n,t,e),l=this._calcAngle(r,n,e),c=3.1;if(s>c&&a>c&&l>c)return[];var u=[];return u=u.concat(this._adaptiveSample(t,n,i+1,o)),u.push(n),u=u.concat(this._adaptiveSample(n,e,i+1,r))},_calcGreatCircle:function(t,e){if(e=this._normalizeLatLng(e,t),t.equals(e,1))return[t,e];if(180==Math.abs(e.lng-t.lng)){var i=t.lat+e.lat>0?90:-90;return[t,DG.latLng(i,t.lng),DG.latLng(i,e.lng),e]}var n=[];n.push(t),n=n.concat(this._adaptiveSample(t,e,0)),n.push(e);for(var o=1;o<n.length;o++)n[o]=this._normalizeLatLng(n[o],n[o-1]);return n},_addLegs:function(t){var e=this.options.pathStyles,i=this._calcGreatCircle(t.getLatLng(),this._points[t._pos+1].getLatLng());t._legs={},Object.keys(e).forEach(function(n){t._legs[n]=DG.polyline(i,e[n]).addTo(this._layers[n])},this),t._legs.mouse._point=t.once("remove",this._clearRemovingPointLegs,this),this.options.editable&&!DG.Browser.touch&&t._legs.mouse.on("mousedown",this._insertPointInLine,this),this._map&&this._layers.mouse.addLayer(t._legs.mouse)},_clearRemovingPointLegs:function(t){this._removeLegs(t.target)},_removeLegs:function(t){t._legs&&(Object.keys(t._legs).forEach(function(e){this._layers[e].removeLayer(t._legs[e])},this),t._legs=null)},_updateLegs:function(t,e){var i,n=t.getLatLng(),o=this._points[t._pos-1],r=this._points[t._pos+1],s=this;o&&!e&&(i=s._calcGreatCircle(o.getLatLng(),n),Object.keys(o._legs).forEach(function(t){o._legs[t].setLatLngs(i)})),r&&(i=s._calcGreatCircle(n,r.getLatLng()),Object.keys(t._legs).forEach(function(e){t._legs[e].setLatLngs(i)}))},_calcDistance:function(t,e){for(var i=e?e:0,n=t?t._pos:this._points.length-1,o=0;n>o;o++)i+=this._points[o].getLatLng().distanceTo(this._points[o+1].getLatLng());return i},_getFormatedDistance:function(){var t=this._calcDistance.apply(this,arguments),e="m";return t>1e3?(t/=1e3,e="km",t>1e3?(t=t.toFixed(),t=t.slice(0,-3)+" "+t.slice(-3)):t=t.toFixed(2).split(".").join(this.t("delimiter"))):t=Math.round(t),[t||0," ",this.t(e)].join("")},_updateDistance:function(){this._map&&this._points.length&&this._points[this._points.length-1].setText(this._getFormatedDistance())}}),DG.ruler=function(t,e){return new DG.Ruler(t,e)},DG.Ruler.LayeredMarker=DG.Marker.extend({options:{draggable:!1,keyboard:!1,riseOnHover:!0,iconHTML:DG.dust({RulerLayeredMarker:'(function(){dust.register("RulerLayeredMarker",body_0);function body_0(chk,ctx){return chk.write("<img class=\\"dg-ruler__label-spacer\\" src=\\"").reference(ctx.get(["blankgif"], false),ctx,"h").write("\\" width=\\"26\\" height=\\"26\\" /><div class=\\"dg-ruler__label-container\\"><div class=\\"dg-ruler__point\\"></div><span class=\\"dg-ruler__label-distance\\">0 </span><span class=\\"dg-ruler__label-remove-link\\"></span><div class=\\"dg-ruler__remove-link-overlay\\"></div></div>");}return body_0;})();'})("RulerLayeredMarker",{blankgif:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})},statics:{domClass:"dg-ruler__label"},addTo:function(t,e){return Object.keys(this._layers).forEach(function(t){e[t].addLayer(this._layers[t])},this),this._viewport=e,DG.Marker.prototype.addTo.call(this.on("move",this._onMove),t)},onRemove:function(t){return Object.keys(this._layers).forEach(function(t){this._viewport[t].removeLayer(this._layers[t])},this),this.off("move",this._onMove),this._viewport=null,this._style=null,DG.Marker.prototype.onRemove.call(this,t)},setText:function(t){return this._iconCollapsed&&this.expand(),this._iconNodes.label.innerHTML=t,this},setPointStyle:function(t){return this._style!==t&&Object.keys(this._style=t).forEach(function(e){
this._layers[e].setStyle(t[e])},this),this},expand:function(){return this._iconCollapsed=!1,this._iconNodes.container.style.display="block",this._iconNodes.spacer.style.display="none",this},collapse:function(){return this._iconCollapsed=!0,this._iconNodes.container.style.display="none",this._iconNodes.spacer.style.display="block",this},querySelector:function(t){return this._icon.querySelector("."+DG.Ruler.LayeredMarker.domClass+"-"+t)},_onMove:function(t){var e=t.latlng;Object.keys(this._layers).forEach(function(t){this._layers[t].setLatLng(e)},this)},_initIcon:function(){DG.Marker.prototype._initIcon.call(this),this._iconCollapsed=!0,this._icon.style.width="",this._iconNodes={label:this.querySelector("distance"),spacer:this.querySelector("spacer"),container:this.querySelector("container")}},_afterInit:function(){this._layers=this.options.layers||null,this.options.icon=DG.divIcon({className:DG.Ruler.LayeredMarker.domClass,iconSize:[26,26],iconAnchor:[13,13],html:this.options.iconHTML})}}),DG.Ruler.LayeredMarker.addInitHook("_afterInit"),DG.Ruler.layeredMarker=function(t,e){return new DG.Ruler.LayeredMarker(t,e)};var rulerRenderer=DG.svg({pane:"rulerLabelPane"});DG.Ruler.mergeOptions({pathStyles:{back:{color:"#fff",opacity:1,weight:12,pointerEvents:"none",noClip:!0,renderer:rulerRenderer,smoothFactor:0},middle:{color:"#0da5d5",opacity:1,weight:4,pointerEvents:"none",noClip:!0,renderer:rulerRenderer,smoothFactor:0},mouse:{color:"#fff",opacity:DG.Browser.vml?.1:0,weight:DG.Browser.touch?40:20,pointerEvents:"painted",noClip:!0,renderer:DG.svg({pane:"rulerEventPane"}),smoothFactor:0}},iconStyles:{large:{back:{color:"#fff",opacity:1,fillColor:"#fff",fillOpacity:1,weight:1,radius:13,renderer:rulerRenderer},middle:{color:"#0da5d5",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:1,radius:9,renderer:rulerRenderer},front:{color:"#fff",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:4,radius:5,renderer:rulerRenderer}},small:{back:{color:"#fff",opacity:1,fillColor:"#fff",fillOpacity:1,weight:1,radius:9,renderer:rulerRenderer},middle:{color:"#0da5d5",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:1,radius:5,renderer:rulerRenderer},front:{color:"#fff",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:4,radius:2,renderer:rulerRenderer}}}}),DG.Ruler.Dictionary.ru={km:"",m:"",delimiter:","},DG.Ruler.Dictionary.it={km:"km",m:"m",delimiter:","},DG.Ruler.Dictionary.cs={km:"km",m:"m",delimiter:","},DG.Ruler.Dictionary.es={km:"km",m:"m",delimiter:","},DG.Ruler.Dictionary.en={km:"km",m:"m",delimiter:"."},DG.Control.Ruler=DG.RoundControl.extend({options:{position:"topright",iconClass:"ruler"},statics:{Dictionary:{}},initialize:function(t){DG.setOptions(this,t),DG.extend(this,{_active:!1,_drawingHelper:null,_geoclickerNeedRestore:!1}).on(this._controlEvents,this)},_controlEvents:{add:function(){this._drawingHelper=DG.ruler([])},click:function(){this._active=!this._active,this._active?(this.setState("active"),this._startDrawing()):(this.setState(""),this._finishDrawing())},remove:function(){this.off(this._controlEvents,this),this._active&&(this._map.removeLayer(this._drawingHelper),this._active=!1),this._drawingHelper=null}},_startDrawing:function(){this._map.addLayer(this._drawingHelper).on("click",this._handleMapClick,this),this._map.fire("rulerstart")},_finishDrawing:function(){this._map.off("click",this._handleMapClick,this).removeLayer(this._drawingHelper),this._drawingHelper.setLatLngs([]),this._map.fire("rulerend")},_handleMapClick:function(t){this._drawingHelper.addLatLng(t.latlng)},_renderTranslation:function(){this._link.title=this.t("button_title")}}),DG.control.ruler=function(t){return new DG.Control.Ruler(t)},DG.Control.Ruler.Dictionary.ru={button_title:""},DG.Control.Ruler.Dictionary.it={button_title:"Righello"},DG.Control.Ruler.Dictionary.cs={button_title:"Pravtko"},DG.Control.Ruler.Dictionary.es={button_title:"Regla"},DG.Control.Ruler.Dictionary.en={button_title:"Ruler"},DG.fallbackProjectsList=JSON.parse('[{"id":"99","name":"Dubai","type":"region","country_code":"ae","code":"dubai","domain":"ae","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"time_zone":{"offset":240,"name":"Asia/Dubai"},"bounds":"POLYGON((54.869563 25.350048,55.674294 25.359495,55.680597 24.772487,54.879687 24.763287,54.869563 25.350048))"},{"id":"104","name":"Lefkosia","type":"region","country_code":"cy","code":"nicosia","domain":"com.cy","zoom_level":{"min":11,"max":19},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"time_zone":{"offset":180,"name":"Asia/Nicosia"},"bounds":"POLYGON((33.269298 35.198771,33.444017 35.198256,33.443116 35.031957,33.268751 35.032469,33.269298 35.198771))"},{"id":"93","name":"Lemesos","type":"region","country_code":"cy","code":"limassol","domain":"com.cy","zoom_level":{"min":11,"max":19},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"time_zone":{"offset":180,"name":"Asia/Nicosia"},"bounds":"POLYGON((32.818314 34.770361,33.190735 34.770347,33.190216 34.543829,32.818807 34.543842,32.818314 34.770361))"},{"id":"92","name":"Praha","type":"region","country_code":"cz","code":"praha","domain":"cz","zoom_level":{"min":10,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"time_zone":{"offset":120,"name":"Europe/Prague"},"bounds":"POLYGON((14.215528 50.17879,14.713797 50.181086,14.715245 49.937173,14.219495 49.934897,14.215528 50.17879))"},{"id":"101","name":"Santiago","type":"region","country_code":"cl","code":"santiago","domain":"cl","zoom_level":{"min":9,"max":19},"flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"time_zone":{"offset":-240,"name":"America/Santiago"},"bounds":"POLYGON((-70.849333 -33.293334,-70.477276 -33.298315,-70.483526 -33.665691,-70.857156 -33.660641,-70.849333 -33.293334))"},{"id":"66","name":"Venezia e Padova","type":"region","country_code":"it","code":"padova","domain":"it","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":false,"flamp":false},"time_zone":{"offset":120,"name":"Europe/Rome"},"bounds":"POLYGON((11.381405 45.733677,12.61199 45.701369,12.572035 45.071338,11.355023 45.102947,11.381405 45.733677))"},{"id":"69","name":"","type":"region","country_code":"ru","code":"abakan","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":420,"name":"Asia/Krasnoyarsk"},"bounds":"POLYGON((91.144335 53.893079,91.817626 53.901599,91.826689 53.577496,91.158554 53.569076,91.144335 53.893079))"},{"id":"67","name":"","type":"region","country_code":"kz","code":"almaty","domain":"kz","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"time_zone":{"offset":360,"name":"Asia/Qyzylorda"},"bounds":"POLYGON((76.725996 43.469106,77.1084 43.462692,77.096182 43.108051,76.715991 43.114387,76.725996 43.469106))"},{"id":"108","name":"","type":"region","country_code":"ru","code":"almetevsk","domain":"ru","zoom_level":{"min":9,"max":17},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((52.206024 54.949956,52.478673 54.946945,52.473189 54.796869,52.20155 54.799862,52.206024 54.949956))"},{"id":"106","name":"","type":"region","country_code":"ru","code":"armawir","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((40.876282 45.249443,41.322578 45.241236,41.301688 44.721791,40.8594 44.729852,40.876282 45.249443))"},{"id":"49","name":"","type":"region","country_code":"ru","code":"arkhangelsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((39.467082 64.829966,41.321175 64.81257,41.276671 64.284305,39.458118 64.301294,39.467082 64.829966))"},{"id":"8","name":"","type":"region","country_code":"ru","code":"astrakhan","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((47.863046 46.503348,48.172299 46.511418,48.185812 46.249257,47.878031 46.241259,47.863046 46.503348))"},{"id":"4","name":"","type":"region","country_code":"ru","code":"barnaul","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":360,"name":"Asia/Omsk"},"bounds":"POLYGON((83.463814 53.486694,84.087934 53.472187,84.065362 53.158598,83.445792 53.172941,83.463814 53.486694))"},{"id":"46","name":"","type":"region","country_code":"ru","code":"belgorod","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((36.419278 50.695,36.719872 50.701271,36.729779 50.495879,36.430487 50.489654,36.419278 50.695))"},{"id":"20","name":"","type":"region","country_code":"ru","code":"biysk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":360,"name":"Asia/Omsk"},"bounds":"POLYGON((84.568894 52.63167,85.467428 52.646705,85.492485 51.91455,84.608614 51.899905,84.568894 52.63167))"},{"id":"52","name":"","type":"region","country_code":"ru","code":"blagoveshensk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":540,"name":"Asia/Yakutsk"},"bounds":"POLYGON((127.345035 50.596534,127.754667 50.601634,127.764413 50.228495,127.357983 50.223462,127.345035 50.596534))"},{"id":"51","name":"","type":"region","country_code":"ru","code":"bratsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":480,"name":"Asia/Irkutsk"},"bounds":"POLYGON((101.08963 56.502619,102.059777 56.482497,102.016051 55.929923,101.059738 55.949632,101.08963 56.502619))"},{"id":"62","name":"","type":"region","country_code":"ru","code":"bryansk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((34.122949 53.431556,34.604425 53.426058,34.593689 53.138522,34.115433 53.143963,34.122949 53.431556))"},{"id":"77","name":" ","type":"region","country_code":"ru","code":"v_novgorod","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((31.131394 58.678746,31.505415 58.683631,31.514694 58.465262,31.142992 58.460419,31.131394 58.678746))"},{"id":"25","name":"","type":"region","country_code":"ru","code":"vladivostok","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":600,"name":"Asia/Vladivostok"},"bounds":"POLYGON((131.592018 43.61615,132.343685 43.596619,132.300602 42.803446,131.558591 42.822446,131.592018 43.61615))"},{"id":"59","name":"","type":"region","country_code":"ru","code":"vladimir","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((40.178443 56.46782,40.695168 56.461839,40.676114 56.02824,40.165193 56.034124,40.178443 56.46782))"},{"id":"33","name":"","type":"region","country_code":"ru","code":"volgograd","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((43.970586 48.922097,44.93003 48.92667,44.930865 48.318601,43.982875 48.314124,43.970586 48.922097))"},{"id":"78","name":"","type":"region","country_code":"ru","code":"vologda","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((39.611585 59.337288,40.077939 59.334266,40.072156 59.150523,39.608303 59.153523,39.611585 59.337288))"},{"id":"31","name":"","type":"region","country_code":"ru","code":"voronezh","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((38.991159 51.910995,39.613084 51.909398,39.607251 51.475591,38.991243 51.477162,38.991159 51.910995))"},{"id":"27","name":"-","type":"region","country_code":"ru","code":"gornoaltaysk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":360,"name":"Asia/Omsk"},"bounds":"POLYGON((85.48461 52.148049,86.447524 52.15649,86.458369 51.25739,85.514346 51.249215,85.48461 52.148049))"},{"id":"105","name":"","type":"region","country_code":"ua","code":"dnepropetrovsk","domain":"ua","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"time_zone":{"offset":180,"name":"Europe/Kiev"},"bounds":"POLYGON((34.749305 48.687967,35.296754 48.67835,35.281569 48.341385,34.737734 48.350889,34.749305 48.687967))"},{"id":"79","name":"","type":"region","country_code":"ua","code":"donetsk","domain":"ua","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"time_zone":{"offset":180,"name":"Europe/Kiev"},"bounds":"POLYGON((37.510511 48.182783,38.240528 48.189925,38.246188 47.802815,37.521609 47.795769,37.510511 48.182783))"},{"id":"9","name":"","type":"region","country_code":"ru","code":"ekaterinburg","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((59.714357 57.010251,60.919831 57.036097,60.943224 56.611802,59.751258 56.586369,59.714357 57.010251))"},{"id":"65","name":"","type":"region","country_code":"ru","code":"ivanovo","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((40.806876 57.089556,41.189405 57.083456,41.17815 56.891313,40.797585 56.897369,40.806876 57.089556))"},{"id":"41","name":"","type":"region","country_code":"ru","code":"izhevsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":240,"name":"Europe/Samara"},"bounds":"POLYGON((52.95169 57.057889,53.495625 57.04823,53.470393 56.667543,52.931947 56.677063,52.95169 57.057889))"},{"id":"11","name":"","type":"region","country_code":"ru","code":"irkutsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":480,"name":"Asia/Irkutsk"},"bounds":"POLYGON((103.618853 52.641505,104.97019 52.649551,104.970807 51.718225,103.647397 51.710443,103.618853 52.641505))"},{"id":"70","name":"-","type":"region","country_code":"ru","code":"yoshkarola","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((47.588902 56.761482,48.153297 56.748478,48.133249 56.507529,47.572432 56.520416,47.588902 56.761482))"},{"id":"21","name":"","type":"region","country_code":"ru","code":"kazan","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((48.29118 55.977651,49.519957 55.998532,49.535477 55.587187,48.319555 55.566624,48.29118 55.977651))"},{"id":"40","name":"","type":"region","country_code":"ru","code":"kaliningrad","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":120,"name":"Europe/Kaliningrad"},"bounds":"POLYGON((19.839082 55.05047,20.659199 55.055528,20.663516 54.5391,19.853784 54.534137,19.839082 55.05047))"},{"id":"61","name":"","type":"region","country_code":"ru","code":"kaluga","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((35.894812 54.75546,36.455305 54.768523,36.482233 54.33388,35.92765 54.321024,35.894812 54.75546))"},{"id":"109","name":"-","type":"region","country_code":"ru","code":"k_uralskiy","domain":"ru","zoom_level":{"min":9,"max":17},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((61.715751 56.571122,62.254705 56.57552,62.260467 56.279794,61.725677 56.275445,61.715751 56.571122))"},{"id":"84","name":"","type":"region","country_code":"kz","code":"karaganda","domain":"kz","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"time_zone":{"offset":360,"name":"Asia/Qyzylorda"},"bounds":"POLYGON((72.860052 50.123995,73.394974 50.132623,73.41063 49.658415,72.880917 49.64993,72.860052 50.123995))"},{"id":"5","name":"","type":"region","country_code":"ru","code":"kemerovo","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":420,"name":"Asia/Krasnoyarsk"},"bounds":"POLYGON((85.945012 55.531762,86.258641 55.534061,86.263664 55.26479,85.952159 55.262514,85.945012 55.531762))"},{"id":"58","name":"","type":"region","country_code":"ru","code":"kirov","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((49.036766 58.786454,49.936128 58.797004,49.947791 58.410879,49.058278 58.400486,49.036766 58.786454))"},{"id":"94","name":"--","type":"region","country_code":"ru","code":"komsomolsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":600,"name":"Asia/Vladivostok"},"bounds":"POLYGON((136.792391 50.721413,137.258493 50.713313,137.233696 50.189815,136.772704 50.197767,136.792391 50.721413))"},{"id":"34","name":"","type":"region","country_code":"ru","code":"kostroma","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((40.733014 57.924383,41.151865 57.917978,41.137488 57.675732000000004,40.721431 57.682077,40.733014 57.924383))"},{"id":"23","name":"","type":"region","country_code":"ru","code":"krasnodar","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((38.650083 45.265382,39.378568 45.26529,39.376448 44.943556,38.652043 44.943646,38.650083 45.265382))"},{"id":"7","name":"","type":"region","country_code":"ru","code":"krasnoyarsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":420,"name":"Asia/Krasnoyarsk"},"bounds":"POLYGON((92.126846 56.306635,93.59929 56.308263,93.591657 55.813004,92.137966 55.811406,92.126846 56.306635))"},{"id":"10","name":"","type":"region","country_code":"ru","code":"kurgan","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((65.163162 55.530273,65.482856 55.524208,65.473103 55.368657,65.154662 55.374687,65.163162 55.530273))"},{"id":"73","name":"","type":"region","country_code":"ru","code":"kursk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((35.889369 51.829944,36.419837 51.842787,36.435346 51.569517,35.908055 51.556799,35.889369 51.829944))"},{"id":"86","name":"-","type":"region","country_code":"ru","code":"lenkuz","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":420,"name":"Asia/Novokuznetsk"},"bounds":"POLYGON((85.750103 54.768861,86.495701 54.774252,86.502903 54.184679,85.767947 54.179404,85.750103 54.768861))"},{"id":"56","name":"","type":"region","country_code":"ru","code":"lipetsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((39.376422 52.719879,39.82336 52.717618,39.819113 52.490547,39.37448 52.49279,39.376422 52.719879))"},{"id":"26","name":"","type":"region","country_code":"ru","code":"magnitogorsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((58.547823 53.927025,59.504226 53.910884,59.464288 53.229865,58.523119 53.245612,58.547823 53.927025))"},{"id":"87","name":"","type":"region","country_code":"ru","code":"miass","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":false,"flamp":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((59.545734 55.280218,60.258398 55.263265,60.228026 54.888193,59.521985 54.904912,59.545734 55.280218))"},{"id":"32","name":"","type":"region","country_code":"ru","code":"moscow","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((36.758963 56.091685,38.205281 56.109465,38.225024 55.121151,36.814587 55.104013,36.758963 56.091685))"},{"id":"96","name":"","type":"region","country_code":"ru","code":"murmansk","domain":"ru","zoom_level":{"min":9,"max":17},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((32.701158 69.064619,33.225325 69.064731,33.222253 68.761176,32.705233 68.761065,32.701158 69.064619))"},{"id":"29","name":" ","type":"region","country_code":"ru","code":"nabchelny","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((51.717261 55.865183,52.62818 55.856503,52.614937 55.536675,51.711425 55.545253,51.717261 55.865183))"},{"id":"82","name":"","type":"region","country_code":"ru","code":"nahodka","domain":"ru","zoom_level":{"min":10,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":600,"name":"Asia/Vladivostok"},"bounds":"POLYGON((132.750811 42.90212,133.241339 42.91071,133.248191 42.668281,132.759571 42.659764,132.750811 42.90212))"},{"id":"12","name":"","type":"region","country_code":"ru","code":"nizhnevartovsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((75.931826 61.190935,77.028583 61.178948,77.007766 60.851181,75.922257 60.863009,75.931826 61.190935))"},{"id":"19","name":" ","type":"region","country_code":"ru","code":"n_novgorod","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((43.297073 56.468016,44.247071 56.477411,44.254811 56.081492,43.31457 56.072236,43.297073 56.468016))"},{"id":"45","name":" ","type":"region","country_code":"ru","code":"ntagil","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((59.788601 58.091707,60.347887 58.078228,60.317394 57.749299,59.763185 57.762607,59.788601 58.091707))"},{"id":"6","name":"","type":"region","country_code":"ru","code":"novokuznetsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":420,"name":"Asia/Novokuznetsk"},"bounds":"POLYGON((86.510624 54.121371,87.463656 54.121473,87.456823 53.497654,86.517836 53.497554,86.510624 54.121371))"},{"id":"74","name":"","type":"region","country_code":"ru","code":"novorossiysk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((36.936306 45.204638,38.668167 45.222804,38.673277 44.323572,36.968059 44.305963,36.936306 45.204638))"},{"id":"1","name":"","type":"region","country_code":"ru","code":"novosibirsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":360,"name":"Asia/Novosibirsk"},"bounds":"POLYGON((82.532331 55.249038,83.396534 55.235123,83.356355 54.553032,82.506623 54.566601,82.532331 55.249038))"},{"id":"76","name":"","type":"region","country_code":"ru","code":"norilsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":420,"name":"Asia/Krasnoyarsk"},"bounds":"POLYGON((85.986318 69.559455,88.551918 69.555507,88.529535 69.242435,86.000942 69.246318,85.986318 69.559455))"},{"id":"103","name":"","type":"region","country_code":"ru","code":"noyabrsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((74.30478 63.879187,76.263372 63.875343,76.226155 63.018251,74.325265 63.021954,74.30478 63.879187))"},{"id":"14","name":"","type":"region","country_code":"ua","code":"odessa","domain":"ua","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"time_zone":{"offset":180,"name":"Europe/Kiev"},"bounds":"POLYGON((30.512168 46.64901,30.896094 46.656718,30.911286 46.261025,30.530126 46.253422,30.512168 46.64901))"},{"id":"2","name":"","type":"region","country_code":"ru","code":"omsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":360,"name":"Asia/Omsk"},"bounds":"POLYGON((72.883518 55.40568,73.752471 55.417631,73.771665 54.796804,72.916062 54.785124,72.883518 55.40568))"},{"id":"48","name":"","type":"region","country_code":"ru","code":"orenburg","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((54.920411 51.927322,55.487422 51.935975,55.496231 51.672052,54.932517 51.663479,54.920411 51.927322))"},{"id":"71","name":"","type":"region","country_code":"ru","code":"orel","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((35.870923 53.103739,36.315298 53.092181,36.295963 52.838995,35.85417 52.850448,35.870923 53.103739))"},{"id":"42","name":"","type":"region","country_code":"ru","code":"penza","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((44.795477 53.349082,45.358809 53.348717,45.356452 53.065566,44.796821 53.065926,44.795477 53.349082))"},{"id":"16","name":"","type":"region","country_code":"ru","code":"perm","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((55.610475 58.236816,56.656815 58.243911,56.66204 57.69294,55.631622 57.685995,55.610475 58.236816))"},{"id":"80","name":"","type":"region","country_code":"ru","code":"petrozavodsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((34.102723 61.959477,34.70885 61.953295,34.694352 61.691472,34.093364 61.697587,34.102723 61.959477))"},{"id":"95","name":"-","type":"region","country_code":"ru","code":"p_kamchatskiy","domain":"ru","zoom_level":{"min":9,"max":17},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":720,"name":"Asia/Kamchatka"},"bounds":"POLYGON((158.195687 53.346954,159.025519 53.349662,159.02523 52.858368,158.204799 52.855708,158.195687 53.346954))"},{"id":"90","name":"","type":"region","country_code":"ru","code":"pskov","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((28.168619 57.889106,28.491531 57.885724,28.484999 57.727138,28.1635 57.7305,28.168619 57.889106))"},{"id":"89","name":" ()","type":"region","country_code":"ru","code":"minvody","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((42.596866 44.289522,43.518712 44.305202,43.530679 43.823418,42.616267 43.807998,42.596866 44.289522))"},{"id":"24","name":"--","type":"region","country_code":"ru","code":"rostov","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((39.358722 47.368152,39.924838 47.364983,39.919435 47.053314,39.356627 47.05645,39.358722 47.368152))"},{"id":"44","name":"","type":"region","country_code":"ru","code":"ryazan","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((39.40589 54.882191,39.992107 54.878818,39.982606 54.487343,39.402002 54.490668,39.40589 54.882191))"},{"id":"18","name":"","type":"region","country_code":"ru","code":"samara","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":240,"name":"Europe/Samara"},"bounds":"POLYGON((49.777726 53.708125,50.516957 53.713386,50.524471 53.044185,49.796735 53.03905,49.777726 53.708125))"},{"id":"38","name":"-","type":"region","country_code":"ru","code":"spb","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":true,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((29.410888 60.259339,30.98445 60.292561,31.027971 59.567535,29.488251 59.535262,29.410888 60.259339))"},{"id":"85","name":"","type":"region","country_code":"ru","code":"saransk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((44.867017 54.301903,45.51172 54.300891,45.507836 53.984632,44.868026 53.985633,44.867017 54.301903))"},{"id":"43","name":"","type":"region","country_code":"ru","code":"saratov","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((45.7361 51.699809,46.314773 51.694758,46.304971 51.353163,45.730611 51.358153,45.7361 51.699809))"},{"id":"63","name":"","type":"region","country_code":"ru","code":"smolensk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((31.755002 54.885154,32.265103 54.889311,32.268673 54.692002,31.761048 54.687875,31.755002 54.885154))"},{"id":"30","name":"","type":"region","country_code":"ru","code":"sochi","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((38.93648 44.354812,40.488511 44.34513,40.464281 43.36325,38.937514 43.372607,38.93648 44.354812))"},{"id":"57","name":"","type":"region","country_code":"ru","code":"stavropol","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((41.658117 45.252393,42.307255 45.269558,42.324115 44.909882,41.679025 44.89293,41.658117 45.252393))"},{"id":"60","name":" ","type":"region","country_code":"ru","code":"staroskol","domain":"ru","zoom_level":{"min":10,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((37.744862 51.375661,37.979312 51.377938,37.982166 51.249129,37.748371 51.246862,37.744862 51.375661))"},{"id":"54","name":"","type":"region","country_code":"ru","code":"sterlitamak","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((55.805672 53.734238,56.123975 53.736987,56.13283 53.305583,55.817744 53.302876,55.805672 53.734238))"},{"id":"39","name":"","type":"region","country_code":"ru","code":"surgut","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((72.38176 61.388553,73.781358 61.408288,73.797164 60.996565,72.41568 60.977161,72.38176 61.388553))"},{"id":"72","name":"","type":"region","country_code":"ru","code":"syktyvkar","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((50.431525 61.921812,51.27508 61.92271,51.271963 61.571227,50.437968 61.570342,50.431525 61.921812))"},{"id":"81","name":"","type":"region","country_code":"ru","code":"tambov","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((41.282289 52.826563,41.60158 52.819991,41.58624 52.561316,41.268828 52.567827,41.282289 52.826563))"},{"id":"47","name":"","type":"region","country_code":"ru","code":"tver","domain":"ru","zoom_level":{"min":9,"max":17},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((35.531082 56.998794,36.290293 57.017546,36.3143 56.68411,35.561787 56.665594,35.531082 56.998794))"},{"id":"97","name":"","type":"region","country_code":"ru","code":"tobolsk","domain":"ru","zoom_level":{"min":9,"max":17},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((68.027461 58.334051,68.627747 58.337205,68.630591 58.064257,68.03489 58.061137,68.027461 58.334051))"},{"id":"22","name":"","type":"region","country_code":"ru","code":"togliatti","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true},"time_zone":{"offset":240,"name":"Europe/Samara"},"bounds":"POLYGON((48.961827 53.69702,49.777726 53.708125,49.796735 53.03905,48.993508 53.028211,48.961827 53.69702))"},{"id":"3","name":"","type":"region","country_code":"ru","code":"tomsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":360,"name":"Asia/Omsk"},"bounds":"POLYGON((84.768656 56.588195,85.235419 56.595694,85.246532 56.355457,84.782704 56.348026,84.768656 56.588195))"},{"id":"36","name":"","type":"region","country_code":"ru","code":"tula","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((37.414045 54.309532,38.415847 54.318543,38.421585 53.908416,37.429616 53.899539,37.414045 54.309532))"},{"id":"13","name":"","type":"region","country_code":"ru","code":"tyumen","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((65.263355 57.26989,66.690851 57.236046,66.609235 56.397678,65.213221 56.430463,65.263355 57.26989))"},{"id":"37","name":"-","type":"region","country_code":"ru","code":"ulanude","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":480,"name":"Asia/Irkutsk"},"bounds":"POLYGON((107.376889 52.056483,107.990789 52.042492,107.96757 51.691351,107.358424 51.705168,107.376889 52.056483))"},{"id":"55","name":"","type":"region","country_code":"ru","code":"ulyanovsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((48.031111 54.455092,48.755444 54.470724,48.774425 54.120417,48.056197 54.104983,48.031111 54.455092))"},{"id":"83","name":"","type":"region","country_code":"ru","code":"ussuriysk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":600,"name":"Asia/Vladivostok"},"bounds":"POLYGON((131.749241 43.961672,132.129905 43.971877,132.142052 43.718194,131.762993 43.708079,131.749241 43.961672))"},{"id":"91","name":"-","type":"region","country_code":"kz","code":"ustkam","domain":"kz","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"time_zone":{"offset":360,"name":"Asia/Qyzylorda"},"bounds":"POLYGON((82.450724 50.059192,82.805718 50.054212,82.798391 49.857959,82.444837 49.862905,82.450724 50.059192))"},{"id":"17","name":"","type":"region","country_code":"ru","code":"ufa","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((55.715089999999996 54.952485,56.304346 54.957284,56.312416 54.48324,55.729992 54.478524,55.715089999999996 54.952485))"},{"id":"35","name":"","type":"region","country_code":"ru","code":"khabarovsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":600,"name":"Asia/Vladivostok"},"bounds":"POLYGON((134.873582 48.607104,135.259036 48.606882,135.257422 48.288578,134.87437 48.288797,134.873582 48.607104))"},{"id":"110","name":"","type":"region","country_code":"ua","code":"kharkov","domain":"ua","zoom_level":{"min":9,"max":17},"flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"time_zone":{"offset":180,"name":"Europe/Kiev"},"bounds":"POLYGON((36.031103 50.115121,36.467033 50.125456,36.481687 49.845767,36.048271 49.835534,36.031103 50.115121))"},{"id":"53","name":"","type":"region","country_code":"ru","code":"cheboksary","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((47.00778 56.342026,47.60576 56.33089,47.58216 55.980845,46.989586 55.991836,47.00778 56.342026))"},{"id":"15","name":"","type":"region","country_code":"ru","code":"chelyabinsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"traffic":true,"flamp":true,"has_net_booklet":true},"time_zone":{"offset":300,"name":"Asia/Yekaterinburg"},"bounds":"POLYGON((61.185486 55.312905,61.734408 55.319826,61.74458 54.997301,61.200066 54.990462,61.185486 55.312905))"},{"id":"64","name":"","type":"region","country_code":"ru","code":"chita","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":480,"name":"Asia/Chita"},"bounds":"POLYGON((113.113845 52.186114,113.639184 52.175527,113.624543 51.926502,113.102112 51.936996,113.113845 52.186114))"},{"id":"88","name":"-","type":"region","country_code":"ru","code":"yuzhnosakhalinsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":600,"name":"Asia/Vladivostok"},"bounds":"POLYGON((142.47294 47.515634,142.971758 47.50814,142.937954 46.583209,142.44768 46.590465,142.47294 47.515634))"},{"id":"50","name":"","type":"region","country_code":"ru","code":"yakutsk","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":540,"name":"Asia/Yakutsk"},"bounds":"POLYGON((129.532475 62.187831,129.992303 62.185302,129.979868 61.800501,129.525802 61.80299,129.532475 62.187831))"},{"id":"28","name":"","type":"region","country_code":"ru","code":"yaroslavl","domain":"ru","zoom_level":{"min":9,"max":18},"flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"time_zone":{"offset":180,"name":"Europe/Moscow"},"bounds":"POLYGON((39.722892 57.776199,40.012883 57.774213,40.005807 57.519309,39.717841 57.521275,39.722892 57.776199))"}]');

}(this,document);