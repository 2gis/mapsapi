<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8' />
        <title>Подписка на событие изменения проекта</title>
        <script src="http://maps.api.2gis.ru/2.0/loader.js?pkg=full"
        data-id="dgLoader"></script>
    </head>
    <body>
        <div id="map" style="width: 100%; height: 400px;"></div>
        <script>
            // создаем обработчик загрузки страницы
            DG.then(function () {
                var map, currentProjectBound;
                // создаем объект карты, связанный с контейнером
                map = DG.map('map', {
                    center: DG.latLng(54.98, 82.89),
                    zoom: 9
                });
                // подписываемся на событие изменения текущего проекта 2GIS
                map.on('projectchange', function (e) {
                    var bounds = e.getProject().LatLngBounds;
                    currentProjectBound = DG.rectangle(bounds, {
                        color:"#f03",
                        weight:1
                    }).addTo(map);
                });
                // подписываемся на событие выхода из проекта 2GIS
                map.on('projectleave', function (e) {
                    if (currentProjectBound) {
                        currentProjectBound.onRemove(map);
                    }
                });
            });
        </script>
    </body>
</html>